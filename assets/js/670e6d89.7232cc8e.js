"use strict";(self.webpackChunknotes_3=self.webpackChunknotes_3||[]).push([[50536],{54213:(n,r,e)=>{e.d(r,{R:()=>d,x:()=>o});var t=e(36672);const s={},i=t.createContext(s);function d(n){const r=t.useContext(i);return t.useMemo((function(){return"function"==typeof n?n(r):{...r,...n}}),[r,n])}function o(n){let r;return r=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:d(n.components),t.createElement(i.Provider,{value:r},n.children)}},77170:(n,r,e)=>{e.r(r),e.d(r,{assets:()=>c,contentTitle:()=>o,default:()=>u,frontMatter:()=>d,metadata:()=>t,toc:()=>a});const t=JSON.parse('{"id":"FrontEnd/Libraries/DndKit","title":"DndKit","description":"dnd kit\u662f\u4e00\u4e2a\u9002\u7528\u4e8eReact\u7684\u8f7b\u91cf\u7ea7\u3001\u9ad8\u6027\u80fd\u3001\u53ef\u8bbf\u95ee\u4e14\u53ef\u6269\u5c55\u7684\u62d6\u653e\u5de5\u5177\u5305.","source":"@site/docs/FrontEnd/Libraries/DndKit.mdx","sourceDirName":"FrontEnd/Libraries","slug":"/FrontEnd/Libraries/DndKit","permalink":"/notes3/docs/FrontEnd/Libraries/DndKit","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/FrontEnd/Libraries/DndKit.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"frontEnd","previous":{"title":"\u5e38\u7528\u5e93","permalink":"/notes3/docs/category/\u5e38\u7528\u5e93-1"},"next":{"title":"Mantine","permalink":"/notes3/docs/FrontEnd/Libraries/Mantine"}}');var s=e(23420),i=e(54213);const d={},o=void 0,c={},a=[{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:2},{value:"\u4f7f\u7528",id:"\u4f7f\u7528",level:2}];function l(n){const r={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.a,{href:"https://dndkit.com/",children:"dnd kit"}),"\u662f\u4e00\u4e2a\u9002\u7528\u4e8e",(0,s.jsx)(r.code,{children:"React"}),"\u7684\u8f7b\u91cf\u7ea7\u3001\u9ad8\u6027\u80fd\u3001\u53ef\u8bbf\u95ee\u4e14\u53ef\u6269\u5c55\u7684\u62d6\u653e\u5de5\u5177\u5305."]}),"\n",(0,s.jsx)(r.h2,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"npm install @dnd-kit/core @dnd-kit/sortable @dnd-kit/modifiers @dnd-kit/utilities\n"})}),"\n",(0,s.jsx)(r.h2,{id:"\u4f7f\u7528",children:"\u4f7f\u7528"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:"\u5f15\u5165\u5fc5\u8981\u7684\u4f9d\u8d56"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-tsx",children:"import type {DragEndEvent} from '@dnd-kit/core';\r\nimport {DndContext, DragOverlay} from '@dnd-kit/core';\r\nimport {restrictToVerticalAxis} from '@dnd-kit/modifiers';\r\nimport {SortableContext, useSortable, verticalListSortingStrategy} from '@dnd-kit/sortable';\r\nimport {CSS} from '@dnd-kit/utilities';\n"})}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:"\u5b9a\u4e49\u62d6\u62fd\u7ec4\u4ef6"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-tsx",children:"const DraggableRow = ({ children, ...props }: RowProps) => {\r\n    const {\r\n        attributes,  // \u62d6\u62fd\u5c5e\u6027\r\n        listeners,   // \u62d6\u62fd\u4e8b\u4ef6\u76d1\u542c\u5668\r\n        setNodeRef, // \u8bbe\u7f6e\u53ef\u62d6\u62fd\u5143\u7d20\u7684ref\r\n        transform,  // \u53d8\u6362\u4fe1\u606f\r\n        transition, // \u8fc7\u6e21\u6548\u679c\r\n        isDragging, // \u662f\u5426\u6b63\u5728\u62d6\u62fd\r\n    } = useSortable({\r\n        id: props['data-row-key'],\r\n    });\r\n\r\n    const style: React.CSSProperties = {\r\n        ...props.style,\r\n        transform: CSS.Transform.toString(transform && { ...transform, scaleY: 1 }),\r\n        transition: transition || 'all 0.2s',\r\n        cursor: 'move',\r\n        // \u62d6\u62fd\u65f6\u7684\u6837\u5f0f\r\n        ...(isDragging ? {\r\n            position: 'relative',\r\n            zIndex: 0,\r\n            background: token.colorFillAlter,\r\n            opacity: 0.2,\r\n        } : {}),\r\n    };\r\n\r\n    return (\r\n        <tr\r\n            {...props}\r\n            ref={setNodeRef}\r\n            style={style}\r\n            {...attributes}\r\n            {...listeners}\r\n        >\r\n            {children}\r\n        </tr>\r\n    );\r\n};\n"})}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:"\u521b\u5efa\u62d6\u62fd\u65f6\u663e\u793a\u7684\u9884\u89c8\u7ec4\u4ef6"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-tsx",children:"const DragRowContent = ({ record }: { record: Instruction }) => {\r\n    return (\r\n        <div style={{/* \u6837\u5f0f\u7701\u7565 */}}>\r\n            {/* \u62d6\u62fd\u65f6\u663e\u793a\u7684\u5185\u5bb9 */}\r\n            <div>{record.name}</div>\r\n            <div>{record.type}</div>\r\n            <div>{record.description}</div>\r\n        </div>\r\n    );\r\n};\n"})}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:"\u8bbe\u7f6e\u62d6\u62fd\u4e0a\u4e0b\u6587\u548c\u4e8b\u4ef6\u5904\u7406"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-tsx",children:"// \u72b6\u6001\u7ba1\u7406\r\nconst [draggedInstruction, setDraggedInstruction] = useState<Instruction | null>(null);\r\n\r\n// \u62d6\u62fd\u5f00\u59cb\u5904\u7406\r\nconst handleDragStart = (event: DragEndEvent) => {\r\n    const { active } = event;\r\n    document.body.style.cursor = 'grabbing';\r\n    const draggedInst = selectedInstructions.find(\r\n        inst => inst.id.toString() === active.id.toString()\r\n    );\r\n    if (draggedInst) {\r\n        setDraggedInstruction(draggedInst);\r\n    }\r\n};\r\n\r\n// \u62d6\u62fd\u7ed3\u675f\u5904\u7406\r\nconst onDragEnd = ({ active, over }: DragEndEvent) => {\r\n    setDraggedInstruction(null);\r\n    document.body.style.cursor = '';\r\n\r\n    if (active.id !== over?.id) {\r\n        // \u91cd\u65b0\u6392\u5e8f\u903b\u8f91\r\n        const activeIndex = selectedIds.findIndex(id => id === Number(active.id));\r\n        const overIndex = selectedIds.findIndex(id => id === Number(over?.id));\r\n        const newIds = [...selectedIds];\r\n        const [removed] = newIds.splice(activeIndex, 1);\r\n        newIds.splice(overIndex, 0, removed);\r\n        setSelectedIds(newIds);\r\n        onChange?.(newIds);\r\n    }\r\n};\n"})}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:"\u7ec4\u88c5\u62d6\u62fd\u529f\u80fd\u7ec4\u4ef6"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-tsx",children:'<DndContext\r\n    modifiers={[restrictToVerticalAxis]}  // \u9650\u5236\u4e3a\u5782\u76f4\u62d6\u62fd\r\n    onDragStart={handleDragStart}\r\n    onDragEnd={onDragEnd}\r\n>\r\n    <SortableContext\r\n        items={selectedInstructions.map(i => i.id.toString())}\r\n        strategy={verticalListSortingStrategy}\r\n    >\r\n        <Table\r\n            components={{\r\n                body: {\r\n                    row: DraggableRow,  // \u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u53ef\u62d6\u62fd\u884c\r\n                },\r\n            }}\r\n            rowKey="id"\r\n            columns={columns}\r\n            dataSource={selectedInstructions}\r\n        />\r\n    </SortableContext>\r\n\r\n    {/* \u62d6\u62fd\u65f6\u7684\u9884\u89c8\u5c42 */}\r\n    <DragOverlay>\r\n        {draggedInstruction ? (\r\n            <DragRowContent record={draggedInstruction} />\r\n        ) : null}\r\n    </DragOverlay>\r\n</DndContext>\n'})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.p,{children:"\u4e0a\u9762\u7684\u4f8b\u5b50\u5b9e\u73b0\u4e86:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"\u62d6\u62fd\u65f6\u7684\u89c6\u89c9\u53cd\u9988"}),"\n",(0,s.jsx)(r.li,{children:"\u9650\u5236\u53ea\u80fd\u5782\u76f4\u62d6\u52a8"}),"\n",(0,s.jsx)(r.li,{children:"\u62d6\u62fd\u65f6\u663e\u793a\u81ea\u5b9a\u4e49\u9884\u89c8"}),"\n",(0,s.jsx)(r.li,{children:"\u62d6\u62fd\u7ed3\u675f\u540e\u66f4\u65b0\u6570\u636e\u987a\u5e8f"}),"\n"]})]})}function u(n={}){const{wrapper:r}={...(0,i.R)(),...n.components};return r?(0,s.jsx)(r,{...n,children:(0,s.jsx)(l,{...n})}):l(n)}}}]);