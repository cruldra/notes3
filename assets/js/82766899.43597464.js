"use strict";(self.webpackChunknotes_3=self.webpackChunknotes_3||[]).push([[92462],{54213:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>l});var s=n(36672);const a={},i=s.createContext(a);function r(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(i.Provider,{value:t},e.children)}},79348:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>l,default:()=>m,frontMatter:()=>r,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"AI/Pytorch/\u5de5\u5177/\u6570\u636e/dataset_demo","title":"Dataset Demo","description":"\u672c\u7b14\u8bb0\u672c\u6f14\u793a PyTorch \u4e2d Dataset \u76f8\u5173\u7684\u5404\u4e2a API \u7528\u6cd5\u3002","source":"@site/docs/AI/Pytorch/\u5de5\u5177/\u6570\u636e/dataset_demo.md","sourceDirName":"AI/Pytorch/\u5de5\u5177/\u6570\u636e","slug":"/AI/Pytorch/\u5de5\u5177/\u6570\u636e/dataset_demo","permalink":"/notes3/docs/AI/Pytorch/\u5de5\u5177/\u6570\u636e/dataset_demo","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/AI/Pytorch/\u5de5\u5177/\u6570\u636e/dataset_demo.md","tags":[],"version":"current","frontMatter":{"title":"Dataset Demo","marimo-version":"0.19.2","width":"medium"},"sidebar":"ai","previous":{"title":"\u7b80\u4ecb","permalink":"/notes3/docs/AI/Pytorch/\u5de5\u5177/\u6570\u636e/\u7b80\u4ecb"},"next":{"title":"\u5982\u4f55\u770b\u61c2\u5f20\u91cf\u5f62\u72b6","permalink":"/notes3/docs/AI/Pytorch/\u5f20\u91cf/\u5982\u4f55\u770b\u61c2\u5f20\u91cf\u5f62\u72b6"}}');var a=n(23420),i=n(54213);const r={title:"Dataset Demo","marimo-version":"0.19.2",width:"medium"},l="torch.utils.data.Dataset \u6a21\u5757\u6f14\u793a",d={},o=[{value:"1. \u81ea\u5b9a\u4e49 Dataset",id:"1-\u81ea\u5b9a\u4e49-dataset",level:2},{value:"2. TensorDataset",id:"2-tensordataset",level:2},{value:"3. Subset - \u6570\u636e\u96c6\u5b50\u96c6",id:"3-subset---\u6570\u636e\u96c6\u5b50\u96c6",level:2},{value:"4. random_split - \u968f\u673a\u5206\u5272\u6570\u636e\u96c6",id:"4-random_split---\u968f\u673a\u5206\u5272\u6570\u636e\u96c6",level:2},{value:"5. ConcatDataset - \u8fde\u63a5\u591a\u4e2a\u6570\u636e\u96c6",id:"5-concatdataset---\u8fde\u63a5\u591a\u4e2a\u6570\u636e\u96c6",level:2},{value:"6. \u6570\u636e\u96c6\u7d22\u5f15\u548c\u5207\u7247",id:"6-\u6570\u636e\u96c6\u7d22\u5f15\u548c\u5207\u7247",level:2},{value:"7. \u5b9e\u9645\u5e94\u7528\u793a\u4f8b - \u56fe\u50cf\u5206\u7c7b\u6570\u636e\u96c6",id:"7-\u5b9e\u9645\u5e94\u7528\u793a\u4f8b---\u56fe\u50cf\u5206\u7c7b\u6570\u636e\u96c6",level:2},{value:"8. \u6570\u636e\u96c6\u7ec4\u5408\u4f7f\u7528",id:"8-\u6570\u636e\u96c6\u7ec4\u5408\u4f7f\u7528",level:2},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function c(e){const t={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",metastring:"{.marimo}",children:"import marimo as mo\nimport torch\nfrom torch.utils.data import Dataset, TensorDataset, ConcatDataset, Subset, random_split\nimport numpy as np\n"})}),"\n",(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"torchutilsdatadataset-\u6a21\u5757\u6f14\u793a",children:"torch.utils.data.Dataset \u6a21\u5757\u6f14\u793a"})}),"\n",(0,a.jsx)(t.p,{children:"\u672c\u7b14\u8bb0\u672c\u6f14\u793a PyTorch \u4e2d Dataset \u76f8\u5173\u7684\u5404\u4e2a API \u7528\u6cd5\u3002"}),"\n",(0,a.jsx)(t.h2,{id:"1-\u81ea\u5b9a\u4e49-dataset",children:"1. \u81ea\u5b9a\u4e49 Dataset"}),"\n",(0,a.jsxs)(t.p,{children:["\u6700\u57fa\u7840\u7684\u7528\u6cd5\u662f\u7ee7\u627f ",(0,a.jsx)(t.code,{children:"Dataset"})," \u7c7b\u5e76\u5b9e\u73b0 ",(0,a.jsx)(t.code,{children:"__len__"})," \u548c ",(0,a.jsx)(t.code,{children:"__getitem__"})," \u65b9\u6cd5\u3002"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",metastring:"{.marimo}",children:'class CustomDataset(Dataset):\n    def __init__(self, size=100):\n        self.data = torch.randn(size, 10)\n        self.labels = torch.randint(0, 2, (size,))\n\n    def __len__(self):\n        return len(self.data)\n\n    def __getitem__(self, idx):\n        return self.data[idx], self.labels[idx]\n\ncustom_dataset = CustomDataset(size=50)\nprint(f"\u6570\u636e\u96c6\u5927\u5c0f: {len(custom_dataset)}")\nprint(f"\u7b2c\u4e00\u4e2a\u6837\u672c: {custom_dataset[0]}")\nprint(f"\u7279\u5f81\u5f62\u72b6: {custom_dataset[0][0].shape}")\nprint(f"\u6807\u7b7e: {custom_dataset[0][1].item()}")\n'})}),"\n",(0,a.jsx)(t.h2,{id:"2-tensordataset",children:"2. TensorDataset"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"TensorDataset"})," \u662f\u6700\u7b80\u5355\u7684\u5185\u7f6e Dataset\uff0c\u7528\u4e8e\u5305\u88c5\u5f20\u91cf\u6570\u636e\u3002"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",metastring:"{.marimo}",children:'features = torch.randn(100, 5)\nlabels = torch.randint(0, 3, (100,))\n\ntensor_dataset = TensorDataset(features, labels)\n\nprint(f"TensorDataset \u5927\u5c0f: {len(tensor_dataset)}")\nprint(f"\u7b2c\u4e00\u4e2a\u6837\u672c: {tensor_dataset[0]}")\nprint(f"\u53ef\u4ee5\u540c\u65f6\u5305\u88c5\u591a\u4e2a\u5f20\u91cf")\n'})}),"\n",(0,a.jsx)(t.h2,{id:"3-subset---\u6570\u636e\u96c6\u5b50\u96c6",children:"3. Subset - \u6570\u636e\u96c6\u5b50\u96c6"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"Subset"})," \u7528\u4e8e\u521b\u5efa\u6570\u636e\u96c6\u7684\u5b50\u96c6\uff0c\u901a\u8fc7\u7d22\u5f15\u5217\u8868\u9009\u62e9\u7279\u5b9a\u6837\u672c\u3002"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",metastring:"{.marimo}",children:'indices = [0, 5, 10, 15, 20]\nsubset = Subset(tensor_dataset, indices)\n\nprint(f"\u539f\u59cb\u6570\u636e\u96c6\u5927\u5c0f: {len(tensor_dataset)}")\nprint(f"\u5b50\u96c6\u5927\u5c0f: {len(subset)}")\nprint(f"\u5b50\u96c6\u7b2c\u4e00\u4e2a\u6837\u672c (\u539f\u59cb\u7d22\u5f150): {subset[0]}")\n'})}),"\n",(0,a.jsx)(t.h2,{id:"4-random_split---\u968f\u673a\u5206\u5272\u6570\u636e\u96c6",children:"4. random_split - \u968f\u673a\u5206\u5272\u6570\u636e\u96c6"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"random_split"})," \u7528\u4e8e\u5c06\u6570\u636e\u96c6\u968f\u673a\u5206\u5272\u6210\u591a\u4e2a\u5b50\u96c6\uff0c\u5e38\u7528\u4e8e\u8bad\u7ec3\u96c6/\u9a8c\u8bc1\u96c6/\u6d4b\u8bd5\u96c6\u5212\u5206\u3002"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",metastring:"{.marimo}",children:'torch.manual_seed(42)\n\ntrain_size = int(0.7 * len(tensor_dataset))\nval_size = int(0.15 * len(tensor_dataset))\ntest_size = len(tensor_dataset) - train_size - val_size\n\ntrain_dataset, val_dataset, test_dataset = random_split(\n    tensor_dataset, \n    [train_size, val_size, test_size]\n)\n\nprint(f"\u8bad\u7ec3\u96c6\u5927\u5c0f: {len(train_dataset)}")\nprint(f"\u9a8c\u8bc1\u96c6\u5927\u5c0f: {len(val_dataset)}")\nprint(f"\u6d4b\u8bd5\u96c6\u5927\u5c0f: {len(test_dataset)}")\nprint(f"\u603b\u5927\u5c0f: {len(train_dataset) + len(val_dataset) + len(test_dataset)}")\n'})}),"\n",(0,a.jsx)(t.h2,{id:"5-concatdataset---\u8fde\u63a5\u591a\u4e2a\u6570\u636e\u96c6",children:"5. ConcatDataset - \u8fde\u63a5\u591a\u4e2a\u6570\u636e\u96c6"}),"\n",(0,a.jsxs)(t.p,{children:[(0,a.jsx)(t.code,{children:"ConcatDataset"})," \u7528\u4e8e\u5c06\u591a\u4e2a\u6570\u636e\u96c6\u8fde\u63a5\u6210\u4e00\u4e2a\u5927\u6570\u636e\u96c6\u3002"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",metastring:"{.marimo}",children:'dataset1 = CustomDataset(size=30)\ndataset2 = CustomDataset(size=20)\ndataset3 = CustomDataset(size=50)\n\nconcat_dataset = ConcatDataset([dataset1, dataset2, dataset3])\n\nprint(f"\u6570\u636e\u96c61\u5927\u5c0f: {len(dataset1)}")\nprint(f"\u6570\u636e\u96c62\u5927\u5c0f: {len(dataset2)}")\nprint(f"\u6570\u636e\u96c63\u5927\u5c0f: {len(dataset3)}")\nprint(f"\u8fde\u63a5\u540e\u6570\u636e\u96c6\u5927\u5c0f: {len(concat_dataset)}")\nprint(f"\u8bbf\u95ee\u7b2c35\u4e2a\u6837\u672c (\u6765\u81eadataset2): {concat_dataset[35][0].shape}")\n'})}),"\n",(0,a.jsx)(t.h2,{id:"6-\u6570\u636e\u96c6\u7d22\u5f15\u548c\u5207\u7247",children:"6. \u6570\u636e\u96c6\u7d22\u5f15\u548c\u5207\u7247"}),"\n",(0,a.jsx)(t.p,{children:"Dataset \u652f\u6301\u7d22\u5f15\u8bbf\u95ee\uff0c\u67d0\u4e9b\u5b9e\u73b0\u4e5f\u652f\u6301\u5207\u7247\u64cd\u4f5c\u3002"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",metastring:"{.marimo}",children:'print("\u5355\u4e2a\u7d22\u5f15\u8bbf\u95ee:")\nsample = custom_dataset[5]\nprint(f"  \u6837\u672c5: \u7279\u5f81\u5f62\u72b6={sample[0].shape}, \u6807\u7b7e={sample[1].item()}")\n\nprint("\\n\u6279\u91cf\u7d22\u5f15\u8bbf\u95ee:")\nfor i in range(3):\n    sample = custom_dataset[i]\n    print(f"  \u6837\u672c{i}: \u6807\u7b7e={sample[1].item()}")\n'})}),"\n",(0,a.jsx)(t.h2,{id:"7-\u5b9e\u9645\u5e94\u7528\u793a\u4f8b---\u56fe\u50cf\u5206\u7c7b\u6570\u636e\u96c6",children:"7. \u5b9e\u9645\u5e94\u7528\u793a\u4f8b - \u56fe\u50cf\u5206\u7c7b\u6570\u636e\u96c6"}),"\n",(0,a.jsx)(t.p,{children:"\u521b\u5efa\u4e00\u4e2a\u6a21\u62df\u56fe\u50cf\u5206\u7c7b\u4efb\u52a1\u7684\u6570\u636e\u96c6\u3002"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",metastring:"{.marimo}",children:'class ImageClassificationDataset(Dataset):\n    def __init__(self, num_samples=1000, img_size=(3, 224, 224), num_classes=10):\n        self.num_samples = num_samples\n        self.img_size = img_size\n        self.num_classes = num_classes\n\n        self.images = torch.randn(num_samples, *img_size)\n        self.labels = torch.randint(0, num_classes, (num_samples,))\n\n    def __len__(self):\n        return self.num_samples\n\n    def __getitem__(self, idx):\n        image = self.images[idx]\n        label = self.labels[idx]\n\n        image = (image - image.mean()) / (image.std() + 1e-8)\n\n        return image, label\n\n    def get_class_distribution(self):\n        unique, counts = torch.unique(self.labels, return_counts=True)\n        return dict(zip(unique.tolist(), counts.tolist()))\n\nimg_dataset = ImageClassificationDataset(num_samples=500, num_classes=5)\n\nprint(f"\u56fe\u50cf\u6570\u636e\u96c6\u5927\u5c0f: {len(img_dataset)}")\nprint(f"\u56fe\u50cf\u5f62\u72b6: {img_dataset[0][0].shape}")\nprint(f"\u7c7b\u522b\u5206\u5e03: {img_dataset.get_class_distribution()}")\n'})}),"\n",(0,a.jsx)(t.h2,{id:"8-\u6570\u636e\u96c6\u7ec4\u5408\u4f7f\u7528",children:"8. \u6570\u636e\u96c6\u7ec4\u5408\u4f7f\u7528"}),"\n",(0,a.jsx)(t.p,{children:"\u5c55\u793a\u5982\u4f55\u7ec4\u5408\u4f7f\u7528\u591a\u4e2a Dataset \u5de5\u5177\u3002"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",metastring:"{.marimo}",children:'torch.manual_seed(123)\n\ntrain_set, temp_set = random_split(img_dataset, [400, 100])\nval_set, test_set = random_split(temp_set, [50, 50])\n\nprint("\u6570\u636e\u96c6\u5212\u5206:")\nprint(f"  \u8bad\u7ec3\u96c6: {len(train_set)} \u6837\u672c")\nprint(f"  \u9a8c\u8bc1\u96c6: {len(val_set)} \u6837\u672c")\nprint(f"  \u6d4b\u8bd5\u96c6: {len(test_set)} \u6837\u672c")\n\nsmall_train_indices = list(range(0, 100))\nsmall_train_set = Subset(train_set, small_train_indices)\nprint(f"\\n\u5c0f\u8bad\u7ec3\u96c6 (\u524d100\u4e2a\u6837\u672c): {len(small_train_set)} \u6837\u672c")\n'})}),"\n",(0,a.jsx)(t.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,a.jsxs)(t.p,{children:["\u672c\u7b14\u8bb0\u672c\u6f14\u793a\u4e86 ",(0,a.jsx)(t.code,{children:"torch.utils.data.Dataset"})," \u6a21\u5757\u7684\u4e3b\u8981 API:"]}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Dataset"})," - \u57fa\u7840\u62bd\u8c61\u7c7b\uff0c\u9700\u8981\u5b9e\u73b0 ",(0,a.jsx)(t.code,{children:"__len__"})," \u548c ",(0,a.jsx)(t.code,{children:"__getitem__"})]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"TensorDataset"})," - \u7b80\u5355\u5305\u88c5\u5f20\u91cf\u7684\u6570\u636e\u96c6"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Subset"})," - \u521b\u5efa\u6570\u636e\u96c6\u5b50\u96c6"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"random_split"})," - \u968f\u673a\u5206\u5272\u6570\u636e\u96c6"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"ConcatDataset"})," - \u8fde\u63a5\u591a\u4e2a\u6570\u636e\u96c6"]}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"\u8fd9\u4e9b\u5de5\u5177\u53ef\u4ee5\u7075\u6d3b\u7ec4\u5408\u4f7f\u7528\uff0c\u6ee1\u8db3\u5404\u79cd\u6570\u636e\u5904\u7406\u9700\u6c42\u3002"})]})}function m(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);