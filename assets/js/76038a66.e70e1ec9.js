"use strict";(self.webpackChunknotes_3=self.webpackChunknotes_3||[]).push([[60214],{54213:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>d});var r=s(36672);const o={},t=r.createContext(o);function c(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:c(e.components),r.createElement(t.Provider,{value:n},e.children)}},57796:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"Tools/\u7f16\u7801\u4ee3\u7406/OpenCode/\u81ea\u5b9a\u4e49\u5de5\u5177","title":"\u81ea\u5b9a\u4e49\u5de5\u5177","description":"\u5728 opencode \u4e2d\u521b\u5efa LLM \u53ef\u8c03\u7528\u7684\u5de5\u5177","source":"@site/docs/Tools/\u7f16\u7801\u4ee3\u7406/OpenCode/\u81ea\u5b9a\u4e49\u5de5\u5177.md","sourceDirName":"Tools/\u7f16\u7801\u4ee3\u7406/OpenCode","slug":"/Tools/\u7f16\u7801\u4ee3\u7406/OpenCode/\u81ea\u5b9a\u4e49\u5de5\u5177","permalink":"/notes3/docs/Tools/\u7f16\u7801\u4ee3\u7406/OpenCode/\u81ea\u5b9a\u4e49\u5de5\u5177","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Tools/\u7f16\u7801\u4ee3\u7406/OpenCode/\u81ea\u5b9a\u4e49\u5de5\u5177.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tools","previous":{"title":"\u81ea\u5b9a\u4e49\u547d\u4ee4","permalink":"/notes3/docs/Tools/\u7f16\u7801\u4ee3\u7406/OpenCode/\u81ea\u5b9a\u4e49\u547d\u4ee4"},"next":{"title":"\u89c4\u5219","permalink":"/notes3/docs/Tools/\u7f16\u7801\u4ee3\u7406/OpenCode/\u89c4\u5219"}}');var o=s(23420),t=s(54213);const c={},d=void 0,i={},l=[{value:"\u521b\u5efa\u5de5\u5177",id:"\u521b\u5efa\u5de5\u5177",level:2},{value:"\u4f4d\u7f6e",id:"\u4f4d\u7f6e",level:3},{value:"\u7ed3\u6784",id:"\u7ed3\u6784",level:3},{value:"\u5355\u4e2a\u6587\u4ef6\u4e2d\u7684\u591a\u4e2a\u5de5\u5177",id:"\u5355\u4e2a\u6587\u4ef6\u4e2d\u7684\u591a\u4e2a\u5de5\u5177",level:4},{value:"\u53c2\u6570",id:"\u53c2\u6570",level:3},{value:"\u4e0a\u4e0b\u6587",id:"\u4e0a\u4e0b\u6587",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:2},{value:"\u7528 Python \u7f16\u5199\u5de5\u5177",id:"\u7528-python-\u7f16\u5199\u5de5\u5177",level:3}];function a(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"\u5728 opencode \u4e2d\u521b\u5efa LLM \u53ef\u8c03\u7528\u7684\u5de5\u5177"}),"\n",(0,o.jsxs)(n.p,{children:["\u81ea\u5b9a\u4e49\u5de5\u5177\u662f\u4f60\u521b\u5efa\u7684\u51fd\u6570\uff0cLLM \u53ef\u4ee5\u5728\u5bf9\u8bdd\u8fc7\u7a0b\u4e2d\u8c03\u7528\u5b83\u4eec\u3002\u5b83\u4eec\u4e0e opencode \u7684\u5185\u7f6e\u5de5\u5177\uff08\u5982 ",(0,o.jsx)(n.code,{children:"read"}),"\u3001",(0,o.jsx)(n.code,{children:"write"})," \u548c ",(0,o.jsx)(n.code,{children:"bash"}),"\uff09\u534f\u540c\u5de5\u4f5c\u3002"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"\u521b\u5efa\u5de5\u5177",children:(0,o.jsx)(n.a,{href:"#creating-a-tool",children:"\u521b\u5efa\u5de5\u5177"})}),"\n",(0,o.jsxs)(n.p,{children:["\u5de5\u5177\u5b9a\u4e49\u4e3a ",(0,o.jsx)(n.strong,{children:"TypeScript"})," \u6216 ",(0,o.jsx)(n.strong,{children:"JavaScript"})," \u6587\u4ef6\u3002\u4f46\u662f\uff0c\u5de5\u5177\u5b9a\u4e49\u53ef\u4ee5\u8c03\u7528\u7528",(0,o.jsx)(n.strong,{children:"\u4efb\u4f55\u8bed\u8a00"}),"\u7f16\u5199\u7684\u811a\u672c\u2014\u2014TypeScript \u6216 JavaScript \u4ec5\u7528\u4e8e\u5de5\u5177\u5b9a\u4e49\u672c\u8eab\u3002"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h3,{id:"\u4f4d\u7f6e",children:(0,o.jsx)(n.a,{href:"#location",children:"\u4f4d\u7f6e"})}),"\n",(0,o.jsx)(n.p,{children:"\u5b83\u4eec\u53ef\u4ee5\u5b9a\u4e49\u5728\uff1a"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\u672c\u5730\uff1a\u901a\u8fc7\u5c06\u5b83\u4eec\u653e\u7f6e\u5728\u9879\u76ee\u7684 ",(0,o.jsx)(n.code,{children:".opencode/tool/"})," \u76ee\u5f55\u4e2d\u3002"]}),"\n",(0,o.jsxs)(n.li,{children:["\u5168\u5c40\uff1a\u901a\u8fc7\u5c06\u5b83\u4eec\u653e\u7f6e\u5728 ",(0,o.jsx)(n.code,{children:"~/.config/opencode/tool/"})," \u4e2d\u3002"]}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h3,{id:"\u7ed3\u6784",children:(0,o.jsx)(n.a,{href:"#structure",children:"\u7ed3\u6784"})}),"\n",(0,o.jsxs)(n.p,{children:["\u521b\u5efa\u5de5\u5177\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u662f\u4f7f\u7528 ",(0,o.jsx)(n.code,{children:"tool()"})," \u8f85\u52a9\u51fd\u6570\uff0c\u5b83\u63d0\u4f9b\u7c7b\u578b\u5b89\u5168\u548c\u9a8c\u8bc1\u3002"]}),"\n",(0,o.jsx)(n.p,{children:".opencode/tool/database.ts"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { tool } from "@opencode-ai/plugin"\n\nexport default tool({\n  description: "Query the project database",\n  args: {\n    query: tool.schema.string().describe("SQL query to execute"),\n  },\n  async execute(args) {\n    // Your database logic here\n    return `Executed query: ${args.query}`\n  },\n})\n'})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.strong,{children:"\u6587\u4ef6\u540d"}),"\u5373\u4e3a",(0,o.jsx)(n.strong,{children:"\u5de5\u5177\u540d"}),"\u3002\u4e0a\u9762\u7684\u4ee3\u7801\u521b\u5efa\u4e86\u4e00\u4e2a ",(0,o.jsx)(n.code,{children:"database"})," \u5de5\u5177\u3002"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h4,{id:"\u5355\u4e2a\u6587\u4ef6\u4e2d\u7684\u591a\u4e2a\u5de5\u5177",children:(0,o.jsx)(n.a,{href:"#multiple-tools-per-file",children:"\u5355\u4e2a\u6587\u4ef6\u4e2d\u7684\u591a\u4e2a\u5de5\u5177"})}),"\n",(0,o.jsxs)(n.p,{children:["\u4f60\u4e5f\u53ef\u4ee5\u4ece\u5355\u4e2a\u6587\u4ef6\u4e2d\u5bfc\u51fa\u591a\u4e2a\u5de5\u5177\u3002\u6bcf\u4e2a\u5bfc\u51fa\u90fd\u4f1a\u6210\u4e3a",(0,o.jsx)(n.strong,{children:"\u4e00\u4e2a\u72ec\u7acb\u7684\u5de5\u5177"}),"\uff0c\u540d\u79f0\u4e3a ",(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.code,{children:"<\u6587\u4ef6\u540d>_<\u5bfc\u51fa\u540d>"})}),"\uff1a"]}),"\n",(0,o.jsx)(n.p,{children:".opencode/tool/math.ts"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { tool } from "@opencode-ai/plugin"\n\nexport const add = tool({\n  description: "Add two numbers",\n  args: {\n    a: tool.schema.number().describe("First number"),\n    b: tool.schema.number().describe("Second number"),\n  },\n  async execute(args) {\n    return args.a + args.b\n  },\n})\n\nexport const multiply = tool({\n  description: "Multiply two numbers",\n  args: {\n    a: tool.schema.number().describe("First number"),\n    b: tool.schema.number().describe("Second number"),\n  },\n  async execute(args) {\n    return args.a * args.b\n  },\n})\n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u8fd9\u5c06\u521b\u5efa\u4e24\u4e2a\u5de5\u5177\uff1a",(0,o.jsx)(n.code,{children:"math_add"})," \u548c ",(0,o.jsx)(n.code,{children:"math_multiply"}),"\u3002"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h3,{id:"\u53c2\u6570",children:(0,o.jsx)(n.a,{href:"#arguments",children:"\u53c2\u6570"})}),"\n",(0,o.jsxs)(n.p,{children:["\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,o.jsx)(n.code,{children:"tool.schema"}),"\uff08\u5373 ",(0,o.jsx)(n.a,{href:"https://zod.dev",children:"Zod"}),"\uff09\u6765\u5b9a\u4e49\u53c2\u6570\u7c7b\u578b\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'args: {\n  query: tool.schema.string().describe("SQL query to execute")\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u4f60\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5bfc\u5165 ",(0,o.jsx)(n.a,{href:"https://zod.dev",children:"Zod"})," \u5e76\u8fd4\u56de\u4e00\u4e2a\u666e\u901a\u5bf9\u8c61\uff1a"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { z } from "zod"\n\nexport default {\n  description: "Tool description",\n  args: {\n    param: z.string().describe("Parameter description"),\n  },\n  async execute(args, context) {\n    // Tool implementation\n    return "result"\n  },\n}\n'})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h3,{id:"\u4e0a\u4e0b\u6587",children:(0,o.jsx)(n.a,{href:"#context",children:"\u4e0a\u4e0b\u6587"})}),"\n",(0,o.jsx)(n.p,{children:"\u5de5\u5177\u63a5\u6536\u5173\u4e8e\u5f53\u524d\u4f1a\u8bdd\u7684\u4e0a\u4e0b\u6587\uff1a"}),"\n",(0,o.jsx)(n.p,{children:".opencode/tool/project.ts"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { tool } from "@opencode-ai/plugin"\n\nexport default tool({\n  description: "Get project information",\n  args: {},\n  async execute(args, context) {\n    // Access context information\n    const { agent, sessionID, messageID } = context\n    return `Agent: ${agent}, Session: ${sessionID}, Message: ${messageID}`\n  },\n})\n'})}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"\u793a\u4f8b",children:(0,o.jsx)(n.a,{href:"#examples",children:"\u793a\u4f8b"})}),"\n",(0,o.jsx)(n.h3,{id:"\u7528-python-\u7f16\u5199\u5de5\u5177",children:(0,o.jsx)(n.a,{href:"#write-a-tool-in-python",children:"\u7528 Python \u7f16\u5199\u5de5\u5177"})}),"\n",(0,o.jsx)(n.p,{children:"\u4f60\u53ef\u4ee5\u7528\u4efb\u4f55\u4f60\u60f3\u8981\u7684\u8bed\u8a00\u7f16\u5199\u5de5\u5177\u3002\u8fd9\u662f\u4e00\u4e2a\u4f7f\u7528 Python \u76f8\u52a0\u4e24\u4e2a\u6570\u5b57\u7684\u793a\u4f8b\u3002"}),"\n",(0,o.jsx)(n.p,{children:"\u9996\u5148\uff0c\u5c06\u5de5\u5177\u521b\u5efa\u4e3a Python \u811a\u672c\uff1a"}),"\n",(0,o.jsx)(n.p,{children:".opencode/tool/add.py"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:"import sys\n\na = int(sys.argv[1])\nb = int(sys.argv[2])\n\nprint(a + b)\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u7136\u540e\u521b\u5efa\u8c03\u7528\u5b83\u7684\u5de5\u5177\u5b9a\u4e49\uff1a"}),"\n",(0,o.jsx)(n.p,{children:".opencode/tool/python-add.ts"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-typescript",children:'import { tool } from "@opencode-ai/plugin"\n\nexport default tool({\n  description: "Add two numbers using Python",\n  args: {\n    a: tool.schema.number().describe("First number"),\n    b: tool.schema.number().describe("Second number"),\n  },\n  async execute(args) {\n    const result = await Bun.$`python3 .opencode/tool/add.py ${args.a} ${args.b}`.text()\n    return result.trim()\n  },\n})\n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u8fd9\u91cc\u6211\u4eec\u4f7f\u7528 ",(0,o.jsx)(n.a,{href:"https://bun.com/docs/runtime/shell",children:(0,o.jsx)(n.code,{children:"Bun.$"})})," \u5de5\u5177\u6765\u8fd0\u884c Python \u811a\u672c\u3002"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}}}]);