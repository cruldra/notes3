"use strict";(self.webpackChunknotes_3=self.webpackChunknotes_3||[]).push([[959],{9812:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"Python/BuiltInModules/asyncio","title":"asyncio","description":"asyncio\u6a21\u5757\u7528\u4e8e\u5728Python\u4e2d\u5b9e\u73b0\u5f02\u6b65\u7f16\u7a0b.","source":"@site/docs/Python/BuiltInModules/asyncio.mdx","sourceDirName":"Python/BuiltInModules","slug":"/Python/BuiltInModules/asyncio","permalink":"/notes3/docs/Python/BuiltInModules/asyncio","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Python/BuiltInModules/asyncio.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"python","previous":{"title":"\u5185\u7f6e\u6a21\u5757","permalink":"/notes3/docs/category/\u5185\u7f6e\u6a21\u5757"},"next":{"title":"configparser","permalink":"/notes3/docs/Python/BuiltInModules/configparser"}}');var t=r(6070),o=r(5658);const a={},i=void 0,c={},l=[{value:"\u793a\u4f8b1:\u5e76\u53d1\u6267\u884c",id:"\u793a\u4f8b1\u5e76\u53d1\u6267\u884c",level:2},{value:"\u793a\u4f8b2:\u8d85\u65f6\u63a7\u5236",id:"\u793a\u4f8b2\u8d85\u65f6\u63a7\u5236",level:2},{value:"\u793a\u4f8b3:\u4e8b\u4ef6\u5faa\u73af",id:"\u793a\u4f8b3\u4e8b\u4ef6\u5faa\u73af",level:2},{value:"\u793a\u4f8b4:\u961f\u5217",id:"\u793a\u4f8b4\u961f\u5217",level:2},{value:"\u793a\u4f8b5:\u5f02\u6b65\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668",id:"\u793a\u4f8b5\u5f02\u6b65\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668",level:2},{value:"\u793a\u4f8b6:\u9501\u548c\u540c\u6b65\u539f\u8bed",id:"\u793a\u4f8b6\u9501\u548c\u540c\u6b65\u539f\u8bed",level:2}];function u(n){const e={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",...(0,o.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.a,{href:"https://docs.python.org/zh-cn/3/library/asyncio.html",children:"asyncio"}),"\u6a21\u5757\u7528\u4e8e\u5728",(0,t.jsx)(e.code,{children:"Python"}),"\u4e2d\u5b9e\u73b0\u5f02\u6b65\u7f16\u7a0b."]}),"\n",(0,t.jsx)(e.h2,{id:"\u793a\u4f8b1\u5e76\u53d1\u6267\u884c",children:"\u793a\u4f8b1:\u5e76\u53d1\u6267\u884c"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import asyncio\r\n\r\nasync def process_item(item):\r\n    await asyncio.sleep(1)  # \u6a21\u62df\u8017\u65f6\u64cd\u4f5c\r\n    return item * 2\r\n\r\nasync def main():\r\n    # \u5e76\u53d1\u5904\u7406\u591a\u4e2a\u4efb\u52a1\r\n    items = [1, 2, 3, 4, 5]\r\n    tasks = [process_item(item) for item in items]\r\n    results = await asyncio.gather(*tasks)\r\n    print(results)  # [2, 4, 6, 8, 10]\r\n\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u793a\u4f8b2\u8d85\u65f6\u63a7\u5236",children:"\u793a\u4f8b2:\u8d85\u65f6\u63a7\u5236"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'import asyncio\r\n\r\nasync def long_operation():\r\n    await asyncio.sleep(5)\r\n    return "\u5b8c\u6210"\r\n\r\nasync def main():\r\n    try:\r\n        # \u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4\u4e3a2\u79d2\r\n        result = await asyncio.wait_for(long_operation(), timeout=2)\r\n    except asyncio.TimeoutError:\r\n        print("\u64cd\u4f5c\u8d85\u65f6")\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u793a\u4f8b3\u4e8b\u4ef6\u5faa\u73af",children:"\u793a\u4f8b3:\u4e8b\u4ef6\u5faa\u73af"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import asyncio\r\n\r\n# \u83b7\u53d6\u4e8b\u4ef6\u5faa\u73af\r\nloop = asyncio.get_event_loop()\r\n\r\n# \u5728\u5faa\u73af\u4e2d\u8fd0\u884c\u534f\u7a0b\r\nloop.run_until_complete(main())\r\n\r\n# \u5173\u95ed\u5faa\u73af\r\nloop.close()\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u793a\u4f8b4\u961f\u5217",children:"\u793a\u4f8b4:\u961f\u5217"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'async def producer(queue):\r\n    for i in range(5):\r\n        await queue.put(i)\r\n        await asyncio.sleep(1)\r\n\r\nasync def consumer(queue):\r\n    while True:\r\n        item = await queue.get()\r\n        print(f"\u5904\u7406\u9879\u76ee: {item}")\r\n        queue.task_done()\r\n\r\nasync def main():\r\n    queue = asyncio.Queue()\r\n    # \u521b\u5efa\u751f\u4ea7\u8005\u548c\u6d88\u8d39\u8005\u4efb\u52a1\r\n    producer_task = asyncio.create_task(producer(queue))\r\n    consumer_task = asyncio.create_task(consumer(queue))\r\n    await producer_task\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u793a\u4f8b5\u5f02\u6b65\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668",children:"\u793a\u4f8b5:\u5f02\u6b65\u4e0a\u4e0b\u6587\u7ba1\u7406\u5668"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'class AsyncResource:\r\n    async def __aenter__(self):\r\n        print("\u83b7\u53d6\u8d44\u6e90")\r\n        return self\r\n\r\n    async def __aexit__(self, exc_type, exc, tb):\r\n        print("\u91ca\u653e\u8d44\u6e90")\r\n\r\nasync def main():\r\n    async with AsyncResource():\r\n        print("\u4f7f\u7528\u8d44\u6e90")\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u793a\u4f8b6\u9501\u548c\u540c\u6b65\u539f\u8bed",children:"\u793a\u4f8b6:\u9501\u548c\u540c\u6b65\u539f\u8bed"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"lock = asyncio.Lock()\r\n\r\nasync def protected_operation():\r\n    async with lock:\r\n        # \u8fd9\u6bb5\u4ee3\u7801\u540c\u4e00\u65f6\u95f4\u53ea\u80fd\u6709\u4e00\u4e2a\u534f\u7a0b\u6267\u884c\r\n        await asyncio.sleep(1)\n"})})]})}function d(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(u,{...n})}):u(n)}},5658:(n,e,r)=>{r.d(e,{R:()=>a,x:()=>i});var s=r(758);const t={},o=s.createContext(t);function a(n){const e=s.useContext(o);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:a(n.components),s.createElement(o.Provider,{value:e},n.children)}}}]);