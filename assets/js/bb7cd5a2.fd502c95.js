"use strict";(self.webpackChunknotes_3=self.webpackChunknotes_3||[]).push([[40861],{54213:(e,n,l)=>{l.d(n,{R:()=>o,x:()=>c});var s=l(36672);const i={},r=s.createContext(i);function o(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:n},e.children)}},99991:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>t,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"Python/Libraries/Plumbum/\u7b80\u4ecb","title":"Plumbum\uff1aShell \u7ec4\u5408\u5b50","description":"\u662f\u5426\u66fe\u5e0c\u671b\u5c06 Shell \u811a\u672c\u7684\u7b80\u6d01\u6027\u5e26\u5165\u771f\u6b63\u7684\u7f16\u7a0b\u8bed\u8a00\u4e2d\uff1f","source":"@site/docs/Python/Libraries/Plumbum/\u7b80\u4ecb.mdx","sourceDirName":"Python/Libraries/Plumbum","slug":"/Python/Libraries/Plumbum/\u7b80\u4ecb","permalink":"/notes3/docs/Python/Libraries/Plumbum/\u7b80\u4ecb","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Python/Libraries/Plumbum/\u7b80\u4ecb.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"python","previous":{"title":"PySide6 \u5e38\u7528\u7ec4\u4ef6\u8be6\u89e3","permalink":"/notes3/docs/Python/Libraries/Gui/PySide6\u5e38\u7528\u7ec4\u4ef6"},"next":{"title":"PydanticSettings","permalink":"/notes3/docs/Python/Libraries/PydanticSettings"}}');var i=l(23420),r=l(54213);const o={},c="Plumbum\uff1aShell \u7ec4\u5408\u5b50",t={},a=[{value:"\u901f\u67e5\u8868",id:"\u901f\u67e5\u8868",level:2},{value:"\u57fa\u7840",id:"\u57fa\u7840",level:3},{value:"\u7ba1\u9053 (Piping)",id:"\u7ba1\u9053-piping",level:3},{value:"\u91cd\u5b9a\u5411 (Redirection)",id:"\u91cd\u5b9a\u5411-redirection",level:3},{value:"\u5de5\u4f5c\u76ee\u5f55\u64cd\u4f5c",id:"\u5de5\u4f5c\u76ee\u5f55\u64cd\u4f5c",level:3},{value:"\u524d\u53f0\u548c\u540e\u53f0\u6267\u884c",id:"\u524d\u53f0\u548c\u540e\u53f0\u6267\u884c",level:3},{value:"\u547d\u4ee4\u5d4c\u5957",id:"\u547d\u4ee4\u5d4c\u5957",level:3},{value:"\u8fdc\u7a0b\u547d\u4ee4\uff08\u901a\u8fc7 SSH\uff09",id:"\u8fdc\u7a0b\u547d\u4ee4\u901a\u8fc7-ssh",level:3},{value:"CLI \u5e94\u7528\u7a0b\u5e8f",id:"cli-\u5e94\u7528\u7a0b\u5e8f",level:3},{value:"\u793a\u4f8b\u8f93\u51fa",id:"\u793a\u4f8b\u8f93\u51fa",level:4},{value:"\u989c\u8272\u548c\u6837\u5f0f",id:"\u989c\u8272\u548c\u6837\u5f0f",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"plumbumshell-\u7ec4\u5408\u5b50",children:"Plumbum\uff1aShell \u7ec4\u5408\u5b50"})}),"\n",(0,i.jsxs)(n.p,{children:["\u662f\u5426\u66fe\u5e0c\u671b\u5c06 Shell \u811a\u672c\u7684\u7b80\u6d01\u6027\u5e26\u5165",(0,i.jsx)(n.strong,{children:"\u771f\u6b63"}),"\u7684\u7f16\u7a0b\u8bed\u8a00\u4e2d\uff1f\n\u5411 ",(0,i.jsx)(n.em,{children:"Plumbum Shell Combinators"})," \u95ee\u597d\u3002Plumbum\uff08\u62c9\u4e01\u8bed\u4e2d\u7684",(0,i.jsx)(n.em,{children:"\u94c5"}),"\uff0c\u53e4\u65f6\u7528\u4e8e\u5236\u9020\u7ba1\u9053\uff09\u662f\u4e00\u4e2a\u5c0f\u5de7\u4f46\u529f\u80fd\u4e30\u5bcc\u7684\u5e93\uff0c\u7528\u4e8e\u5728 Python \u4e2d\u7f16\u5199\u7c7b\u4f3c Shell \u811a\u672c\u7684\u7a0b\u5e8f\u3002\n\u8be5\u5e93\u7684\u5ea7\u53f3\u94ed\u662f ",(0,i.jsx)(n.strong,{children:"\u201c\u4e0d\u518d\u7f16\u5199 Shell \u811a\u672c\u201d"}),"\uff0c\u56e0\u6b64\u5b83\u5728\u5408\u7406\u7684\u60c5\u51b5\u4e0b\u5c1d\u8bd5\u6a21\u4eff ",(0,i.jsx)(n.strong,{children:"Shell \u8bed\u6cd5"}),"\uff08\u201cShell \u7ec4\u5408\u5b50\u201d\uff09\uff0c\u540c\u65f6\u4fdd\u6301 ",(0,i.jsx)(n.strong,{children:"Python \u98ce\u683c\u548c\u8de8\u5e73\u53f0\u7279\u6027"}),"\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u9664\u4e86\u7c7b Shell \u8bed\u6cd5\u548c\u4fbf\u6377\u7684\u5feb\u6377\u65b9\u5f0f\u5916\uff0c\u8be5\u5e93\u8fd8\u63d0\u4f9b\u672c\u5730\u548c\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff08\u901a\u8fc7 SSH\uff09\u3001\u672c\u5730\u548c\u8fdc\u7a0b\u6587\u4ef6\u7cfb\u7edf\u8def\u5f84\u3001\u7b80\u5355\u7684\u5de5\u4f5c\u76ee\u5f55\u548c\u73af\u5883\u53d8\u91cf\u64cd\u4f5c\uff0c\u4ee5\u53ca\u4e00\u5957\u7f16\u7a0b\u5316\u7684\u547d\u4ee4\u884c\u754c\u9762\uff08CLI\uff09\u5e94\u7528\u7a0b\u5e8f\u5de5\u5177\u5305\u3002\n\u73b0\u5728\u8ba9\u6211\u4eec\u770b\u4e00\u4e9b\u4ee3\u7801\uff01"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"\u8fd9\u53ea\u662f\u4e00\u4e2a\u9884\u544a\uff1b\u5b8c\u6574\u6587\u6863\u53ef\u4ee5\u5728"}),"\n",(0,i.jsx)(n.a,{href:"https://plumbum.readthedocs.io",children:"Read the Docs"})," ",(0,i.jsx)(n.em,{children:"\u627e\u5230"})]}),"\n",(0,i.jsx)(n.h2,{id:"\u901f\u67e5\u8868",children:"\u901f\u67e5\u8868"}),"\n",(0,i.jsx)(n.h3,{id:"\u57fa\u7840",children:"\u57fa\u7840"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:">>> from plumbum import local\n>>> local.cmd.ls\nLocalCommand(/bin/ls)\n>>> local.cmd.ls()\n'build.py\\nCHANGELOG.rst\\nconda.recipe\\nCONTRIBUTING.rst\\ndocs\\nexamples\\nexperiments\\nLICENSE\\nMANIFEST.in\\nPipfile\\nplumbum\\nplumbum.egg-info\\npytest.ini\\nREADME.rst\\nsetup.cfg\\nsetup.py\\ntests\\ntranslations.py\\n'\n>>> notepad = local[\"c:\\\\windows\\\\notepad.exe\"]\n>>> notepad()                                   # \u8bb0\u4e8b\u672c\u7a97\u53e3\u5f39\u51fa\n''                                              # \u7528\u6237\u5173\u95ed\u8bb0\u4e8b\u672c\u7a97\u53e3\uff0c\u547d\u4ee4\u8fd4\u56de\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c\u4f60\u6709\u4e00\u4e2a\u547d\u540d\u4e0d\u5bfb\u5e38\u7684\u53ef\u6267\u884c\u6587\u4ef6\u6216\u53ef\u6267\u884c\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:'local["ls"]'}),"\u3002",(0,i.jsx)(n.code,{children:"local"})," \u5bf9\u8c61\u4ee3\u8868\u4f60\u7684\u672c\u5730\u673a\u5668\u3002\u6b63\u5982\u4f60\u5c06\u770b\u5230\u7684\uff0cPlumbum \u4e5f\u63d0\u4f9b\u4e86\u4f7f\u7528\u76f8\u540c API \u7684\u8fdc\u7a0b\u673a\u5668\uff01\n\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"from plumbum.cmd import ls"})," \u6765\u8bbf\u95ee ",(0,i.jsx)(n.code,{children:"PATH"})," \u4e2d\u7684\u7a0b\u5e8f\u3002"]}),"\n",(0,i.jsx)(n.h3,{id:"\u7ba1\u9053-piping",children:"\u7ba1\u9053 (Piping)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'>>> from plumbum.cmd import ls, grep, wc\n>>> chain = ls["-a"] | grep["-v", r"\\.py"] | wc["-l"]\n>>> print(chain)\n/bin/ls -a | /bin/grep -v \'\\.py\' | /usr/bin/wc -l\n>>> chain()\n\'27\\n\'\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u91cd\u5b9a\u5411-redirection",children:"\u91cd\u5b9a\u5411 (Redirection)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'>>> from plumbum.cmd import cat, head\n>>> ((cat < "setup.py") | head["-n", 4])()\n\'#!/usr/bin/env python3\\nimport os\\n\\ntry:\\n\'\n>>> (ls["-a"] > "file.list")()\n\'\'\n>>> (cat["file.list"] | wc["-l"] )()\n\'31\\n\'\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u5de5\u4f5c\u76ee\u5f55\u64cd\u4f5c",children:"\u5de5\u4f5c\u76ee\u5f55\u64cd\u4f5c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:">>> local.cwd\n<LocalWorkdir /home/tomer/workspace/plumbum>\n>>> with local.cwd(local.cwd / \"docs\"):\n...     chain()\n...\n'22\\n'\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u524d\u53f0\u548c\u540e\u53f0\u6267\u884c",children:"\u524d\u53f0\u548c\u540e\u53f0\u6267\u884c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'>>> from plumbum import FG, BG\n>>> (ls["-a"] | grep[r"\\.py"]) & FG         # \u8f93\u51fa\u76f4\u63a5\u6253\u5370\u5230 stdout\nbuild.py\nsetup.py\ntranslations.py\n>>> (ls["-a"] | grep[r"\\.py"]) & BG         # \u8fdb\u7a0b\u201c\u5728\u540e\u53f0\u201d\u8fd0\u884c\n<Future [\'/bin/grep\', \'\\\\.py\'] (running)> \n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u547d\u4ee4\u5d4c\u5957",children:"\u547d\u4ee4\u5d4c\u5957"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'>>> from plumbum.cmd import sudo, ifconfig\n>>> print(sudo[ifconfig["-a"]])\n/usr/bin/sudo /sbin/ifconfig -a\n>>> (sudo[ifconfig["-a"]] | grep["-i", "loop"]) & FG\nlo        Link encap:Local Loopback\n              UP LOOPBACK RUNNING  MTU:16436  Metric:1\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u8fdc\u7a0b\u547d\u4ee4\u901a\u8fc7-ssh",children:"\u8fdc\u7a0b\u547d\u4ee4\uff08\u901a\u8fc7 SSH\uff09"}),"\n",(0,i.jsxs)(n.p,{children:["\u652f\u6301 ",(0,i.jsx)(n.a,{href:"http://www.openssh.org/",children:"openSSH"})," \u517c\u5bb9\u5ba2\u6237\u7aef\u3001\n",(0,i.jsx)(n.a,{href:"http://www.chiark.greenend.org.uk/~sgtatham/putty/",children:"PuTTY"}),"\uff08Windows \u4e0a\uff09\n\u548c ",(0,i.jsx)(n.a,{href:"https://github.com/paramiko/paramiko/",children:"Paramiko"}),"\uff08SSH2 \u7684\u7eaf Python \u5b9e\u73b0\uff09\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'>>> from plumbum import SshMachine\n>>> remote = SshMachine("somehost", user = "john", keyfile = "/path/to/idrsa")\n>>> r_ls = remote["ls"]\n>>> with remote.cwd("/lib"):\n...     (r_ls | grep["0.so.0"])()\n...\n\'libusb-1.0.so.0\\nlibusb-1.0.so.0.0.0\\n\'\n'})}),"\n",(0,i.jsx)(n.h3,{id:"cli-\u5e94\u7528\u7a0b\u5e8f",children:"CLI \u5e94\u7528\u7a0b\u5e8f"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import logging\nfrom plumbum import cli\n\nclass MyCompiler(cli.Application):\n    verbose = cli.Flag(["-v", "--verbose"], help = "Enable verbose mode")\n    include_dirs = cli.SwitchAttr("-I", list = True, help = "Specify include directories")\n\n    @cli.switch("--loglevel", int)\n    def set_log_level(self, level):\n        """Sets the log-level of the logger"""\n        logging.root.setLevel(level)\n\n    def main(self, *srcfiles):\n        print("Verbose:", self.verbose)\n        print("Include dirs:", self.include_dirs)\n        print("Compiling:", srcfiles)\n\nif __name__ == "__main__":\n    MyCompiler.run()\n'})}),"\n",(0,i.jsx)(n.h4,{id:"\u793a\u4f8b\u8f93\u51fa",children:"\u793a\u4f8b\u8f93\u51fa"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ python3 simple_cli.py -v -I foo/bar -Ispam/eggs x.cpp y.cpp z.cpp\nVerbose: True\nInclude dirs: ['foo/bar', 'spam/eggs']\nCompiling: ('x.cpp', 'y.cpp', 'z.cpp')\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u989c\u8272\u548c\u6837\u5f0f",children:"\u989c\u8272\u548c\u6837\u5f0f"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'from plumbum import colors\nwith colors.red:\n    print("This library provides safe, flexible color access.")\n    print(colors.bold | "(and styles in general)", "are easy!")\nprint("The simple 16 colors or",\n      colors.orchid & colors.underline | \'256 named colors,\',\n      colors.rgb(18, 146, 64) | "or full rgb colors",\n      \'can be used.\')\nprint("Unsafe " + colors.bg.dark_khaki + "color access" + colors.bg.reset + " is available too.")\n'})})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);