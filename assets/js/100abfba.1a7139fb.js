"use strict";(self.webpackChunknotes_3=self.webpackChunknotes_3||[]).push([[69402],{54213:(n,e,s)=>{s.d(e,{R:()=>i,x:()=>c});var l=s(36672);const t={},r=l.createContext(t);function i(n){const e=l.useContext(r);return l.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:i(n.components),l.createElement(r.Provider,{value:e},n.children)}},99475:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>a});const l=JSON.parse('{"id":"AI/\u63d0\u793a\u8bcd\u5de5\u7a0b/DSPy/\u5b66\u4e60/\u7f16\u7a0b/\u5de5\u5177","title":"\u5de5\u5177","description":"DSPy \u4e3a \u4f7f\u7528\u5de5\u5177\u7684\u667a\u80fd\u4f53 (tool-using agents) \u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u652f\u6301\uff0c\u8fd9\u4e9b\u667a\u80fd\u4f53\u53ef\u4ee5\u4e0e\u5916\u90e8\u51fd\u6570\u3001API \u548c\u670d\u52a1\u8fdb\u884c\u4ea4\u4e92\u3002\u5de5\u5177\u4f7f\u8bed\u8a00\u6a21\u578b\u80fd\u591f\u901a\u8fc7\u6267\u884c\u64cd\u4f5c\u3001\u68c0\u7d22\u4fe1\u606f\u548c\u52a8\u6001\u5904\u7406\u6570\u636e\u6765\u8d85\u8d8a\u6587\u672c\u751f\u6210\u3002","source":"@site/docs/AI/\u63d0\u793a\u8bcd\u5de5\u7a0b/DSPy/\u5b66\u4e60/\u7f16\u7a0b/\u5de5\u5177.md","sourceDirName":"AI/\u63d0\u793a\u8bcd\u5de5\u7a0b/DSPy/\u5b66\u4e60/\u7f16\u7a0b","slug":"/AI/\u63d0\u793a\u8bcd\u5de5\u7a0b/DSPy/\u5b66\u4e60/\u7f16\u7a0b/\u5de5\u5177","permalink":"/notes3/docs/AI/\u63d0\u793a\u8bcd\u5de5\u7a0b/DSPy/\u5b66\u4e60/\u7f16\u7a0b/\u5de5\u5177","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/AI/\u63d0\u793a\u8bcd\u5de5\u7a0b/DSPy/\u5b66\u4e60/\u7f16\u7a0b/\u5de5\u5177.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"ai","previous":{"title":"\u6982\u89c8","permalink":"/notes3/docs/AI/\u63d0\u793a\u8bcd\u5de5\u7a0b/DSPy/\u5b66\u4e60/\u7f16\u7a0b/\u6982\u89c8"},"next":{"title":"\u6a21\u578b","permalink":"/notes3/docs/AI/\u63d0\u793a\u8bcd\u5de5\u7a0b/DSPy/\u5b66\u4e60/\u7f16\u7a0b/\u6a21\u578b"}}');var t=s(23420),r=s(54213);const i={sidebar_position:2},c=void 0,o={},a=[{value:"\u65b9\u6cd5 1: \u4f7f\u7528 <code>dspy.ReAct</code> (\u5168\u6258\u7ba1)",id:"\u65b9\u6cd5-1-\u4f7f\u7528-dspyreact-\u5168\u6258\u7ba1",level:2},{value:"\u57fa\u672c\u793a\u4f8b",id:"\u57fa\u672c\u793a\u4f8b",level:3},{value:"ReAct \u7279\u6027",id:"react-\u7279\u6027",level:3},{value:"ReAct \u53c2\u6570",id:"react-\u53c2\u6570",level:3},{value:"\u65b9\u6cd5 2: \u624b\u52a8\u5de5\u5177\u5904\u7406",id:"\u65b9\u6cd5-2-\u624b\u52a8\u5de5\u5177\u5904\u7406",level:2},{value:"\u57fa\u672c\u8bbe\u7f6e",id:"\u57fa\u672c\u8bbe\u7f6e",level:3},{value:"\u7406\u89e3 <code>dspy.Tool</code>",id:"\u7406\u89e3-dspytool",level:3},{value:"\u7406\u89e3 <code>dspy.ToolCalls</code>",id:"\u7406\u89e3-dspytoolcalls",level:3},{value:"\u4f7f\u7528\u539f\u751f\u5de5\u5177\u8c03\u7528",id:"\u4f7f\u7528\u539f\u751f\u5de5\u5177\u8c03\u7528",level:2},{value:"\u9002\u914d\u5668\u884c\u4e3a",id:"\u9002\u914d\u5668\u884c\u4e3a",level:3},{value:"\u914d\u7f6e",id:"\u914d\u7f6e",level:3},{value:"\u6a21\u578b\u517c\u5bb9\u6027",id:"\u6a21\u578b\u517c\u5bb9\u6027",level:3},{value:"\u5f02\u6b65\u5de5\u5177",id:"\u5f02\u6b65\u5de5\u5177",level:2},{value:"\u5bf9\u5f02\u6b65\u5de5\u5177\u4f7f\u7528 <code>acall</code>",id:"\u5bf9\u5f02\u6b65\u5de5\u5177\u4f7f\u7528-acall",level:3},{value:"\u5728\u540c\u6b65\u6a21\u5f0f\u4e0b\u8fd0\u884c\u5f02\u6b65\u5de5\u5177",id:"\u5728\u540c\u6b65\u6a21\u5f0f\u4e0b\u8fd0\u884c\u5f02\u6b65\u5de5\u5177",level:3},{value:"\u6700\u4f73\u5b9e\u8df5",id:"\u6700\u4f73\u5b9e\u8df5",level:2},{value:"1. \u5de5\u5177\u51fd\u6570\u8bbe\u8ba1",id:"1-\u5de5\u5177\u51fd\u6570\u8bbe\u8ba1",level:3},{value:"2. \u5728 ReAct \u548c\u624b\u52a8\u5904\u7406\u4e4b\u95f4\u9009\u62e9",id:"2-\u5728-react-\u548c\u624b\u52a8\u5904\u7406\u4e4b\u95f4\u9009\u62e9",level:3}];function d(n){const e={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(e.p,{children:["DSPy \u4e3a ",(0,t.jsx)(e.strong,{children:"\u4f7f\u7528\u5de5\u5177\u7684\u667a\u80fd\u4f53 (tool-using agents)"})," \u63d0\u4f9b\u4e86\u5f3a\u5927\u7684\u652f\u6301\uff0c\u8fd9\u4e9b\u667a\u80fd\u4f53\u53ef\u4ee5\u4e0e\u5916\u90e8\u51fd\u6570\u3001API \u548c\u670d\u52a1\u8fdb\u884c\u4ea4\u4e92\u3002\u5de5\u5177\u4f7f\u8bed\u8a00\u6a21\u578b\u80fd\u591f\u901a\u8fc7\u6267\u884c\u64cd\u4f5c\u3001\u68c0\u7d22\u4fe1\u606f\u548c\u52a8\u6001\u5904\u7406\u6570\u636e\u6765\u8d85\u8d8a\u6587\u672c\u751f\u6210\u3002"]}),"\n",(0,t.jsx)(e.p,{children:"\u5728 DSPy \u4e2d\u4f7f\u7528\u5de5\u5177\u6709\u4e24\u79cd\u4e3b\u8981\u65b9\u6cd5\uff1a"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:(0,t.jsx)(e.code,{children:"dspy.ReAct"})})," - \u5168\u6258\u7ba1\u7684\u5de5\u5177\u667a\u80fd\u4f53\uff0c\u81ea\u52a8\u5904\u7406\u63a8\u7406\u548c\u5de5\u5177\u8c03\u7528"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u624b\u52a8\u5de5\u5177\u5904\u7406"})," - \u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"dspy.Tool"}),"\u3001",(0,t.jsx)(e.code,{children:"dspy.ToolCalls"})," \u548c\u81ea\u5b9a\u4e49\u7b7e\u540d\u76f4\u63a5\u63a7\u5236\u5de5\u5177\u8c03\u7528"]}),"\n"]}),"\n",(0,t.jsxs)(e.h2,{id:"\u65b9\u6cd5-1-\u4f7f\u7528-dspyreact-\u5168\u6258\u7ba1",children:["\u65b9\u6cd5 1: \u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"dspy.ReAct"})," (\u5168\u6258\u7ba1)"]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"dspy.ReAct"})," \u6a21\u5757\u5b9e\u73b0\u4e86\u63a8\u7406\u548c\u884c\u52a8 (Reasoning and Acting, ReAct) \u6a21\u5f0f\uff0c\u5176\u4e2d\u8bed\u8a00\u6a21\u578b\u8fed\u4ee3\u5730\u63a8\u7406\u5f53\u524d\u60c5\u51b5\u5e76\u51b3\u5b9a\u8c03\u7528\u54ea\u4e9b\u5de5\u5177\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"\u57fa\u672c\u793a\u4f8b",children:"\u57fa\u672c\u793a\u4f8b"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'import dspy\n\n# \u5c06\u4f60\u7684\u5de5\u5177\u5b9a\u4e49\u4e3a\u51fd\u6570\ndef get_weather(city: str) -> str:\n    """Get the current weather for a city."""\n    # \u5728\u5b9e\u9645\u5b9e\u73b0\u4e2d\uff0c\u8fd9\u5c06\u8c03\u7528\u5929\u6c14 API\n    return f"The weather in {city} is sunny and 75\xb0F"\n\ndef search_web(query: str) -> str:\n    """Search the web for information."""\n    # \u5728\u5b9e\u9645\u5b9e\u73b0\u4e2d\uff0c\u8fd9\u5c06\u8c03\u7528\u641c\u7d22 API\n    return f"Search results for \'{query}\': [relevant information...]"\n\n# \u521b\u5efa ReAct \u667a\u80fd\u4f53\nreact_agent = dspy.ReAct(\n    signature="question -> answer",\n    tools=[get_weather, search_web],\n    max_iters=5\n)\n\n# \u4f7f\u7528\u667a\u80fd\u4f53\nresult = react_agent(question="What\'s the weather like in Tokyo?")\nprint(result.answer)\nprint("Tool calls made:", result.trajectory)\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u6211\u770b\u5230\u4e0a\u9762\u7684\u4ee3\u7801\u65f6\u7684\u7b2c\u4e00\u53cd\u5e94\u662f",(0,t.jsx)(e.a,{href:"/notes3/docs/AI/%E6%8F%90%E7%A4%BA%E8%AF%8D%E5%B7%A5%E7%A8%8B/DSPy/%E5%8F%82%E8%80%83/1",children:"\u6709\u70b9\u7591\u60d1"})]}),"\n",(0,t.jsx)(e.h3,{id:"react-\u7279\u6027",children:"ReAct \u7279\u6027"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u81ea\u52a8\u63a8\u7406"}),"\uff1a\u6a21\u578b\u9010\u6b65\u601d\u8003\u95ee\u9898"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u5de5\u5177\u9009\u62e9"}),"\uff1a\u6839\u636e\u60c5\u51b5\u81ea\u52a8\u9009\u62e9\u8981\u4f7f\u7528\u7684\u5de5\u5177"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u8fed\u4ee3\u6267\u884c"}),"\uff1a\u53ef\u4ee5\u8fdb\u884c\u591a\u6b21\u5de5\u5177\u8c03\u7528\u4ee5\u6536\u96c6\u4fe1\u606f"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u9519\u8bef\u5904\u7406"}),"\uff1a\u9488\u5bf9\u5931\u8d25\u7684\u5de5\u5177\u8c03\u7528\u5185\u7f6e\u9519\u8bef\u6062\u590d"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u8f68\u8ff9\u8ddf\u8e2a"}),"\uff1a\u63a8\u7406\u548c\u5de5\u5177\u8c03\u7528\u7684\u5b8c\u6574\u5386\u53f2\u8bb0\u5f55"]}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"react-\u53c2\u6570",children:"ReAct \u53c2\u6570"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'react_agent = dspy.ReAct(\n    signature="question -> answer",  # \u8f93\u5165/\u8f93\u51fa\u89c4\u8303\n    tools=[tool1, tool2, tool3],     # \u53ef\u7528\u5de5\u5177\u5217\u8868\n    max_iters=10                     # \u6700\u5927\u5de5\u5177\u8c03\u7528\u8fed\u4ee3\u6b21\u6570\n)\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u65b9\u6cd5-2-\u624b\u52a8\u5de5\u5177\u5904\u7406",children:"\u65b9\u6cd5 2: \u624b\u52a8\u5de5\u5177\u5904\u7406"}),"\n",(0,t.jsx)(e.p,{children:"\u4e3a\u4e86\u66f4\u597d\u5730\u63a7\u5236\u5de5\u5177\u8c03\u7528\u8fc7\u7a0b\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 DSPy \u7684\u5de5\u5177\u7c7b\u578b\u624b\u52a8\u5904\u7406\u5de5\u5177\u3002"}),"\n",(0,t.jsxs)(e.p,{children:['!!! note "\u7248\u672c\u8981\u6c42"\n\u4ee5\u4e0b\u793a\u4f8b\u4e2d\u4f7f\u7528\u7684 ',(0,t.jsx)(e.code,{children:"ToolCall.execute()"})," \u65b9\u6cd5\u4ece ",(0,t.jsx)(e.strong,{children:"dspy 3.0.4b2"})," \u8d77\u53ef\u7528\u3002\u5982\u679c\u4f60\u4f7f\u7528\u7684\u662f 3.0.3 \u6216\u66f4\u65e9\u7248\u672c\uff0c\u5219\u9700\u8981\u5347\u7ea7\u624d\u80fd\u4f7f\u7528\u6b64\u529f\u80fd\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"\u57fa\u672c\u8bbe\u7f6e",children:"\u57fa\u672c\u8bbe\u7f6e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'import dspy\n\nclass ToolSignature(dspy.Signature):\n    """Signature for manual tool handling."""\n    question: str = dspy.InputField()\n    tools: list[dspy.Tool] = dspy.InputField()\n    outputs: dspy.ToolCalls = dspy.OutputField()\n\ndef weather(city: str) -> str:\n    """Get weather information for a city."""\n    return f"The weather in {city} is sunny"\n\ndef calculator(expression: str) -> str:\n    """Evaluate a mathematical expression."""\n    try:\n        result = eval(expression)  # \u6ce8\u610f\uff1a\u5728\u751f\u4ea7\u4e2d\u5b89\u5168\u4f7f\u7528\n        return f"The result is {result}"\n    except:\n        return "Invalid expression"\n\n# \u521b\u5efa\u5de5\u5177\u5b9e\u4f8b\ntools = {\n    "weather": dspy.Tool(weather),\n    "calculator": dspy.Tool(calculator)\n}\n\n# \u521b\u5efa\u9884\u6d4b\u5668\npredictor = dspy.Predict(ToolSignature)\n\n# \u8fdb\u884c\u9884\u6d4b\nresponse = predictor(\n    question="What\'s the weather in New York?",\n    tools=list(tools.values())\n)\n\n# \u6267\u884c\u5de5\u5177\u8c03\u7528\nfor call in response.outputs.tool_calls:\n    # \u6267\u884c\u5de5\u5177\u8c03\u7528\n    result = call.execute()\n    # \u5bf9\u4e8e 3.0.4b2 \u4e4b\u524d\u7684\u7248\u672c\uff0c\u4f7f\u7528: result = tools[call.name](**call.args)\n    print(f"Tool: {call.name}")\n    print(f"Args: {call.args}")\n    print(f"Result: {result}")\n'})}),"\n",(0,t.jsxs)(e.h3,{id:"\u7406\u89e3-dspytool",children:["\u7406\u89e3 ",(0,t.jsx)(e.code,{children:"dspy.Tool"})]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"dspy.Tool"})," \u7c7b\u5305\u88c5\u5e38\u89c4 Python \u51fd\u6570\uff0c\u4f7f\u5176\u4e0e DSPy \u7684\u5de5\u5177\u7cfb\u7edf\u517c\u5bb9\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'def my_function(param1: str, param2: int = 5) -> str:\n    """A sample function with parameters."""\n    return f"Processed {param1} with value {param2}"\n\n# \u521b\u5efa\u5de5\u5177\ntool = dspy.Tool(my_function)\n\n# \u5de5\u5177\u5c5e\u6027\nprint(tool.name)        # "my_function"\nprint(tool.desc)        # \u51fd\u6570\u7684\u6587\u6863\u5b57\u7b26\u4e32\nprint(tool.args)        # \u53c2\u6570\u6a21\u5f0f\nprint(str(tool))        # \u5b8c\u6574\u5de5\u5177\u63cf\u8ff0\n'})}),"\n",(0,t.jsxs)(e.h3,{id:"\u7406\u89e3-dspytoolcalls",children:["\u7406\u89e3 ",(0,t.jsx)(e.code,{children:"dspy.ToolCalls"})]}),"\n",(0,t.jsxs)(e.p,{children:['!!! note "\u7248\u672c\u8981\u6c42"\n',(0,t.jsx)(e.code,{children:"ToolCall.execute()"})," \u65b9\u6cd5\u4ece ",(0,t.jsx)(e.strong,{children:"dspy 3.0.4b2"})," \u8d77\u53ef\u7528\u3002\u5982\u679c\u4f60\u4f7f\u7528\u7684\u662f\u65e9\u671f\u7248\u672c\uff0c\u5219\u9700\u8981\u5347\u7ea7\u624d\u80fd\u4f7f\u7528\u6b64\u529f\u80fd\u3002"]}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.code,{children:"dspy.ToolCalls"})," \u7c7b\u578b\u8868\u793a\u53ef\u4ee5\u8fdb\u884c\u5de5\u5177\u8c03\u7528\u7684\u6a21\u578b\u7684\u8f93\u51fa\u3002\u6bcf\u4e2a\u5355\u72ec\u7684\u5de5\u5177\u8c03\u7528\u90fd\u53ef\u4ee5\u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"execute"})," \u65b9\u6cd5\u6267\u884c\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'# \u83b7\u53d6\u5e26\u6709\u5de5\u5177\u8c03\u7528\u7684\u54cd\u5e94\u540e\nfor call in response.outputs.tool_calls:\n    print(f"Tool name: {call.name}")\n    print(f"Arguments: {call.args}")\n    \n    # \u4f7f\u7528\u4e0d\u540c\u9009\u9879\u6267\u884c\u5355\u72ec\u7684\u5de5\u5177\u8c03\u7528\uff1a\n    \n    # \u9009\u9879 1: \u81ea\u52a8\u53d1\u73b0 (\u5728 locals/globals \u4e2d\u67e5\u627e\u51fd\u6570)\n    result = call.execute()  # \u6309\u540d\u79f0\u81ea\u52a8\u67e5\u627e\u51fd\u6570\n\n    # \u9009\u9879 2: \u4f5c\u4e3a\u5b57\u5178\u4f20\u9012\u5de5\u5177 (\u6700\u660e\u786e)\n    result = call.execute(functions={"weather": weather, "calculator": calculator})\n    \n    # \u9009\u9879 3: \u4f20\u9012 Tool \u5bf9\u8c61\u5217\u8868\n    result = call.execute(functions=[dspy.Tool(weather), dspy.Tool(calculator)])\n    \n    # \u9009\u9879 4: \u5bf9\u4e8e 3.0.4b2 \u4e4b\u524d\u7684\u7248\u672c (\u624b\u52a8\u5de5\u5177\u67e5\u627e)\n    # tools_dict = {"weather": weather, "calculator": calculator}\n    # result = tools_dict[call.name](**call.args)\n    \n    print(f"Result: {result}")\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u4f7f\u7528\u539f\u751f\u5de5\u5177\u8c03\u7528",children:"\u4f7f\u7528\u539f\u751f\u5de5\u5177\u8c03\u7528"}),"\n",(0,t.jsxs)(e.p,{children:["DSPy \u9002\u914d\u5668\u652f\u6301 ",(0,t.jsx)(e.strong,{children:"\u539f\u751f\u51fd\u6570\u8c03\u7528 (native function calling)"}),"\uff0c\u5b83\u5229\u7528\u5e95\u5c42\u8bed\u8a00\u6a21\u578b\u5185\u7f6e\u7684\u5de5\u5177\u8c03\u7528\u529f\u80fd\uff0c\u800c\u4e0d\u662f\u4f9d\u8d56\u57fa\u4e8e\u6587\u672c\u7684\u89e3\u6790\u3002\u8fd9\u79cd\u65b9\u6cd5\u53ef\u4ee5\u63d0\u4f9b\u66f4\u53ef\u9760\u7684\u5de5\u5177\u6267\u884c\uff0c\u5e76\u66f4\u597d\u5730\u4e0e\u652f\u6301\u539f\u751f\u51fd\u6570\u8c03\u7528\u7684\u6a21\u578b\u96c6\u6210\u3002"]}),"\n",(0,t.jsx)(e.p,{children:'!!! warning "\u539f\u751f\u5de5\u5177\u8c03\u7528\u4e0d\u4fdd\u8bc1\u66f4\u597d\u7684\u8d28\u91cf"'}),"\n",(0,t.jsx)(e.p,{children:"\u539f\u751f\u5de5\u5177\u8c03\u7528\u4ea7\u751f\u7684\u8d28\u91cf\u53ef\u80fd\u4f1a\u4f4e\u4e8e\u81ea\u5b9a\u4e49\u5de5\u5177\u8c03\u7528\u3002"}),"\n",(0,t.jsx)(e.h3,{id:"\u9002\u914d\u5668\u884c\u4e3a",children:"\u9002\u914d\u5668\u884c\u4e3a"}),"\n",(0,t.jsx)(e.p,{children:"\u4e0d\u540c\u7684 DSPy \u9002\u914d\u5668\u5bf9\u539f\u751f\u51fd\u6570\u8c03\u7528\u6709\u4e0d\u540c\u7684\u9ed8\u8ba4\u503c\uff1a"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:(0,t.jsx)(e.code,{children:"ChatAdapter"})})," - \u9ed8\u8ba4\u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"use_native_function_calling=False"}),"\uff08\u4f9d\u8d56\u6587\u672c\u89e3\u6790\uff09"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:(0,t.jsx)(e.code,{children:"JSONAdapter"})})," - \u9ed8\u8ba4\u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"use_native_function_calling=True"}),"\uff08\u4f7f\u7528\u539f\u751f\u51fd\u6570\u8c03\u7528\uff09"]}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["\u4f60\u53ef\u4ee5\u901a\u8fc7\u5728\u521b\u5efa\u9002\u914d\u5668\u65f6\u663e\u5f0f\u8bbe\u7f6e ",(0,t.jsx)(e.code,{children:"use_native_function_calling"})," \u53c2\u6570\u6765\u8986\u76d6\u8fd9\u4e9b\u9ed8\u8ba4\u503c\u3002"]}),"\n",(0,t.jsx)(e.h3,{id:"\u914d\u7f6e",children:"\u914d\u7f6e"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'import dspy\n\n# \u542f\u7528\u4e86\u539f\u751f\u51fd\u6570\u8c03\u7528\u7684 ChatAdapter\nchat_adapter_native = dspy.ChatAdapter(use_native_function_calling=True)\n\n# \u7981\u7528\u4e86\u539f\u751f\u51fd\u6570\u8c03\u7528\u7684 JSONAdapter\njson_adapter_manual = dspy.JSONAdapter(use_native_function_calling=False)\n\n# \u914d\u7f6e DSPy \u4f7f\u7528\u9002\u914d\u5668\ndspy.configure(lm=dspy.LM(model="openai/gpt-4o"), adapter=chat_adapter_native)\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u4f60\u53ef\u4ee5\u542f\u7528 ",(0,t.jsx)(e.a,{href:"https://dspy.ai/tutorials/observability/",children:"MLflow \u8ddf\u8e2a"})," \u6765\u68c0\u67e5\u539f\u751f\u5de5\u5177\u8c03\u7528\u7684\u4f7f\u7528\u60c5\u51b5\u3002\u5982\u679c\u4f60\u4f7f\u7528\u542f\u7528\u4e86\u539f\u751f\u51fd\u6570\u8c03\u7528\u7684 ",(0,t.jsx)(e.code,{children:"JSONAdapter"})," \u6216 ",(0,t.jsx)(e.code,{children:"ChatAdapter"})," \u8fd0\u884c\u4e0a\u4e00\u8282\u4e2d\u63d0\u4f9b\u7684\u4ee3\u7801\u7247\u6bb5\uff0c\u4f60\u5e94\u8be5\u4f1a\u770b\u5230\u539f\u751f\u51fd\u6570\u8c03\u7528\u53c2\u6570 ",(0,t.jsx)(e.code,{children:"tools"})," \u8bbe\u7f6e\u5982\u4e0b\u56fe\u6240\u793a\uff1a"]}),"\n",(0,t.jsx)(e.p,{children:"![native tool calling]"}),"\n",(0,t.jsx)(e.h3,{id:"\u6a21\u578b\u517c\u5bb9\u6027",children:"\u6a21\u578b\u517c\u5bb9\u6027"}),"\n",(0,t.jsxs)(e.p,{children:["\u539f\u751f\u51fd\u6570\u8c03\u7528\u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"litellm.supports_function_calling()"})," \u81ea\u52a8\u68c0\u6d4b\u6a21\u578b\u652f\u6301\u3002\u5982\u679c\u6a21\u578b\u4e0d\u652f\u6301\u539f\u751f\u51fd\u6570\u8c03\u7528\uff0c\u5373\u4f7f\u8bbe\u7f6e\u4e86 ",(0,t.jsx)(e.code,{children:"use_native_function_calling=True"}),"\uff0cDSPy \u4e5f\u4f1a\u56de\u9000\u5230\u57fa\u4e8e\u6587\u672c\u7684\u624b\u52a8\u89e3\u6790\u3002"]}),"\n",(0,t.jsx)(e.h2,{id:"\u5f02\u6b65\u5de5\u5177",children:"\u5f02\u6b65\u5de5\u5177"}),"\n",(0,t.jsx)(e.p,{children:"DSPy \u5de5\u5177\u652f\u6301\u540c\u6b65\u548c\u5f02\u6b65\u51fd\u6570\u3002\u5728\u4f7f\u7528\u5f02\u6b65\u5de5\u5177\u65f6\uff0c\u4f60\u6709\u4e24\u4e2a\u9009\u62e9\uff1a"}),"\n",(0,t.jsxs)(e.h3,{id:"\u5bf9\u5f02\u6b65\u5de5\u5177\u4f7f\u7528-acall",children:["\u5bf9\u5f02\u6b65\u5de5\u5177\u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"acall"})]}),"\n",(0,t.jsxs)(e.p,{children:["\u5728\u4f7f\u7528\u5f02\u6b65\u5de5\u5177\u65f6\uff0c\u63a8\u8350\u7684\u65b9\u6cd5\u662f\u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"acall"}),"\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'import asyncio\nimport dspy\n\nasync def async_weather(city: str) -> str:\n    """Get weather information asynchronously."""\n    await asyncio.sleep(0.1)  # Simulate async API call\n    return f"The weather in {city} is sunny"\n\ntool = dspy.Tool(async_weather)\n\n# \u5bf9\u5f02\u6b65\u5de5\u5177\u4f7f\u7528 acall\nresult = await tool.acall(city="New York")\nprint(result)\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u5728\u540c\u6b65\u6a21\u5f0f\u4e0b\u8fd0\u884c\u5f02\u6b65\u5de5\u5177",children:"\u5728\u540c\u6b65\u6a21\u5f0f\u4e0b\u8fd0\u884c\u5f02\u6b65\u5de5\u5177"}),"\n",(0,t.jsxs)(e.p,{children:["\u5982\u679c\u4f60\u9700\u8981\u4ece\u540c\u6b65\u4ee3\u7801\u8c03\u7528\u5f02\u6b65\u5de5\u5177\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"allow_tool_async_sync_conversion"})," \u8bbe\u7f6e\u542f\u7528\u81ea\u52a8\u8f6c\u6362\uff1a"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'import asyncio\nimport dspy\n\nasync def async_weather(city: str) -> str:\n    """Get weather information asynchronously."""\n    await asyncio.sleep(0.1)\n    return f"The weather in {city} is sunny"\n\ntool = dspy.Tool(async_weather)\n\n# \u542f\u7528\u5f02\u6b65\u5230\u540c\u6b65\u8f6c\u6362\nwith dspy.context(allow_tool_async_sync_conversion=True):\n    # \u73b0\u5728\u4f60\u53ef\u4ee5\u5728\u5f02\u6b65\u5de5\u5177\u4e0a\u4f7f\u7528 __call__\n    result = tool(city="New York")\n    print(result)\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u6700\u4f73\u5b9e\u8df5",children:"\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,t.jsx)(e.h3,{id:"1-\u5de5\u5177\u51fd\u6570\u8bbe\u8ba1",children:"1. \u5de5\u5177\u51fd\u6570\u8bbe\u8ba1"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u6e05\u6670\u7684\u6587\u6863\u5b57\u7b26\u4e32"}),"\uff1a\u5e26\u6709\u63cf\u8ff0\u6027\u6587\u6863\u7684\u5de5\u5177\u6548\u679c\u66f4\u597d"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u7c7b\u578b\u63d0\u793a"}),"\uff1a\u63d0\u4f9b\u6e05\u6670\u7684\u53c2\u6570\u548c\u8fd4\u56de\u7c7b\u578b"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"\u7b80\u5355\u53c2\u6570"}),"\uff1a\u4f7f\u7528\u57fa\u672c\u7c7b\u578b (str, int, bool, dict, list) \u6216 Pydantic \u6a21\u578b"]}),"\n"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'def good_tool(city: str, units: str = "celsius") -> str:\n    """\n    Get weather information for a specific city.\n    \n    Args:\n        city: The name of the city to get weather for\n        units: Temperature units, either \'celsius\' or \'fahrenheit\'\n    \n    Returns:\n        A string describing the current weather conditions\n    """\n    # \u5e26\u6709\u9002\u5f53\u9519\u8bef\u5904\u7406\u7684\u5b9e\u73b0\n    if not city.strip():\n        return "Error: City name cannot be empty"\n    \n    # Weather logic here...\n    return f"Weather in {city}: 25\xb0{units[0].upper()}, sunny"\n'})}),"\n",(0,t.jsx)(e.h3,{id:"2-\u5728-react-\u548c\u624b\u52a8\u5904\u7406\u4e4b\u95f4\u9009\u62e9",children:"2. \u5728 ReAct \u548c\u624b\u52a8\u5904\u7406\u4e4b\u95f4\u9009\u62e9"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsxs)(e.strong,{children:["\u5728\u4ee5\u4e0b\u60c5\u51b5\u4e0b\u4f7f\u7528 ",(0,t.jsx)(e.code,{children:"dspy.ReAct"}),"\uff1a"]})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u4f60\u60f3\u8981\u81ea\u52a8\u63a8\u7406\u548c\u5de5\u5177\u9009\u62e9"}),"\n",(0,t.jsx)(e.li,{children:"\u4efb\u52a1\u9700\u8981\u591a\u6b21\u5de5\u5177\u8c03\u7528"}),"\n",(0,t.jsx)(e.li,{children:"\u4f60\u9700\u8981\u5185\u7f6e\u7684\u9519\u8bef\u6062\u590d"}),"\n",(0,t.jsx)(e.li,{children:"\u4f60\u60f3\u4e13\u6ce8\u4e8e\u5de5\u5177\u5b9e\u73b0\u800c\u4e0d\u662f\u7f16\u6392"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u5728\u4ee5\u4e0b\u60c5\u51b5\u4e0b\u4f7f\u7528\u624b\u52a8\u5de5\u5177\u5904\u7406\uff1a"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u4f60\u9700\u8981\u5bf9\u5de5\u5177\u6267\u884c\u8fdb\u884c\u7cbe\u786e\u63a7\u5236"}),"\n",(0,t.jsx)(e.li,{children:"\u4f60\u60f3\u8981\u81ea\u5b9a\u4e49\u9519\u8bef\u5904\u7406\u903b\u8f91"}),"\n",(0,t.jsx)(e.li,{children:"\u4f60\u60f3\u6700\u5c0f\u5316\u5ef6\u8fdf"}),"\n",(0,t.jsx)(e.li,{children:"\u4f60\u7684\u5de5\u5177\u4e0d\u8fd4\u56de\u4efb\u4f55\u5185\u5bb9\uff08void \u51fd\u6570\uff09"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:"DSPy \u4e2d\u7684\u5de5\u5177\u63d0\u4f9b\u4e86\u4e00\u79cd\u5f3a\u5927\u7684\u65b9\u5f0f\uff0c\u5c06\u8bed\u8a00\u6a21\u578b\u7684\u529f\u80fd\u6269\u5c55\u5230\u6587\u672c\u751f\u6210\u4e4b\u5916\u3002\u65e0\u8bba\u662f\u4f7f\u7528\u5168\u81ea\u52a8\u7684 ReAct \u65b9\u6cd5\u8fd8\u662f\u624b\u52a8\u5de5\u5177\u5904\u7406\uff0c\u4f60\u90fd\u53ef\u4ee5\u6784\u5efa\u901a\u8fc7\u4ee3\u7801\u4e0e\u4e16\u754c\u4ea4\u4e92\u7684\u590d\u6742\u667a\u80fd\u4f53\u3002"})]})}function h(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}}}]);