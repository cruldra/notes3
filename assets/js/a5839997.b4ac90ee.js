"use strict";(self.webpackChunknotes_3=self.webpackChunknotes_3||[]).push([[16432],{28796:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>h,contentTitle:()=>i,default:()=>a,frontMatter:()=>c,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"AI/Pytorch/\u4ecb\u7ecd","title":"\u4ecb\u7ecd","description":"PyTorch \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u673a\u5668\u5b66\u4e60\u5e93\uff0c\u6700\u521d\u7531 Facebook \u7684\u4eba\u5de5\u667a\u80fd\u7814\u7a76\u5b9e\u9a8c\u5ba4\uff08FAIR\uff09\u5f00\u53d1\u3002\u5b83\u57fa\u4e8e Torch \u5e93\uff0c\u5e95\u5c42\u7531 C++ \u5b9e\u73b0\uff0c\u80fd\u591f\u63d0\u4f9b\u5f3a\u5927\u7684 GPU \u52a0\u901f\u5f20\u91cf\u8ba1\u7b97\uff08Tensor computing\uff09\u548c\u6784\u5efa\u5728\u78c1\u5e26\u57fa\u7840\u4e0a\u7684\u81ea\u52a8\u5fae\u5206\u7cfb\u7edf\uff08Tape-based autograd system\uff09\u3002","source":"@site/docs/AI/Pytorch/\u4ecb\u7ecd.md","sourceDirName":"AI/Pytorch","slug":"/AI/Pytorch/\u4ecb\u7ecd","permalink":"/notes3/docs/AI/Pytorch/\u4ecb\u7ecd","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/AI/Pytorch/\u4ecb\u7ecd.md","tags":[],"version":"current","frontMatter":{},"sidebar":"ai","previous":{"title":"CrossEntropyLoss","permalink":"/notes3/docs/AI/Pytorch/CrossEntropyLoss"},"next":{"title":"torch_distributed","permalink":"/notes3/docs/AI/Pytorch/\u5206\u5e03\u5f0f\u8bad\u7ec3/torch_distributed"}}');var s=r(23420),t=r(54213);const c={},i=void 0,h={},d=[{value:"\u4e3b\u8981\u7279\u70b9",id:"\u4e3b\u8981\u7279\u70b9",level:3},{value:"2. \u6838\u5fc3\u6a21\u5757\u8be6\u89e3",id:"2-\u6838\u5fc3\u6a21\u5757\u8be6\u89e3",level:2},{value:"2.1 torch.Tensor (\u5f20\u91cf)",id:"21-torchtensor-\u5f20\u91cf",level:3},{value:"2.2 torch.autograd (\u81ea\u52a8\u5fae\u5206)",id:"22-torchautograd-\u81ea\u52a8\u5fae\u5206",level:3},{value:"2.3 torch.nn (\u795e\u7ecf\u7f51\u7edc\u6784\u5efa)",id:"23-torchnn-\u795e\u7ecf\u7f51\u7edc\u6784\u5efa",level:3},{value:"2.4 torch.optim (\u4f18\u5316\u5668)",id:"24-torchoptim-\u4f18\u5316\u5668",level:3},{value:"2.5 torch.utils.data (\u6570\u636e\u5904\u7406)",id:"25-torchutilsdata-\u6570\u636e\u5904\u7406",level:3},{value:"3. PyTorch \u5185\u90e8\u67b6\u6784\u4e0e\u6a21\u5757\u4ea4\u4e92",id:"3-pytorch-\u5185\u90e8\u67b6\u6784\u4e0e\u6a21\u5757\u4ea4\u4e92",level:2},{value:"\u67b6\u6784\u5206\u5c42",id:"\u67b6\u6784\u5206\u5c42",level:3},{value:"\u6a21\u5757\u4f5c\u7528\u56fe\u89e3 (Mermaid)",id:"\u6a21\u5757\u4f5c\u7528\u56fe\u89e3-mermaid",level:3},{value:"\u56fe\u89e3\u8bf4\u660e",id:"\u56fe\u89e3\u8bf4\u660e",level:3}];function l(n){const e={a:"a",code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,t.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e.p,{children:["PyTorch \u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u673a\u5668\u5b66\u4e60\u5e93\uff0c\u6700\u521d\u7531 Facebook \u7684\u4eba\u5de5\u667a\u80fd\u7814\u7a76\u5b9e\u9a8c\u5ba4\uff08FAIR\uff09\u5f00\u53d1\u3002\u5b83\u57fa\u4e8e Torch \u5e93\uff0c\u5e95\u5c42\u7531 C++ \u5b9e\u73b0\uff0c\u80fd\u591f\u63d0\u4f9b\u5f3a\u5927\u7684 ",(0,s.jsx)(e.a,{href:"/notes3/docs/AI/Pytorch/%E5%8F%82%E8%80%83/1",children:"GPU \u52a0\u901f\u5f20\u91cf\u8ba1\u7b97\uff08Tensor computing\uff09"}),"\u548c\u6784\u5efa\u5728\u78c1\u5e26\u57fa\u7840\u4e0a\u7684\u81ea\u52a8\u5fae\u5206\u7cfb\u7edf\uff08Tape-based autograd system\uff09\u3002"]}),"\n",(0,s.jsxs)(e.p,{children:["PyTorch \u56e0\u5176",(0,s.jsx)(e.strong,{children:"\u52a8\u6001\u8ba1\u7b97\u56fe"}),"\uff08Dynamic Computational Graph\uff09\u7279\u6027\u800c\u5907\u53d7\u7814\u7a76\u4eba\u5458\u559c\u7231\uff0c\u8fd9\u610f\u5473\u7740\u8ba1\u7b97\u56fe\u662f\u5728\u4ee3\u7801\u8fd0\u884c\u65f6\u6784\u5efa\u7684\uff0c\u5141\u8bb8\u4f7f\u7528\u6807\u51c6\u7684 Python \u63a7\u5236\u6d41\uff08\u5982 ",(0,s.jsx)(e.code,{children:"if"}),", ",(0,s.jsx)(e.code,{children:"for"})," \u5faa\u73af\uff09\u6765\u6539\u53d8\u795e\u7ecf\u7f51\u7edc\u7684\u7ed3\u6784\u3002"]}),"\n",(0,s.jsx)(e.h3,{id:"\u4e3b\u8981\u7279\u70b9",children:"\u4e3b\u8981\u7279\u70b9"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Python \u4f18\u5148"}),"\uff1a\u6df1\u5ea6\u96c6\u6210 Python \u751f\u6001\uff0c\u6613\u4e8e\u4f7f\u7528\u548c\u8c03\u8bd5\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u52a8\u6001\u56fe\u673a\u5236"}),"\uff1a\u7075\u6d3b\u7684 Eager Execution \u6a21\u5f0f\uff0c\u6240\u89c1\u5373\u6240\u5f97\uff0c\u6781\u5927\u5229\u4e8e\u5b9e\u9a8c\u548c\u539f\u578b\u8bbe\u8ba1\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u4e30\u5bcc\u7684\u751f\u6001"}),"\uff1a\u62e5\u6709 TorchVision, TorchText, TorchAudio \u7b49\u5f3a\u5927\u7684\u9886\u57df\u5e93\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u751f\u4ea7\u90e8\u7f72"}),"\uff1a\u901a\u8fc7 TorchScript \u548c TorchServe \u652f\u6301\u4ece\u7814\u7a76\u5230\u751f\u4ea7\u7684\u65e0\u7f1d\u8fc7\u6e21\u3002"]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"2-\u6838\u5fc3\u6a21\u5757\u8be6\u89e3",children:"2. \u6838\u5fc3\u6a21\u5757\u8be6\u89e3"}),"\n",(0,s.jsx)(e.p,{children:"PyTorch \u7684\u5f3a\u5927\u529f\u80fd\u7531\u4ee5\u4e0b\u51e0\u4e2a\u6838\u5fc3\u6a21\u5757\u652f\u6491\uff1a"}),"\n",(0,s.jsx)(e.h3,{id:"21-torchtensor-\u5f20\u91cf",children:"2.1 torch.Tensor (\u5f20\u91cf)"}),"\n",(0,s.jsx)(e.p,{children:"PyTorch \u7684\u6838\u5fc3\u6570\u636e\u7ed3\u6784\uff0c\u7c7b\u4f3c\u4e8e NumPy \u7684 ndarray\uff0c\u4f46\u652f\u6301\u5728 GPU \u4e0a\u8fd0\u884c\u4ee5\u52a0\u901f\u8ba1\u7b97\u3002\u5b83\u662f\u6240\u6709\u6df1\u5ea6\u5b66\u4e60\u64cd\u4f5c\u7684\u57fa\u7840\u8f7d\u4f53\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"22-torchautograd-\u81ea\u52a8\u5fae\u5206",children:"2.2 torch.autograd (\u81ea\u52a8\u5fae\u5206)"}),"\n",(0,s.jsx)(e.p,{children:"\u8fd9\u662f PyTorch \u7684\u795e\u7ecf\u7f51\u7edc\u8bad\u7ec3\u5f15\u64ce\u7684\u6838\u5fc3\u3002\u5b83\u4e3a Tensors \u4e0a\u7684\u6240\u6709\u64cd\u4f5c\u63d0\u4f9b\u81ea\u52a8\u5fae\u5206\u3002\u5b83\u662f\u4e00\u4e2a\u201c\u6309\u8fd0\u884c\u5b9a\u4e49\u201d\uff08Define-by-Run\uff09\u7684\u6846\u67b6\uff0c\u8fd9\u610f\u5473\u7740\u53cd\u5411\u4f20\u64ad\u662f\u6839\u636e\u4ee3\u7801\u7684\u8fd0\u884c\u65b9\u5f0f\u5b9a\u4e49\u7684\uff0c\u6bcf\u6b21\u8fed\u4ee3\u90fd\u53ef\u4ee5\u4e0d\u540c\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"23-torchnn-\u795e\u7ecf\u7f51\u7edc\u6784\u5efa",children:"2.3 torch.nn (\u795e\u7ecf\u7f51\u7edc\u6784\u5efa)"}),"\n",(0,s.jsxs)(e.p,{children:["\u4e13\u4e3a\u6784\u5efa\u795e\u7ecf\u7f51\u7edc\u8bbe\u8ba1\u7684\u6a21\u5757\u3002\u5b83\u63d0\u4f9b\u4e86\u5c42\uff08Layer\uff09\u3001\u635f\u5931\u51fd\u6570\uff08Loss Function\uff09\u548c\u5bb9\u5668\uff08\u5982 ",(0,s.jsx)(e.code,{children:"Sequential"}),"\uff09\u3002",(0,s.jsx)(e.code,{children:"torch.nn.Module"})," \u662f\u6240\u6709\u795e\u7ecf\u7f51\u7edc\u6a21\u5757\u7684\u57fa\u7c7b\uff0c\u5c01\u88c5\u4e86\u53c2\u6570\u7ba1\u7406\u548c\u524d\u5411\u4f20\u64ad\u903b\u8f91\u3002"]}),"\n",(0,s.jsx)(e.h3,{id:"24-torchoptim-\u4f18\u5316\u5668",children:"2.4 torch.optim (\u4f18\u5316\u5668)"}),"\n",(0,s.jsx)(e.p,{children:"\u5b9e\u73b0\u4e86\u5404\u79cd\u4f18\u5316\u7b97\u6cd5\uff08\u5982 SGD, Adam, RMSprop \u7b49\uff09\u3002\u4f18\u5316\u5668\u8d1f\u8d23\u63a5\u6536\u6a21\u578b\u53c2\u6570\uff0c\u5e76\u6839\u636e\u8ba1\u7b97\u51fa\u7684\u68af\u5ea6\u66f4\u65b0\u8fd9\u4e9b\u53c2\u6570\uff0c\u4ee5\u6700\u5c0f\u5316\u635f\u5931\u51fd\u6570\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"25-torchutilsdata-\u6570\u636e\u5904\u7406",children:"2.5 torch.utils.data (\u6570\u636e\u5904\u7406)"}),"\n",(0,s.jsxs)(e.p,{children:["\u63d0\u4f9b\u4e86 ",(0,s.jsx)(e.code,{children:"Dataset"})," \u548c ",(0,s.jsx)(e.code,{children:"DataLoader"})," \u4e24\u4e2a\u6838\u5fc3\u5de5\u5177\u3002",(0,s.jsx)(e.code,{children:"Dataset"})," \u5c01\u88c5\u4e86\u6570\u636e\u6e90\u548c\u8bfb\u53d6\u903b\u8f91\uff0c",(0,s.jsx)(e.code,{children:"DataLoader"})," \u5219\u8d1f\u8d23\u9ad8\u6548\u5730\u6279\u91cf\u52a0\u8f7d\u6570\u636e\u3001\u6253\u4e71\u987a\u5e8f\u548c\u591a\u8fdb\u7a0b\u8bfb\u53d6\u3002"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"3-pytorch-\u5185\u90e8\u67b6\u6784\u4e0e\u6a21\u5757\u4ea4\u4e92",children:"3. PyTorch \u5185\u90e8\u67b6\u6784\u4e0e\u6a21\u5757\u4ea4\u4e92"}),"\n",(0,s.jsx)(e.p,{children:"PyTorch \u7684\u67b6\u6784\u8bbe\u8ba1\u65e8\u5728\u8fde\u63a5\u6613\u7528\u7684 Python \u524d\u7aef\u548c\u9ad8\u6027\u80fd\u7684 C++ \u540e\u7aef\u3002"}),"\n",(0,s.jsx)(e.h3,{id:"\u67b6\u6784\u5206\u5c42",children:"\u67b6\u6784\u5206\u5c42"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Python Frontend"}),": \u7528\u6237\u4ea4\u4e92\u5c42\uff0c\u63d0\u4f9b Python API\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"C++ Frontend / Bindings"}),": \u901a\u8fc7 PyBind11 \u5c06 Python \u8c03\u7528\u6620\u5c04\u5230 C++\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Core (libtorch)"}),":","\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"ATen (A Tensor Library)"}),": \u5e95\u5c42\u5f20\u91cf\u8fd0\u7b97\u5e93\uff0c\u5904\u7406\u6570\u5b66\u8ba1\u7b97\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Autograd Engine"}),": \u8d1f\u8d23\u8bb0\u5f55\u8fd0\u7b97\u5386\u53f2\u5e76\u8ba1\u7b97\u68af\u5ea6\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"JIT (Just-In-Time) Compiler"}),": \u5c06\u52a8\u6001\u56fe\u8f6c\u6362\u4e3a\u9759\u6001\u56fe\uff08TorchScript\uff09\u4ee5\u8fdb\u884c\u4f18\u5316\u3002"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Hardware Abstraction"}),": \u9002\u914d CPU, CUDA (NVIDIA GPU), MPS (Apple Silicon) \u7b49\u786c\u4ef6\u3002"]}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"\u6a21\u5757\u4f5c\u7528\u56fe\u89e3-mermaid",children:"\u6a21\u5757\u4f5c\u7528\u56fe\u89e3 (Mermaid)"}),"\n",(0,s.jsx)(e.p,{children:"\u4e0b\u9762\u7684\u7ec4\u4ef6\u56fe\u5c55\u793a\u4e86 PyTorch \u5185\u90e8\u5404\u4e2a\u6a21\u5757\u5982\u4f55\u534f\u540c\u5de5\u4f5c\uff0c\u4ece\u7528\u6237\u4ee3\u7801\u5230\u5e95\u5c42\u786c\u4ef6\u6267\u884c\u3002"}),"\n",(0,s.jsx)(e.mermaid,{value:'graph TB\n    %% \u5b9a\u4e49\u6837\u5f0f\n    classDef python fill:#e1f5fe,stroke:#01579b,stroke-width:2px\n    classDef cpp fill:#fff3e0,stroke:#e65100,stroke-width:2px\n    classDef hardware fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px\n\n    subgraph User_Space["\u7528\u6237\u7a7a\u95f4"]\n        direction TB\n        UserCode["\u7528\u6237\u4ee3\u7801<br/>Python Script"]:::python\n    end\n\n    subgraph PyTorch_Python_Frontend["Python \u524d\u7aef"]\n        direction TB\n        TorchAPI["torch API<br/>Top Level"]:::python\n        NN["torch.nn / torch.optim"]:::python\n        DataUtils["torch.utils.data"]:::python\n        \n        UserCode --\x3e TorchAPI\n        UserCode --\x3e NN\n        UserCode --\x3e DataUtils\n        NN --\x3e TorchAPI\n    end\n\n    subgraph PyTorch_Internal["C++ \u6838\u5fc3\u5c42 libtorch"]\n        direction TB\n        \n        Dispatcher["Dispatcher / PyBind11"]:::cpp\n        Autograd["Autograd Engine<br/>\u81ea\u52a8\u5fae\u5206"]:::cpp\n        JIT["JIT Compiler<br/>TorchScript"]:::cpp\n        \n        subgraph ATen_Lib["ATen \u5e93"]\n            ATen["ATen<br/>Tensor Operations"]:::cpp\n        end\n        \n        TorchAPI --\x3e Dispatcher\n        Dispatcher --\x3e Autograd\n        Dispatcher --\x3e JIT\n        Dispatcher --\x3e ATen\n        \n        Autograd --\x3e|\u68af\u5ea6\u8ba1\u7b97| ATen\n        JIT --\x3e|\u4f18\u5316\u6267\u884c| ATen\n    end\n\n    subgraph Hardware_Layer["\u786c\u4ef6\u52a0\u901f\u5c42"]\n        direction LR\n        CPU["CPU<br/>MKL/OpenMP"]:::hardware\n        CUDA["GPU<br/>CUDA/cuDNN"]:::hardware\n        OtherHW["TPU/MPS"]:::hardware\n    end\n\n    ATen --\x3e CPU\n    ATen --\x3e CUDA\n    ATen --\x3e OtherHW'}),"\n",(0,s.jsx)(e.h3,{id:"\u56fe\u89e3\u8bf4\u660e",children:"\u56fe\u89e3\u8bf4\u660e"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"User Code"}),": \u5f00\u53d1\u8005\u7f16\u5199\u7684 Python \u811a\u672c\uff0c\u5b9a\u4e49\u6a21\u578b\u3001\u6570\u636e\u52a0\u8f7d\u548c\u8bad\u7ec3\u5faa\u73af\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"torch.nn / torch.optim"}),": \u9ad8\u7ea7 API\uff0c\u7528\u6237\u901a\u8fc7\u5b83\u4eec\u6784\u5efa\u6a21\u578b\u548c\u7ba1\u7406\u4f18\u5316\u8fc7\u7a0b\uff0c\u6700\u7ec8\u8c03\u7528\u5e95\u5c42\u7684 Tensor \u64cd\u4f5c\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Dispatcher"}),": \u8fd9\u662f\u4e00\u4e2a\u5173\u952e\u7684\u5206\u53d1\u673a\u5236\u3002\u5f53\u4f60\u5728 Python \u4e2d\u8c03\u7528 ",(0,s.jsx)(e.code,{children:"torch.add"})," \u65f6\uff0cDispatcher \u8d1f\u8d23\u6839\u636e Tensor \u7684\u7c7b\u578b\uff08\u662f CPU \u8fd8\u662f GPU\uff0c\u662f float \u8fd8\u662f int\uff09\u5c06\u8c03\u7528\u5206\u53d1\u5230\u6b63\u786e\u7684 C++ \u5b9e\u73b0\u51fd\u6570\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Autograd Engine"}),": \u5728\u524d\u5411\u4f20\u64ad\uff08Forward Pass\uff09\u65f6\uff0c\u5b83\u4f1a\u6784\u5efa\u4e00\u4e2a\u52a8\u6001\u8ba1\u7b97\u56fe\u3002\u5728\u53cd\u5411\u4f20\u64ad\uff08Backward Pass\uff09\u65f6\uff0c\u5b83\u904d\u5386\u8fd9\u4e2a\u56fe\u6765\u8ba1\u7b97\u68af\u5ea6\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"ATen"}),": PyTorch \u7684\u201c\u808c\u8089\u201d\u3002\u5b83\u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684 C++ \u5e93\uff0c\u5b9e\u73b0\u4e86\u6240\u6709\u5e95\u5c42\u7684\u5f20\u91cf\u8fd0\u7b97\uff08\u52a0\u6cd5\u3001\u77e9\u9635\u4e58\u6cd5\u3001\u5377\u79ef\u7b49\uff09\u3002"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Hardware"}),": \u6700\u7ec8\u7684\u8ba1\u7b97\u6307\u4ee4\u88ab\u53d1\u9001\u5230 CPU \u6216 GPU \u4e0a\u6267\u884c\u3002"]}),"\n"]})]})}function a(n={}){const{wrapper:e}={...(0,t.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(l,{...n})}):l(n)}},54213:(n,e,r)=>{r.d(e,{R:()=>c,x:()=>i});var o=r(36672);const s={},t=o.createContext(s);function c(n){const e=o.useContext(t);return o.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:c(n.components),o.createElement(t.Provider,{value:e},n.children)}}}]);