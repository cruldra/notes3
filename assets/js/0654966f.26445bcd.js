"use strict";(self.webpackChunknotes_3=self.webpackChunknotes_3||[]).push([[87967],{12651:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>t});const s=JSON.parse('{"id":"AI/Pytorch/\u795e\u7ecf\u7f51\u7edc/\u7b80\u4ecb","title":"\u7b80\u4ecb","description":"1. \u6982\u8ff0","source":"@site/docs/AI/Pytorch/\u795e\u7ecf\u7f51\u7edc/\u7b80\u4ecb.md","sourceDirName":"AI/Pytorch/\u795e\u7ecf\u7f51\u7edc","slug":"/AI/Pytorch/\u795e\u7ecf\u7f51\u7edc/\u7b80\u4ecb","permalink":"/notes3/docs/AI/Pytorch/\u795e\u7ecf\u7f51\u7edc/\u7b80\u4ecb","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/AI/Pytorch/\u795e\u7ecf\u7f51\u7edc/\u7b80\u4ecb.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"ai","previous":{"title":"\u4ecb\u7ecd","permalink":"/notes3/docs/AI/Pytorch/\u4ecb\u7ecd"},"next":{"title":"CrossEntropyLoss","permalink":"/notes3/docs/AI/Pytorch/\u795e\u7ecf\u7f51\u7edc/CrossEntropyLoss"}}');var d=r(23420),i=r(54213);const o={sidebar_position:1},l=void 0,c={},t=[{value:"1. \u6982\u8ff0",id:"1-\u6982\u8ff0",level:2},{value:"2. \u67b6\u6784\u8bbe\u8ba1",id:"2-\u67b6\u6784\u8bbe\u8ba1",level:2},{value:"2.1 \u7c7b\u5c42\u6b21\u7ed3\u6784",id:"21-\u7c7b\u5c42\u6b21\u7ed3\u6784",level:3},{value:"2.2 \u6838\u5fc3\u804c\u8d23",id:"22-\u6838\u5fc3\u804c\u8d23",level:3},{value:"3. \u6838\u5fc3\u673a\u5236\u8be6\u89e3",id:"3-\u6838\u5fc3\u673a\u5236\u8be6\u89e3",level:2},{value:"3.1 \u53c2\u6570\u81ea\u52a8\u6ce8\u518c\u673a\u5236",id:"31-\u53c2\u6570\u81ea\u52a8\u6ce8\u518c\u673a\u5236",level:3},{value:"3.2 \u524d\u5411\u4f20\u64ad\uff08Forward Propagation\uff09",id:"32-\u524d\u5411\u4f20\u64adforward-propagation",level:3},{value:"3.3 \u8bad\u7ec3\u6a21\u5f0f\u4e0e\u8bc4\u4f30\u6a21\u5f0f",id:"33-\u8bad\u7ec3\u6a21\u5f0f\u4e0e\u8bc4\u4f30\u6a21\u5f0f",level:3},{value:"4. \u5e38\u7528\u5bb9\u5668\uff08Containers\uff09",id:"4-\u5e38\u7528\u5bb9\u5668containers",level:2},{value:"5. \u9ad8\u7ea7\u529f\u80fd\uff1aHooks (\u94a9\u5b50)",id:"5-\u9ad8\u7ea7\u529f\u80fdhooks-\u94a9\u5b50",level:2},{value:"6. \u4ee3\u7801\u793a\u4f8b\uff1a\u6784\u5efa\u81ea\u5b9a\u4e49\u6a21\u578b",id:"6-\u4ee3\u7801\u793a\u4f8b\u6784\u5efa\u81ea\u5b9a\u4e49\u6a21\u578b",level:2},{value:"7. \u603b\u7ed3",id:"7-\u603b\u7ed3",level:2},{value:"8. \u53c2\u8003\u8d44\u6599",id:"8-\u53c2\u8003\u8d44\u6599",level:2}];function a(n){const e={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.h2,{id:"1-\u6982\u8ff0",children:"1. \u6982\u8ff0"}),"\n",(0,d.jsxs)(e.p,{children:["PyTorch \u7684 ",(0,d.jsx)(e.code,{children:"torch.nn"})," \u6a21\u5757\u662f\u6784\u5efa\u6df1\u5ea6\u5b66\u4e60\u6a21\u578b\u7684\u6838\u5fc3\u5e93\u3002\u5b83\u63d0\u4f9b\u4e86\u4e00\u7cfb\u5217\u6784\u5efa\u795e\u7ecf\u7f51\u7edc\u6240\u9700\u7684\u7ec4\u4ef6\uff0c\u5305\u62ec\u5c42\uff08Layers\uff09\u3001\u6fc0\u6d3b\u51fd\u6570\uff08Activation Functions\uff09\u3001\u635f\u5931\u51fd\u6570\uff08Loss Functions\uff09\u7b49\u3002"]}),"\n",(0,d.jsxs)(e.p,{children:["\u5176\u4e2d\uff0c",(0,d.jsx)(e.code,{children:"nn.Module"})," \u662f\u6240\u6709\u795e\u7ecf\u7f51\u7edc\u6a21\u5757\u7684\u57fa\u7c7b\uff08Base Class\uff09\u3002\u5728 PyTorch \u4e2d\uff0c\u65e0\u8bba\u662f\u7b80\u5355\u7684\u7ebf\u6027\u5c42\u3001\u590d\u6742\u7684\u5377\u79ef\u795e\u7ecf\u7f51\u7edc\uff08CNN\uff09\uff0c\u8fd8\u662f\u6574\u4e2a Transformer \u6a21\u578b\uff0c\u672c\u8d28\u4e0a\u90fd\u662f ",(0,d.jsx)(e.code,{children:"nn.Module"})," \u7684\u5b50\u7c7b\u3002\u7406\u89e3 ",(0,d.jsx)(e.code,{children:"nn.Module"})," \u7684\u8bbe\u8ba1\u6a21\u5f0f\u548c\u751f\u547d\u5468\u671f\uff0c\u662f\u638c\u63e1 PyTorch \u6a21\u578b\u5f00\u53d1\u7684\u5173\u952e\u3002"]}),"\n",(0,d.jsx)(e.h2,{id:"2-\u67b6\u6784\u8bbe\u8ba1",children:"2. \u67b6\u6784\u8bbe\u8ba1"}),"\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.code,{children:"nn.Module"})," \u91c7\u7528\u4e86**\u7ec4\u5408\u6a21\u5f0f\uff08Composite Pattern\uff09**\u7684\u8bbe\u8ba1\u601d\u60f3\u3002\u5b83\u65e2\u53ef\u4ee5\u8868\u793a\u4e00\u4e2a\u5355\u72ec\u7684\u5c42\uff08\u5982 ",(0,d.jsx)(e.code,{children:"nn.Linear"}),"\uff09\uff0c\u4e5f\u53ef\u4ee5\u8868\u793a\u7531\u591a\u4e2a\u5c42\u7ec4\u6210\u7684\u6574\u4e2a\u795e\u7ecf\u7f51\u7edc\u3002\u8fd9\u79cd\u9012\u5f52\u7ed3\u6784\u4f7f\u5f97\u6a21\u578b\u7684\u6784\u5efa\u3001\u7ba1\u7406\u548c\u8f6c\u6362\u53d8\u5f97\u6781\u5176\u7075\u6d3b\u3002"]}),"\n",(0,d.jsx)(e.h3,{id:"21-\u7c7b\u5c42\u6b21\u7ed3\u6784",children:"2.1 \u7c7b\u5c42\u6b21\u7ed3\u6784"}),"\n",(0,d.jsx)(e.mermaid,{value:"classDiagram\n    class Module {\n        +__init__()\n        +forward()\n        +parameters()\n        +buffers()\n        +to(device)\n        +state_dict()\n        +load_state_dict()\n        -_parameters : OrderedDict\n        -_modules : OrderedDict\n        -_buffers : OrderedDict\n    }\n    \n    class Parameter {\n        +requires_grad : bool\n        +data : Tensor\n    }\n\n    class Linear {\n        +weight : Parameter\n        +bias : Parameter\n        +forward()\n    }\n    \n    class Conv2d {\n        +weight : Parameter\n        +bias : Parameter\n        +forward()\n    }\n    \n    class Sequential {\n        +add_module()\n        +forward()\n    }\n\n    Module <|-- Linear\n    Module <|-- Conv2d\n    Module <|-- Sequential\n    Tensor <|-- Parameter\n    Module o-- Parameter : contains\n    Module o-- Module : contains (submodules)"}),"\n",(0,d.jsx)(e.h3,{id:"22-\u6838\u5fc3\u804c\u8d23",children:"2.2 \u6838\u5fc3\u804c\u8d23"}),"\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.code,{children:"nn.Module"})," \u4e3b\u8981\u627f\u62c5\u4ee5\u4e0b\u804c\u8d23\uff1a"]}),"\n",(0,d.jsxs)(e.ol,{children:["\n",(0,d.jsxs)(e.li,{children:["\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.strong,{children:"\u72b6\u6001\u7ba1\u7406\uff08State Management\uff09"}),"\uff1a"]}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.strong,{children:"Parameters\uff08\u53c2\u6570\uff09"}),"\uff1a\u6a21\u578b\u4e2d\u9700\u8981\u88ab\u4f18\u5316\u7684\u6743\u91cd\uff08\u5982 ",(0,d.jsx)(e.code,{children:"weight"})," \u548c ",(0,d.jsx)(e.code,{children:"bias"}),"\uff09\u3002\u5b83\u4eec\u662f ",(0,d.jsx)(e.code,{children:"torch.nn.Parameter"})," \u7684\u5b9e\u4f8b\uff08",(0,d.jsx)(e.code,{children:"Tensor"})," \u7684\u5b50\u7c7b\uff09\uff0c\u5728\u8d4b\u503c\u7ed9 ",(0,d.jsx)(e.code,{children:"Module"})," \u5c5e\u6027\u65f6\u4f1a\u81ea\u52a8\u6ce8\u518c\u5230 ",(0,d.jsx)(e.code,{children:"_parameters"})," \u5b57\u5178\u4e2d\u3002"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.strong,{children:"Buffers\uff08\u7f13\u51b2\u533a\uff09"}),"\uff1a\u4e0d\u9700\u8981\u8ba1\u7b97\u68af\u5ea6\u7684\u72b6\u6001\uff08\u5982 BatchNorm \u4e2d\u7684 ",(0,d.jsx)(e.code,{children:"running_mean"}),"\uff09\u3002\u901a\u8fc7 ",(0,d.jsx)(e.code,{children:"register_buffer"})," \u65b9\u6cd5\u6ce8\u518c\uff0c\u5305\u542b\u5728 ",(0,d.jsx)(e.code,{children:"state_dict"})," \u4e2d\u4f46\u4e0d\u53c2\u4e0e\u53cd\u5411\u4f20\u64ad\u66f4\u65b0\u3002"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.strong,{children:"Submodules\uff08\u5b50\u6a21\u5757\uff09"}),"\uff1a\u5d4c\u5957\u7684 ",(0,d.jsx)(e.code,{children:"nn.Module"})," \u5b9e\u4f8b\u3002\u8d4b\u503c\u65f6\u4f1a\u81ea\u52a8\u6ce8\u518c\u5230 ",(0,d.jsx)(e.code,{children:"_modules"})," \u5b57\u5178\u4e2d\uff0c\u5f62\u6210\u6811\u72b6\u7ed3\u6784\u3002"]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.strong,{children:"\u8ba1\u7b97\u56fe\u6784\u5efa\uff08Computation Graph Construction\uff09"}),"\uff1a"]}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:["\u901a\u8fc7\u5b9e\u73b0 ",(0,d.jsx)(e.code,{children:"forward()"})," \u65b9\u6cd5\u5b9a\u4e49\u524d\u5411\u4f20\u64ad\u903b\u8f91\u3002"]}),"\n",(0,d.jsx)(e.li,{children:"\u4e0e PyTorch \u7684 Autograd \u7cfb\u7edf\u65e0\u7f1d\u96c6\u6210\uff0c\u81ea\u52a8\u5904\u7406\u53cd\u5411\u4f20\u64ad\u3002"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.strong,{children:"\u8bbe\u5907\u4e0e\u7c7b\u578b\u8f6c\u6362\uff08Device & Dtype Casting\uff09"}),"\uff1a"]}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:["\u63d0\u4f9b ",(0,d.jsx)(e.code,{children:".to(device)"}),", ",(0,d.jsx)(e.code,{children:".cuda()"}),", ",(0,d.jsx)(e.code,{children:".cpu()"}),", ",(0,d.jsx)(e.code,{children:".half()"})," \u7b49\u65b9\u6cd5\uff0c\u9012\u5f52\u5730\u5c06\u6240\u6709\u53c2\u6570\u548c\u7f13\u51b2\u533a\u79fb\u52a8\u5230\u6307\u5b9a\u8bbe\u5907\u6216\u8f6c\u6362\u6570\u636e\u7c7b\u578b\u3002"]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(e.li,{children:["\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.strong,{children:"\u5e8f\u5217\u5316\uff08Serialization\uff09"}),"\uff1a"]}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:["\u901a\u8fc7 ",(0,d.jsx)(e.code,{children:"state_dict()"})," \u548c ",(0,d.jsx)(e.code,{children:"load_state_dict()"})," \u65b9\u6cd5\uff0c\u65b9\u4fbf\u5730\u4fdd\u5b58\u548c\u52a0\u8f7d\u6a21\u578b\u53c2\u6570\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,d.jsx)(e.h2,{id:"3-\u6838\u5fc3\u673a\u5236\u8be6\u89e3",children:"3. \u6838\u5fc3\u673a\u5236\u8be6\u89e3"}),"\n",(0,d.jsx)(e.h3,{id:"31-\u53c2\u6570\u81ea\u52a8\u6ce8\u518c\u673a\u5236",children:"3.1 \u53c2\u6570\u81ea\u52a8\u6ce8\u518c\u673a\u5236"}),"\n",(0,d.jsxs)(e.p,{children:["\u5f53\u6211\u4eec\u5728 ",(0,d.jsx)(e.code,{children:"__init__"})," \u65b9\u6cd5\u4e2d\u5c06\u4e00\u4e2a ",(0,d.jsx)(e.code,{children:"nn.Parameter"})," \u6216 ",(0,d.jsx)(e.code,{children:"nn.Module"})," \u5bf9\u8c61\u8d4b\u503c\u7ed9\u6210\u5458\u53d8\u91cf\u65f6\uff0cPyTorch \u4f1a\u5229\u7528 Python \u7684 ",(0,d.jsx)(e.code,{children:"__setattr__"})," \u9b54\u6cd5\u65b9\u6cd5\u81ea\u52a8\u5c06\u5176\u6ce8\u518c\u3002"]}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-python",children:"import torch\nimport torch.nn as nn\n\nclass MyModel(nn.Module):\n    def __init__(self):\n        super().__init__()\n        # \u81ea\u52a8\u6ce8\u518c\u4e3a Parameter\n        self.weight = nn.Parameter(torch.randn(10, 10))\n        \n        # \u81ea\u52a8\u6ce8\u518c\u4e3a Submodule\n        self.linear = nn.Linear(10, 5)\n        \n        # \u4e0d\u4f1a\u88ab\u6ce8\u518c\uff08\u666e\u901a Tensor\uff09\n        self.temp_data = torch.randn(10) \n\nmodel = MyModel()\nprint(list(model.parameters()))  # \u5305\u542b self.weight \u548c self.linear.weight/bias\n"})}),"\n",(0,d.jsx)(e.h3,{id:"32-\u524d\u5411\u4f20\u64adforward-propagation",children:"3.2 \u524d\u5411\u4f20\u64ad\uff08Forward Propagation\uff09"}),"\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.code,{children:"forward"})," \u65b9\u6cd5\u5b9a\u4e49\u4e86\u6570\u636e\u6d41\u5411\u3002\u867d\u7136\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528 ",(0,d.jsx)(e.code,{children:"model.forward(input)"}),"\uff0c\u4f46",(0,d.jsx)(e.strong,{children:"\u5f3a\u70c8\u5efa\u8bae"}),"\u901a\u8fc7 ",(0,d.jsx)(e.code,{children:"model(input)"}),"\uff08\u5373 ",(0,d.jsx)(e.code,{children:"__call__"})," \u65b9\u6cd5\uff09\u6765\u6267\u884c\u3002"]}),"\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.code,{children:"__call__"})," \u65b9\u6cd5\u4e0d\u4ec5\u8c03\u7528\u4e86 ",(0,d.jsx)(e.code,{children:"forward"}),"\uff0c\u8fd8\u8d1f\u8d23\u5904\u7406 ",(0,d.jsx)(e.strong,{children:"Hooks\uff08\u94a9\u5b50\uff09"}),"\u3002\u8fd9\u5bf9\u4e8e\u8c03\u8bd5\u3001\u7279\u5f81\u63d0\u53d6\u548c\u53ef\u89c6\u5316\u81f3\u5173\u91cd\u8981\u3002"]}),"\n",(0,d.jsx)(e.h3,{id:"33-\u8bad\u7ec3\u6a21\u5f0f\u4e0e\u8bc4\u4f30\u6a21\u5f0f",children:"3.3 \u8bad\u7ec3\u6a21\u5f0f\u4e0e\u8bc4\u4f30\u6a21\u5f0f"}),"\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.code,{children:"nn.Module"})," \u7ef4\u62a4\u4e00\u4e2a ",(0,d.jsx)(e.code,{children:"training"})," \u6807\u5fd7\u4f4d\uff0c\u901a\u8fc7 ",(0,d.jsx)(e.code,{children:".train()"})," \u548c ",(0,d.jsx)(e.code,{children:".eval()"})," \u65b9\u6cd5\u5207\u6362\u3002"]}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:[(0,d.jsxs)(e.strong,{children:["Training Mode (",(0,d.jsx)(e.code,{children:"model.train()"}),")"]}),": \u542f\u7528 Dropout\uff0cBatchNorm \u4f7f\u7528\u5f53\u524d batch \u7684\u7edf\u8ba1\u91cf\u66f4\u65b0 running mean/var\u3002"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsxs)(e.strong,{children:["Evaluation Mode (",(0,d.jsx)(e.code,{children:"model.eval()"}),")"]}),": \u7981\u7528 Dropout\uff0cBatchNorm \u4f7f\u7528\u7d2f\u79ef\u7684 running mean/var\u3002"]}),"\n"]}),"\n",(0,d.jsx)(e.h2,{id:"4-\u5e38\u7528\u5bb9\u5668containers",children:"4. \u5e38\u7528\u5bb9\u5668\uff08Containers\uff09"}),"\n",(0,d.jsxs)(e.p,{children:["PyTorch \u63d0\u4f9b\u4e86\u51e0\u79cd\u7279\u6b8a\u7684 ",(0,d.jsx)(e.code,{children:"nn.Module"})," \u5bb9\u5668\u6765\u7ec4\u7ec7\u5c42\uff1a"]}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.strong,{children:(0,d.jsx)(e.code,{children:"nn.Sequential"})}),": \u6309\u987a\u5e8f\u6267\u884c\u7684\u5bb9\u5668\u3002\u8f93\u5165\u6570\u636e\u6309\u6dfb\u52a0\u987a\u5e8f\u6d41\u7ecf\u6bcf\u4e2a\u6a21\u5757\u3002"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.strong,{children:(0,d.jsx)(e.code,{children:"nn.ModuleList"})}),": \u7c7b\u4f3c\u4e8e Python \u7684 ",(0,d.jsx)(e.code,{children:"list"}),"\uff0c\u4f46\u5176\u4e2d\u7684 ",(0,d.jsx)(e.code,{children:"nn.Module"})," \u4f1a\u88ab\u6b63\u786e\u6ce8\u518c\u3002",(0,d.jsx)(e.strong,{children:"\u6ce8\u610f"}),"\uff1a",(0,d.jsx)(e.code,{children:"ModuleList"})," \u672c\u8eab\u4e0d\u5b9a\u4e49 ",(0,d.jsx)(e.code,{children:"forward"}),"\uff0c\u9700\u8981\u624b\u52a8\u904d\u5386\u6267\u884c\u3002"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.strong,{children:(0,d.jsx)(e.code,{children:"nn.ModuleDict"})}),": \u7c7b\u4f3c\u4e8e Python \u7684 ",(0,d.jsx)(e.code,{children:"dict"}),"\uff0c\u7528\u4e8e\u6309\u952e\u7d22\u5f15\u6a21\u5757\uff0c\u5176\u4e2d\u7684\u6a21\u5757\u4e5f\u4f1a\u88ab\u81ea\u52a8\u6ce8\u518c\u3002"]}),"\n"]}),"\n",(0,d.jsx)(e.h2,{id:"5-\u9ad8\u7ea7\u529f\u80fdhooks-\u94a9\u5b50",children:"5. \u9ad8\u7ea7\u529f\u80fd\uff1aHooks (\u94a9\u5b50)"}),"\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.code,{children:"nn.Module"})," \u63d0\u4f9b\u4e86\u6ce8\u518c Hook \u7684\u63a5\u53e3\uff0c\u5141\u8bb8\u7528\u6237\u5728\u4e0d\u4fee\u6539\u7c7b\u5b9a\u4e49\u7684\u60c5\u51b5\u4e0b\u4ecb\u5165\u8ba1\u7b97\u8fc7\u7a0b\uff1a"]}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"register_forward_pre_hook(hook)"}),": \u5728 ",(0,d.jsx)(e.code,{children:"forward"})," \u6267\u884c",(0,d.jsx)(e.strong,{children:"\u524d"}),"\u8c03\u7528\u3002"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"register_forward_hook(hook)"}),": \u5728 ",(0,d.jsx)(e.code,{children:"forward"})," \u6267\u884c",(0,d.jsx)(e.strong,{children:"\u540e"}),"\u8c03\u7528\uff08\u53ef\u83b7\u53d6\u8f93\u5165\u548c\u8f93\u51fa\uff09\u3002"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"register_full_backward_hook(hook)"}),": \u5728\u53cd\u5411\u4f20\u64ad\u8ba1\u7b97\u68af\u5ea6\u65f6\u8c03\u7528\u3002"]}),"\n"]}),"\n",(0,d.jsx)(e.h2,{id:"6-\u4ee3\u7801\u793a\u4f8b\u6784\u5efa\u81ea\u5b9a\u4e49\u6a21\u578b",children:"6. \u4ee3\u7801\u793a\u4f8b\uff1a\u6784\u5efa\u81ea\u5b9a\u4e49\u6a21\u578b"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-python",children:'import torch\nimport torch.nn as nn\nimport torch.nn.functional as F\n\nclass CustomClassifier(nn.Module):\n    def __init__(self, input_dim, hidden_dim, num_classes):\n        super(CustomClassifier, self).__init__()\n        \n        # \u5b9a\u4e49\u5c42\n        self.feature_extractor = nn.Sequential(\n            nn.Linear(input_dim, hidden_dim),\n            nn.BatchNorm1d(hidden_dim),\n            nn.ReLU(),\n            nn.Dropout(p=0.5)\n        )\n        \n        self.classifier = nn.Linear(hidden_dim, num_classes)\n        \n        # \u5b9a\u4e49\u4e00\u4e2a Buffer\uff08\u4e0d\u53c2\u4e0e\u68af\u5ea6\u66f4\u65b0\uff09\n        self.register_buffer(\'dummy_buffer\', torch.zeros(1, hidden_dim))\n\n    def forward(self, x):\n        # \u524d\u5411\u4f20\u64ad\u903b\u8f91\n        x = self.feature_extractor(x)\n        logits = self.classifier(x)\n        return logits\n\n# \u5b9e\u4f8b\u5316\u6a21\u578b\nmodel = CustomClassifier(input_dim=784, hidden_dim=256, num_classes=10)\n\n# \u6253\u5370\u6a21\u578b\u7ed3\u6784\nprint(model)\n\n# \u68c0\u67e5\u53c2\u6570\nfor name, param in model.named_parameters():\n    print(f"Parameter: {name}, Shape: {param.shape}, Requires Grad: {param.requires_grad}")\n\n# \u8bbe\u5907\u79fb\u52a8\ndevice = torch.device("cuda" if torch.cuda.is_available() else "cpu")\nmodel.to(device)\n'})}),"\n",(0,d.jsx)(e.h2,{id:"7-\u603b\u7ed3",children:"7. \u603b\u7ed3"}),"\n",(0,d.jsxs)(e.p,{children:[(0,d.jsx)(e.code,{children:"torch.nn.Module"})," \u662f PyTorch \u6df1\u5ea6\u5b66\u4e60\u6846\u67b6\u7684\u57fa\u77f3\u3002\u5b83\u901a\u8fc7\u4f18\u96c5\u7684\u9762\u5411\u5bf9\u8c61\u8bbe\u8ba1\uff0c\u5b9e\u73b0\u4e86\u53c2\u6570\u7684\u81ea\u52a8\u5316\u7ba1\u7406\u3001\u8ba1\u7b97\u56fe\u7684\u52a8\u6001\u6784\u5efa\u4ee5\u53ca\u6a21\u578b\u72b6\u6001\u7684\u5e8f\u5217\u5316\u3002\u65e0\u8bba\u662f\u6784\u5efa\u7b80\u5355\u7684\u611f\u77e5\u673a\u8fd8\u662f\u590d\u6742\u7684\u8d85\u5927\u89c4\u6a21\u6a21\u578b\uff0c\u9075\u5faa ",(0,d.jsx)(e.code,{children:"nn.Module"})," \u7684\u8bbe\u8ba1\u89c4\u8303\u90fd\u662f\u5b9e\u73b0\u9ad8\u6548\u3001\u53ef\u7ef4\u62a4\u4ee3\u7801\u7684\u524d\u63d0\u3002"]}),"\n",(0,d.jsx)(e.h2,{id:"8-\u53c2\u8003\u8d44\u6599",children:"8. \u53c2\u8003\u8d44\u6599"}),"\n",(0,d.jsxs)(e.ol,{children:["\n",(0,d.jsx)(e.li,{children:(0,d.jsx)(e.a,{href:"https://pytorch.org/docs/stable/notes/modules.html",children:"PyTorch Documentation: Modules"})}),"\n",(0,d.jsx)(e.li,{children:(0,d.jsx)(e.a,{href:"https://docs.pytorch.org/tutorials/beginner/introyt/modelsyt_tutorial.html",children:"PyTorch Tutorials: Building Models with PyTorch"})}),"\n",(0,d.jsx)(e.li,{children:(0,d.jsx)(e.a,{href:"https://docs.pytorch.org/tutorials/beginner/basics/buildmodel_tutorial.html",children:"PyTorch Tutorials: Build the Neural Network"})}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,d.jsx)(e,{...n,children:(0,d.jsx)(a,{...n})}):a(n)}},54213:(n,e,r)=>{r.d(e,{R:()=>o,x:()=>l});var s=r(36672);const d={},i=s.createContext(d);function o(n){const e=s.useContext(i);return s.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(d):n.components||d:o(n.components),s.createElement(i.Provider,{value:e},n.children)}}}]);