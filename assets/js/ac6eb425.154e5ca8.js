"use strict";(self.webpackChunknotes_3=self.webpackChunknotes_3||[]).push([[91381],{29853:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>i});const s=JSON.parse('{"id":"FrontEnd/DeepChat/\u8fde\u63a5","title":"\u8fde\u63a5 (Connect)","description":"\u5982\u4f55\u8fde\u63a5\u5230 API","source":"@site/docs/FrontEnd/DeepChat/\u8fde\u63a5.mdx","sourceDirName":"FrontEnd/DeepChat","slug":"/FrontEnd/DeepChat/\u8fde\u63a5","permalink":"/notes3/docs/FrontEnd/DeepChat/\u8fde\u63a5","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/FrontEnd/DeepChat/\u8fde\u63a5.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"frontEnd","previous":{"title":"\u7b80\u4ecb","permalink":"/notes3/docs/FrontEnd/Zustand/\u7b80\u4ecb"},"next":{"title":"Mantine 8 \u66f4\u65b0\u5185\u5bb9","permalink":"/notes3/docs/FrontEnd/Mantine/Mantine8\u66f4\u65b0\u5185\u5bb9"}}');var c=r(23420),l=r(54213);const d={},t="\u8fde\u63a5 (Connect)",o={},i=[{value:"\u5982\u4f55\u8fde\u63a5\u5230 API",id:"\u5982\u4f55\u8fde\u63a5\u5230-api",level:2},{value:"\u8bf7\u6c42\u6d88\u606f (Request message)",id:"\u8bf7\u6c42\u6d88\u606f-request-message",level:3},{value:"\u54cd\u5e94\u6d88\u606f (Response message)",id:"\u54cd\u5e94\u6d88\u606f-response-message",level:3},{value:"\u8fde\u63a5\u5c5e\u6027",id:"\u8fde\u63a5\u5c5e\u6027",level:2},{value:"<code>connect</code>",id:"connect",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b",level:4},{value:"<code>requestBodyLimits</code>",id:"requestbodylimits",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-1",level:4},{value:"\u7c7b\u578b (Types)",id:"\u7c7b\u578b-types",level:2},{value:"<code>Response</code>",id:"response",level:3},{value:"\u793a\u4f8b\uff1a",id:"\u793a\u4f8b-2",level:4},{value:"<code>Websocket</code>",id:"websocket",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-3",level:4},{value:"\u72b6\u6001\u6c14\u6ce1\u793a\u4f8b",id:"\u72b6\u6001\u6c14\u6ce1\u793a\u4f8b",level:4},{value:"<code>Stream</code>",id:"stream",level:3},{value:"\u6d41\u5f0f\u670d\u52a1\u793a\u4f8b",id:"\u6d41\u5f0f\u670d\u52a1\u793a\u4f8b",level:4},{value:"\u5e38\u89c4\u670d\u52a1\u793a\u4f8b",id:"\u5e38\u89c4\u670d\u52a1\u793a\u4f8b",level:4},{value:"<code>Handler</code>",id:"handler",level:3},{value:"\u793a\u4f8b",id:"\u793a\u4f8b-4",level:4},{value:"<code>Signals</code>",id:"signals",level:4}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"\u8fde\u63a5-connect",children:"\u8fde\u63a5 (Connect)"})}),"\n",(0,c.jsx)(n.h2,{id:"\u5982\u4f55\u8fde\u63a5\u5230-api",children:"\u5982\u4f55\u8fde\u63a5\u5230 API"}),"\n",(0,c.jsx)(n.p,{children:"\u60a8\u53ef\u4ee5\u901a\u8fc7\u5728 connect \u5c5e\u6027\u4e2d\u5b9a\u4e49\u5176\u8be6\u7ec6\u4fe1\u606f\u6765\u8fde\u63a5\u5230\u4efb\u4f55 API\u3002\u76ee\u6807\u7aef\u70b9\u9700\u8981\u80fd\u591f\u4f7f\u7528\u4e0b\u9762\u63cf\u8ff0\u7684\u683c\u5f0f\u8fdb\u884c\u63a5\u6536\u548c\u54cd\u5e94\u3002"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://youtu.be/NuRhPeqDCus",children:"\u89c6\u9891\u6f14\u793a"})}),"\n",(0,c.jsx)(n.h3,{id:"\u8bf7\u6c42\u6d88\u606f-request-message",children:"\u8bf7\u6c42\u6d88\u606f (Request message)"}),"\n",(0,c.jsx)(n.p,{children:"\u53d1\u51fa\u7684 Deep Chat \u8bf7\u6c42\u4f53\u88ab\u5c01\u88c5\u4e3a\u4ee5\u4e0b\u683c\u5f0f\u4e4b\u4e00\uff1a"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\u5f53\u4ec5\u53d1\u9001\u57fa\u4e8e",(0,c.jsx)(n.strong,{children:"\u6587\u672c"}),"\u7684\u6d88\u606f\u65f6\uff0c\u8bf7\u6c42\u4f53\u5c06\u5177\u6709\u4ee5\u4e0b JSON \u7c7b\u578b\uff1a\r\n",(0,c.jsx)(n.code,{children:"{messages: MessageContent[]}"})]}),"\n",(0,c.jsxs)(n.li,{children:["\u5f53\u53d1\u9001\u5305\u542b",(0,c.jsx)(n.strong,{children:"\u6587\u4ef6"}),"\u7684\u6d88\u606f\u65f6\uff0c\u8bf7\u6c42\u4f53\u5c06\u5e8f\u5217\u5316\u4e3a ",(0,c.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/FormData",children:"FormData"})," \u7c7b\u578b\uff0c\u5176\u4e2d\u65b0\u6587\u4ef6\u5b58\u50a8\u5728\u4e00\u4e2a\u540d\u4e3a ",(0,c.jsx)(n.em,{children:'"files"'})," \u7684\u6570\u7ec4\u5c5e\u6027\u4e2d\uff0c\u6240\u6709\u5176\u4ed6\u5185\u5bb9\u5b58\u50a8\u5728\u5177\u6709\u5bf9\u5e94\u7d22\u5f15\u7684\r\n",(0,c.jsx)(n.code,{children:"{files: File[], message1: MessageContent, message2: MessageContent... }"})]}),"\n"]}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u6ce8\u610f"})}),"\n",(0,c.jsxs)(n.p,{children:["\u89e3\u6790 ",(0,c.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/FormData",children:"FormData"})," \u7684 JS \u793a\u4f8b\uff1a",(0,c.jsx)(n.code,{children:'formData.get("message1")'})]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"\u54cd\u5e94\u6d88\u606f-response-message",children:"\u54cd\u5e94\u6d88\u606f (Response message)"}),"\n",(0,c.jsx)(n.p,{children:"\u6765\u81ea\u76ee\u6807\u670d\u52a1\u5668\u7684\u54cd\u5e94\u9700\u8981\u4f7f\u7528 Response JSON \u7c7b\u578b\u3002"}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u63d0\u793a"})}),"\n",(0,c.jsx)(n.p,{children:"\u5982\u679c\u60a8\u4e0d\u60f3/\u65e0\u6cd5\u66f4\u6539\u76ee\u6807\u670d\u52a1\u5668\u6765\u5904\u7406\u6240\u9700\u7684\u5bf9\u8c61\u7c7b\u578b\uff0c\u8bf7\u4f7f\u7528 interceptor\uff08\u62e6\u622a\u5668\uff09\u5c5e\u6027\u6765\u589e\u5f3a\u4f20\u8f93\u7684\u5bf9\u8c61\uff0c\u6216\u4f7f\u7528 handler \u51fd\u6570\u6765\u63a7\u5236\u8bf7\u6c42\u4ee3\u7801\u3002"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"\u8fde\u63a5\u5c5e\u6027",children:"\u8fde\u63a5\u5c5e\u6027"}),"\n",(0,c.jsx)(n.h3,{id:"connect",children:(0,c.jsx)(n.code,{children:"connect"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"\u7c7b\u578b: {\r\n    \xa0\xa0\xa0\xa0 `url?: string`,\r\n    \xa0\xa0\xa0\xa0 `method?: string`,\r\n    \xa0\xa0\xa0\xa0 `headers?: {[string]: string}`,\r\n    \xa0\xa0\xa0\xa0 `additionalBodyProps?: {[string]: any}`,\r\n    \xa0\xa0\xa0\xa0 [`credentials?: string`](https://developer.mozilla.org/en-US/docs/Web/API/Request/credentials),\r\n    \xa0\xa0\xa0\xa0 [`websocket?: Websocket`],\r\n    \xa0\xa0\xa0\xa0 [`stream?: Stream`],\r\n    \xa0\xa0\xa0\xa0 [`handler?: Handler`]\r\n    }\n"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:'\u9ed8\u8ba4\u503c: *{ method: "POST", credentials: "same-origin" }*\r\n\n'})}),"\n",(0,c.jsxs)(n.p,{children:["\u53d1\u51fa API \u8bf7\u6c42\u7684\u8bbe\u7f6e\u3002\u6b64\u5bf9\u8c61\u5fc5\u987b\u5b9a\u4e49 ",(0,c.jsx)(n.code,{children:"url"})," \u6216 ",(0,c.jsx)(n.code,{children:"handler"})," \u5c5e\u6027\u3002\r\n",(0,c.jsx)(n.code,{children:"additionalBodyProps"})," \u7528\u4e8e\u5411\u53d1\u51fa\u7684\u6d88\u606f\u4f53\u6dfb\u52a0\u989d\u5916\u7684\u952e\u503c\u5c5e\u6027\u3002\r\n",(0,c.jsx)(n.code,{children:"credentials"})," \u7528\u4e8e\u914d\u7f6e\u53d1\u51fa\u7684\u8bf7\u6c42\u662f\u5426\u5e94\u5305\u542b cookie\u3002",(0,c.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Request/credentials",children:"\u66f4\u591a\u4fe1\u606f"}),"\u3002\r\n",(0,c.jsx)(n.code,{children:"websocket"})," \u7528\u4e8e\u5efa\u7acb websocket \u8fde\u63a5\uff0c\u800c\u4e0d\u662f\u53d1\u9001 REST \u8bf7\u6c42\u3002"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://youtu.be/NuRhPeqDCus?si=B98OGweTBwiMnMzb&t=40",children:"\u89c6\u9891\u6f14\u793a"})}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b",children:"\u793a\u4f8b"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"\u793a\u4f8b\u4ee3\u7801"}),"\n",(0,c.jsx)(n.li,{children:"\u5b8c\u6574\u4ee3\u7801"}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-html",children:'<deep-chat\r\n  connect=\'{\r\n    "url": "https://customapi.com/message",\r\n    "method": "POST",\r\n    "headers": {"customName": "customHeaderValue"},\r\n    "additionalBodyProps": {"customBodyField": "customBodyValue"}\r\n  }\'\r\n></deep-chat>\n'})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-html",children:'\x3c!-- \u6b64\u793a\u4f8b\u9002\u7528\u4e8e\u539f\u751f JS\uff0c\u5e94\u6839\u636e\u60a8\u7684\u6846\u67b6\u8fdb\u884c\u8c03\u6574\uff08\u8bf7\u53c2\u9605\u793a\u4f8b\uff09 --\x3e\r\n\r\n<deep-chat\r\n  connect=\'{\r\n    "url": "https://customapi.com/message",\r\n    "method": "POST",\r\n    "headers": {"customName": "customHeaderValue"},\r\n    "additionalBodyProps": {"customBodyField": "customBodyValue"}\r\n  }\'\r\n  style="border-radius: 8px"\r\n></deep-chat>\n'})}),"\n",(0,c.jsx)(n.h3,{id:"requestbodylimits",children:(0,c.jsx)(n.code,{children:"requestBodyLimits"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\u7c7b\u578b: ","totalMessagesMaxCharLength?: number"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["\u7528\u4e8e\u9650\u5236\u5c06\u5305\u542b\u5728\u53d1\u51fa\u8bf7\u6c42\u4e2d\u7684\u5185\u5bb9\u3002\r\n",(0,c.jsx)(n.code,{children:"maxMessages"})," \u662f\u4ece\u6700\u65b0\u4e00\u6761\u5f00\u59cb\u8ba1\u7b97\u7684\u6700\u5927\u6d88\u606f\u6570\u91cf\u3002\u5982\u679c\u5c06\u5176\u8bbe\u7f6e\u4e3a\u5927\u4e8e ",(0,c.jsx)(n.em,{children:"0"})," \u7684\u6570\u5b57\uff08\u4f8b\u5982 ",(0,c.jsx)(n.em,{children:"1"}),"\uff09\uff0c\u5219\u53d1\u51fa\u7684\u8bf7\u6c42\u5c06\u4ec5\u5305\u542b\u65b0\u7684\u7528\u6237\u6d88\u606f\uff1b\u5982\u679c\u662f ",(0,c.jsx)(n.em,{children:"2"})," - \u5b83\u8fd8\u5c06\u5305\u542b\u6700\u65b0\u6d88\u606f\u4e4b\u524d\u7684\u4e00\u6761\u6d88\u606f\uff08\u6765\u81ea AI \u6216\u7528\u6237\uff09\uff0c\u4f9d\u6b64\u7c7b\u63a8... \u5982\u679c\u8be5\u6570\u5b57\u4e3a ",(0,c.jsx)(n.em,{children:"0"})," \u6216\u66f4\u5c0f - \u8bf7\u6c42\u5c06\u5305\u542b\u804a\u5929\u4e2d\u7684\u6240\u6709\u6d88\u606f\u3002\u5982\u679c\u662f ",(0,c.jsx)(n.em,{children:"undefined"}),"\uff0c\u8bf7\u6c42\u5c06\u4ec5\u5305\u542b\u8f93\u5165\u7684\u6587\u672c/\u6587\u4ef6\u3002\r\n",(0,c.jsx)(n.code,{children:"totalMessagesMaxCharLength"})," \u662f\u4ece\u6700\u65b0\u6d88\u606f\u5f00\u59cb\u8ba1\u7b97\u7684\uff0c\u8bf7\u6c42\u4e2d\u53d1\u9001\u7684\u6587\u672c\u5b57\u7b26\u7684\u603b\u6700\u5927\u6570\u91cf\u3002\r\n\u8fd9\u4e9b\u9650\u5236\u4e0d\u5305\u62ec introMessage\u3002"]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-1",children:"\u793a\u4f8b"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"\u793a\u4f8b\u4ee3\u7801"}),"\n",(0,c.jsx)(n.li,{children:"\u5b8c\u6574\u4ee3\u7801"}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-html",children:'<deep-chat\r\n  requestBodyLimits=\'{\r\n    "totalMessagesMaxCharLength": 20,\r\n    "maxMessages": 2\r\n  }\'\r\n></deep-chat>\n'})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-html",children:'\x3c!-- \u6b64\u793a\u4f8b\u9002\u7528\u4e8e\u539f\u751f JS\uff0c\u5e94\u6839\u636e\u60a8\u7684\u6846\u67b6\u8fdb\u884c\u8c03\u6574\uff08\u8bf7\u53c2\u9605\u793a\u4f8b\uff09 --\x3e\r\n\r\n<deep-chat\r\n  requestBodyLimits=\'{\r\n    "totalMessagesMaxCharLength": 20,\r\n    "maxMessages": 2\r\n  }\'\r\n  style="border-radius: 8px"\r\n  demo="true"\r\n  introMessage=\'{"text": Observe the data that is going to be sent below."}\'\r\n></deep-chat>\n'})}),"\n",(0,c.jsx)(n.h2,{id:"\u7c7b\u578b-types",children:"\u7c7b\u578b (Types)"}),"\n",(0,c.jsx)(n.p,{children:"\u4e0e\u5176\u4ed6\u7ec4\u4ef6\u5c5e\u6027\u5171\u4eab\u7684\u7c7b\u578b\uff1a"}),"\n",(0,c.jsx)(n.h3,{id:"response",children:(0,c.jsx)(n.code,{children:"Response"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"\u7c7b\u578b: {MessageContent, `error?: string`, `overwrite?: boolean`} | `Array`\n"})}),"\n",(0,c.jsxs)(n.p,{children:["\u5305\u542b\u6765\u81ea\u76ee\u6807\u670d\u52a1\u54cd\u5e94\u4fe1\u606f\u7684\u5bf9\u8c61\u3002\u5b83\u5177\u6709\u4e0e MessageContent \u76f8\u540c\u7684\u5c5e\u6027\uff0c\u5e76\u9644\u52a0\u4e86\u53ef\u9009\u7684 ",(0,c.jsx)(n.code,{children:"error"})," \u548c ",(0,c.jsx)(n.code,{children:"overwrite"})," \u5c5e\u6027\uff1a\r\n",(0,c.jsx)(n.code,{children:"text"})," \u662f\u6587\u672c\u6d88\u606f\u7684\u5185\u5bb9\u3002\r\n",(0,c.jsx)(n.code,{children:"files"})," \u662f\u4e00\u4e2a\u5c01\u88c5\u54cd\u5e94\u4ef6\u8be6\u60c5\u7684\u6570\u7ec4\u3002\r\n",(0,c.jsx)(n.code,{children:"html"})," \u662f\u5b9a\u4e49\u81ea\u5b9a\u4e49\u5143\u7d20\u6807\u8bb0\u7684\u5b57\u7b26\u4e32\u3002\u5b83\u5fc5\u987b\u63cf\u8ff0\u5b8c\u6574\u7684\u5143\u7d20\u3002\r\n",(0,c.jsx)(n.code,{children:"error"})," \u63cf\u8ff0\u6709\u5173\u670d\u52a1\u5668\u9519\u8bef\u7684\u4fe1\u606f\u3002\u5982\u679c errorMessages \u4e2d\u7684 ",(0,c.jsx)(n.em,{children:"displayServiceErrorMessages"})," \u5c5e\u6027\u8bbe\u7f6e\u4e3a ",(0,c.jsx)(n.em,{children:"true"}),"\uff0c\u5219\u76f8\u540c\u7684\u6d88\u606f\u5c06\u663e\u793a\u5728\u804a\u5929\u7684\u9519\u8bef\u6c14\u6ce1\u4e2d\u3002\r\n",(0,c.jsx)(n.code,{children:"overwrite"})," \u66ff\u6362\u6765\u81ea\u540c\u4e00\u89d2\u8272\u7684\u6700\u540e\u4e00\u6761\u6d88\u606f\uff0c\u5982\u679c\u672a\u627e\u5230\u5219\u521b\u5efa\u4e00\u4e2a\u65b0\u6d88\u606f\u3002\u72b6\u6001\u6c14\u6ce1\u793a\u4f8b\u89c1\u4e0b\u6587\u3002\r\nDeep Chat \u4e5f\u63a5\u53d7 ",(0,c.jsx)(n.code,{children:"Array"})," \u4e2d\u7684\u591a\u4e2a ",(0,c.jsx)(n.code,{children:"Response"})," \u5bf9\u8c61\uff0c\u4f46\u662f Stream \u4e0d\u652f\u6301\u6b64\u529f\u80fd\u3002"]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-2",children:"\u793a\u4f8b\uff1a"}),"\n",(0,c.jsxs)(n.p,{children:["\u7b80\u5355 - ",(0,c.jsx)(n.code,{children:'{text: "Simple response"}'}),"\r\n\u6df7\u5408 - ",(0,c.jsx)(n.code,{children:'{files: [{name: "file.txt"}], html: "<div>Custom Element</div>"}'}),"\r\n\u81ea\u5b9a\u4e49\u89d2\u8272 - ",(0,c.jsx)(n.code,{children:'{role: "bob", text: "Message from bob"}'}),"\r\n\u9519\u8bef - ",(0,c.jsx)(n.code,{children:'{error: "Service Error"}'}),"\r\n\u8986\u76d6 - ",(0,c.jsx)(n.code,{children:'{text: "New text", overwrite: true}'})]}),"\n",(0,c.jsx)(n.h3,{id:"websocket",children:(0,c.jsx)(n.code,{children:"Websocket"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\u7c7b\u578b: ",(0,c.jsx)(n.code,{children:"boolean"})," | ",(0,c.jsx)(n.code,{children:"string"})," | ",(0,c.jsx)(n.code,{children:"string[]"})]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["\u8fd9\u7528\u4e8e\u4e0e\u60a8\u7684\u670d\u52a1\u5668\u5efa\u7acb websocket \u8fde\u63a5\u3002\u901a\u8fc7\u5728 connect \u5bf9\u8c61\u4e2d\u5c06 ",(0,c.jsx)(n.code,{children:"websocket"})," \u5c5e\u6027\u5b9a\u4e49\u4e3a ",(0,c.jsx)(n.code,{children:"boolean"})," ",(0,c.jsx)(n.em,{children:"true"})," \u6216\u5b57\u7b26\u4e32\u7c7b\u578b\u7684\u8fde\u63a5\u534f\u8bae\uff08\u6216\u591a\u4e2a\u534f\u8bae\u7684\u5b57\u7b26\u4e32\u6570\u7ec4\uff09\u6765\u542f\u7528\u5b83\u3002\r\n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4ea4\u6362\u7684\u6d88\u606f\u5fc5\u987b\u662f\u5b57\u7b26\u4e32\u5316\u7684 JSON\uff08Stringified JSONs\uff09\uff0c\u5176\u4e2d Deep Chat \u5c06\u4f7f\u7528 Request message \u683c\u5f0f\u53d1\u9001\u5176\u6d88\u606f\uff0c\u800c\u670d\u52a1\u5668\u5fc5\u987b\u4f7f\u7528 Response \u683c\u5f0f\u53d1\u9001\u5176\u6d88\u606f\u3002\u6d88\u606f\u793a\u4f8b\uff1a\r\nDeep Chat \u6d88\u606f\uff1a\r\n",(0,c.jsx)(n.code,{children:'\'{"messages":[{"role":"user","text":"Message from Deep Chat"}]}\''}),"\r\n\u670d\u52a1\u5668\u6d88\u606f\uff1a\r\n",(0,c.jsx)(n.code,{children:'\'{"text":"Message from the server"}\''})]}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-3",children:"\u793a\u4f8b"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"\u793a\u4f8b\u4ee3\u7801"}),"\n",(0,c.jsx)(n.li,{children:"\u5b8c\u6574\u4ee3\u7801"}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-html",children:'<deep-chat connect=\'{"url": "ws://customapi.com", "websocket": true}\'></deep-chat>\n'})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-html",children:'\x3c!-- \u6b64\u793a\u4f8b\u9002\u7528\u4e8e\u539f\u751f JS\uff0c\u5e94\u6839\u636e\u60a8\u7684\u6846\u67b6\u8fdb\u884c\u8c03\u6574\uff08\u8bf7\u53c2\u9605\u793a\u4f8b\uff09 --\x3e\r\n\r\n<deep-chat\r\n  connect=\'{"url": "ws://customapi.com", "websocket": true}\'\r\n  style="border-radius: 8px"\r\n  introMessage=\'{"text": Chat will attempt to establish a websocket connection as soon as the component loads up."}\'\r\n></deep-chat>\n'})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u63d0\u793a"})}),"\n",(0,c.jsxs)(n.p,{children:["Check the ",(0,c.jsx)(n.a,{href:"https://github.com/OvidijusParsiunas/deep-chat/tree/main/example-servers/node/websockets",children:"websocket \u670d\u52a1\u5668\u6a21\u677f"})," \u4ee5\u5e2e\u52a9\u60a8\u5165\u95e8\u3002"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"\u72b6\u6001\u6c14\u6ce1\u793a\u4f8b",children:"\u72b6\u6001\u6c14\u6ce1\u793a\u4f8b"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"\u793a\u4f8b\u4ee3\u7801"}),"\n",(0,c.jsx)(n.li,{children:"\u5b8c\u6574\u4ee3\u7801"}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:'Messages from the server (\u6765\u81ea\u670d\u52a1\u5668\u7684\u6d88\u606f):\r\n1: {text: "Downloading...", overwrite: true}\r\n2: {text: "Loading...", overwrite: true}\r\n3: {text: "Processing...", overwrite: true}\r\n4: {text: "Ready...", overwrite: true}\n'})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:'Component configuration (\u7ec4\u4ef6\u914d\u7f6e):\r\n<deep-chat connect=\'{"url": "ws://customapi.com", "websocket": true}\'></deep-chat>\r\n\r\nMessages from the server (\u6765\u81ea\u670d\u52a1\u5668\u7684\u6d88\u606f):\r\n1: {text: "Downloading...", overwrite: true}\r\n2: {text: "Loading...", overwrite: true}\r\n3: {text: "Processing...", overwrite: true}\r\n4: {text: "Ready...", overwrite: true}\n'})}),"\n",(0,c.jsx)(n.h3,{id:"stream",children:(0,c.jsx)(n.code,{children:"Stream"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\u7c7b\u578b: ",(0,c.jsx)(n.code,{children:"true"})," | ","partialRender?: boolean"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["\u7528\u4e8e\u6d41\u5f0f\u4f20\u8f93\u6765\u81ea\u76ee\u6807\u670d\u52a1\u7684\u54cd\u5e94\u3002\r\n\u901a\u8fc7\u8bbe\u7f6e\u4e3a ",(0,c.jsx)(n.em,{children:"true"})," - \u804a\u5929\u5c06\u6d41\u5f0f\u4f20\u8f93\u6765\u81ea\u670d\u52a1\u5668\u7684\u4f20\u5165 ",(0,c.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Server-sent_events/Using_server-sent_events",children:(0,c.jsx)(n.code,{children:"server-sent events"})}),"\uff08\u670d\u52a1\u5668\u53d1\u9001\u4e8b\u4ef6\uff09\u3002 \u53c2\u89c1 ",(0,c.jsx)(n.a,{href:"https://deepchat.dev/examples/servers",children:(0,c.jsx)(n.code,{children:"\u793a\u4f8b"})})," \u670d\u52a1\u5668\u4ee3\u7801\u3002\r\n",(0,c.jsx)(n.code,{children:"simulation"})," \u901a\u8fc7\u9010\u6e10\u586b\u5145\u6d88\u606f\u6c14\u6ce1\uff0c\u4e3a\u975e\u6d41\u5f0f\u8fde\u63a5\u63d0\u4f9b\u7c7b\u4f3c",(0,c.jsx)(n.strong,{children:"\u6d41\u5f0f\u4f20\u8f93"}),"\u7684\u4f53\u9a8c\u3002\u5c06\u5176\u6307\u5b9a\u4e3a\u4e00\u4e2a\u6570\u5b57\u4ee5\u63a7\u5236\u6bcf\u4e2a\u5355\u8bcd\u51fa\u73b0\u7684\u6beb\u79d2\u95f4\u9694\uff08\u9ed8\u8ba4\u4e3a ",(0,c.jsx)(n.em,{children:"6"}),"\uff09\uff0c\u6216\u8005\u6307\u5b9a\u4e3a\u4e00\u4e2a\u5b57\u7b26\u4e32\u503c\u4f5c\u4e3a ",(0,c.jsx)(n.em,{children:"end-phrase"}),"\uff08\u7ed3\u675f\u77ed\u8bed\uff09\uff0c\u4ee5\u4fbf\u5728\u4f7f\u7528 websocket \u65f6\u505c\u6b62\u586b\u5145\u6d88\u606f\u6c14\u6ce1\u3002\r\n",(0,c.jsx)(n.code,{children:"readable"})," \u7528\u4e8e\u5904\u7406\u6765\u81ea\u5177\u6709 ",(0,c.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream",children:(0,c.jsx)(n.code,{children:"ReadableStream"})})," \u7684\u670d\u52a1\u5668\u7684\u54cd\u5e94\u3002\r\n",(0,c.jsx)(n.code,{children:"partialRender"})," \u9632\u6b62\u6bcf\u6b21\u63a5\u6536\u5230\u65b0\u7684\u6d41\u4e8b\u4ef6\u65f6\u91cd\u65b0\u6e32\u67d3\u6574\u4e2a\u6d88\u606f\u6c14\u6ce1\uff0c\u800c\u662f\u4ec5\u91cd\u65b0\u6e32\u67d3\u5728 ",(0,c.jsx)(n.code,{children:'"\\n\\n"'})," \u8bed\u6cd5\u4e4b\u540e\u521b\u5efa\u7684\u6700\u65b0\u6d88\u606f\u6bb5\u843d\u3002"]}),"\n",(0,c.jsx)(n.h4,{id:"\u6d41\u5f0f\u670d\u52a1\u793a\u4f8b",children:"\u6d41\u5f0f\u670d\u52a1\u793a\u4f8b"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"\u793a\u4f8b\u4ee3\u7801"}),"\n",(0,c.jsx)(n.li,{children:"\u5b8c\u6574\u4ee3\u7801"}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-html",children:"<deep-chat connect='{\"stream\": true}'></deep-chat>\n"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-html",children:'\x3c!-- \u6b64\u793a\u4f8b\u9002\u7528\u4e8e\u539f\u751f JS\uff0c\u5e94\u6839\u636e\u60a8\u7684\u6846\u67b6\u8fdb\u884c\u8c03\u6574\uff08\u8bf7\u53c2\u9605\u793a\u4f8b\uff09 --\x3e\r\n\r\n<deep-chat\r\n  connect=\'{"stream": true}\'\r\n  demo="true"\r\n  style="border-radius: 8px"\r\n  introMessage=\'{"text": The response message bubble will be populated gradually with text events."}\'\r\n></deep-chat>\n'})}),"\n",(0,c.jsx)(n.h4,{id:"\u5e38\u89c4\u670d\u52a1\u793a\u4f8b",children:"\u5e38\u89c4\u670d\u52a1\u793a\u4f8b"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"\u793a\u4f8b\u4ee3\u7801"}),"\n",(0,c.jsx)(n.li,{children:"\u5b8c\u6574\u4ee3\u7801"}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-html",children:'<deep-chat connect=\'{"stream": {"simulation": 6}}\'></deep-chat>\n'})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-html",children:'\x3c!-- \u6b64\u793a\u4f8b\u9002\u7528\u4e8e\u539f\u751f JS\uff0c\u5e94\u6839\u636e\u60a8\u7684\u6846\u67b6\u8fdb\u884c\u8c03\u6574\uff08\u8bf7\u53c2\u9605\u793a\u4f8b\uff09 --\x3e\r\n\r\n<deep-chat\r\n  connect=\'{"stream": {"simulation": 6}}\'\r\n  demo="true"\r\n  style="border-radius: 8px"\r\n  introMessage=\'{"text": The response message bubble will be populated gradually with text events."}\'\r\n></deep-chat>\n'})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u6ce8\u610f"})}),"\n",(0,c.jsxs)(n.p,{children:["\u5f53\u5b9a\u4e49\u4e86 demo \u65f6\uff0c\u53ef\u4ee5\u5728 connect \u4e2d\u5355\u72ec\u4f7f\u7528 ",(0,c.jsx)(n.code,{children:"stream"}),"\u3002"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"handler",children:(0,c.jsx)(n.code,{children:"Handler"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\u7c7b\u578b: (",(0,c.jsx)(n.code,{children:"body: any"}),", ",(0,c.jsx)(n.code,{children:"signals: Signals"}),") => ",(0,c.jsx)(n.code,{children:"void"})]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["\u6b64\u51fd\u6570\u8ba9\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u5b8c\u5168\u63a7\u5236\u4f7f\u7528\u81ea\u5df1\u7684\u4ee3\u7801\u53d1\u51fa\u670d\u52a1\u5668\u8bf7\u6c42\u3002\r\n\u5f53\u7528\u6237\u5c1d\u8bd5\u53d1\u9001\u6d88\u606f\u65f6\u4f1a\u8c03\u7528\u6b64\u51fd\u6570\uff0c\u5b83\u5305\u542b\u4e24\u4e2a\u6838\u5fc3\u53c2\u6570\uff1a\r\n",(0,c.jsx)(n.code,{children:"body"})," \u662f\u4e00\u4e2a\u5305\u542b\u53d1\u51fa\u6d88\u606f\u8be6\u60c5\u7684\u5bf9\u8c61\uff0c\u4f7f\u7528 Request message \u7c7b\u578b\u3002\r\n",(0,c.jsx)(n.code,{children:"signals"})," \u662f\u4e00\u4e2a\u51fd\u6570\u6620\u5c04\uff0c\u7528\u4e8e\u901a\u77e5 Deep Chat \u8bf7\u6c42\u7684\u72b6\u6001\u53ca\u5176\u7ed3\u679c\u3002\u53ef\u7528\u7684\u4fe1\u53f7\u51fd\u6570\u6839\u636e\u60a8\u5efa\u7acb\u7684\u8fde\u63a5\u7c7b\u578b\u800c\u6709\u6240\u4e0d\u540c\u3002\u8bf7\u53c2\u89c1\u4e0b\u9762\u7684\u793a\u4f8b\u3002"]}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://youtu.be/orRVFA5AWfU",children:"\u89c6\u9891\u6f14\u793a"})}),"\n",(0,c.jsx)(n.h4,{id:"\u793a\u4f8b-4",children:"\u793a\u4f8b"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"\u57fa\u7840 (Basic)"}),"\n",(0,c.jsx)(n.li,{children:"\u6d41\u5f0f (Stream)"}),"\n",(0,c.jsx)(n.li,{children:"Websocket"}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"chatElementRef.connect = {\r\n  handler: (body, signals) => {\r\n    try {\r\n      fetch('custom-url').then((response) => {\r\n        signals.onResponse({text: 'Handler response'}); // \u663e\u793a\u54cd\u5e94\u6587\u672c\u6d88\u606f\r\n      });\r\n    } catch (e) {\r\n      signals.onResponse({error: 'Error'}); // \u663e\u793a\u9519\u8bef\u6d88\u606f\r\n    }\r\n  },\r\n};\n"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"chatElementRef.stream = true;\r\nchatElementRef.connect = {\r\n  handler: (body, signals) => {\r\n    try {\r\n      // \u8fd9\u662f\u7528\u4e8e\u521b\u5efa\u6d41\u7684 \u4f2a\u4ee3\u7801\r\n      fetchEventSource('custom-url', {\r\n        async onopen(response) {\r\n          if (response.ok) {\r\n            signals.onOpen(); // \u505c\u6b62\u52a0\u8f7d\u6c14\u6ce1\r\n          } else {\r\n            signals.onResponse({error: 'error'}); // \u663e\u793a\u9519\u8bef\u6d88\u606f\r\n          }\r\n        },\r\n        onmessage(message) {\r\n          signals.onResponse({text: message}); // \u6dfb\u52a0\u6587\u672c\u5230\u6d88\u606f\u6c14\u6ce1\u4e2d\r\n        },\r\n        onerror(message) {\r\n          signals.onResponse({error: message}); // \u663e\u793a\u9519\u8bef\u6d88\u606f\r\n        },\r\n        onclose() {\r\n          signals.onClose(); // \u505c\u6b62\u6309\u94ae\u5c06\u53d8\u56de\u63d0\u4ea4\u6309\u94ae\r\n        },\r\n      });\r\n      // \u5f53\u7528\u6237\u70b9\u51fb\u505c\u6b62\u6309\u94ae\u65f6\u89e6\u53d1\r\n      signals.stopClicked.listener = () => {\r\n        // \u505c\u6b62\u6d41\u7684\u903b\u8f91\uff0c\u4f8b\u5982\u521b\u5efa abortController\r\n      };\r\n    } catch (e) {\r\n      signals.onResponse({error: 'error'}); // \u663e\u793a\u9519\u8bef\u6d88\u606f\r\n    }\r\n  },\r\n};\n"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-javascript",children:"// \u6b64 handler \u5728\u7ec4\u4ef6\u52a0\u8f7d\u65f6\u8c03\u7528\r\nchatElementRef.connect = {\r\n  websocket: true,\r\n  handler: (_, signals) => {\r\n    try {\r\n      const websocket = new WebSocket('custom-url');\r\n      websocket.onopen = () => {\r\n        signals.onOpen(); // \u5141\u8bb8\u7528\u6237\u53d1\u9001\u6d88\u606f\r\n      };\r\n      websocket.onmessage = (message) => {\r\n        const response = JSON.parse(message.data);\r\n        signals.onResponse(response); // \u663e\u793a\u6765\u81ea\u670d\u52a1\u5668\u7684\u6587\u672c\u6d88\u606f\r\n      };\r\n      websocket.onclose = () => {\r\n        signals.onClose(); // \u505c\u6b62\u7528\u6237\u53d1\u9001\u6d88\u606f\r\n      };\r\n      websocket.onerror = () => {\r\n        // 'Connection error' \u662f\u4e00\u4e2a\u7279\u6b8a\u5b57\u7b26\u4e32\uff0c\u4e5f\u4f1a\u663e\u793a\u5728 Deep Chat \u4e2d\r\n        signals.onResponse({error: 'Connection error'});\r\n      };\r\n      // \u5f53\u7528\u6237\u53d1\u9001\u6d88\u606f\u65f6\u89e6\u53d1\r\n      signals.newUserMessage.listener = (body) => {\r\n        websocket.send(JSON.stringify(body));\r\n      };\r\n    } catch (e) {\r\n      signals.onResponse({error: 'error'}); // \u663e\u793a\u9519\u8bef\u6d88\u606f\r\n      signals.onClose(); // \u505c\u6b62\u7528\u6237\u53d1\u9001\u6d88\u606f\r\n    }\r\n  },\r\n};\n"})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"\u4fe1\u606f"})}),"\n",(0,c.jsxs)(n.p,{children:["\u9519\u8bef\u5904\u7406\u5fc5\u987b\u5728 ",(0,c.jsx)(n.code,{children:"handler"})," \u51fd\u6570\u5185\u5b8c\u6210\u3002"]}),"\n"]}),"\n",(0,c.jsx)(n.h4,{id:"signals",children:(0,c.jsx)(n.code,{children:"Signals"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{children:"\u7c7b\u578b: {\r\n    \xa0\xa0\xa0\xa0[`onResponse: (response: Response) => Promise<void>`],\r\n    \xa0\xa0\xa0\xa0`onOpen: () => void`,\r\n    \xa0\xa0\xa0\xa0`onClose: () => void`,\r\n    \xa0\xa0\xa0\xa0`stopClicked: {listener: () => void}`,\r\n    \xa0\xa0\xa0\xa0`newUserMessage: {listener: (body: any) => void}`\r\n    }\r\n\n"})}),"\n",(0,c.jsxs)(n.p,{children:["\u5305\u542b\u7528\u4e8e\u901a\u77e5 Deep Chat \u7ec4\u4ef6\u5f53\u524d\u8bf7\u6c42\u72b6\u6001\u7684\u51fd\u6570\u7684\u5bf9\u8c61\u3002\r\n",(0,c.jsx)(n.code,{children:"stopClicked"})," \u548c ",(0,c.jsx)(n.code,{children:"newUserMessage"})," \u51fd\u6570\u7531 Deep Chat \u672c\u8eab\u89e6\u53d1\uff0c\u5e76\u5305\u542b ",(0,c.jsx)(n.code,{children:"listener"})," \u5c5e\u6027\uff0c\u53ef\u4ee5\u4e3a\u5176\u5206\u914d\u81ea\u5b9a\u4e49\u51fd\u6570\u4ee5\u76d1\u542c\u5b83\u4eec\u4f55\u65f6\u88ab\u8c03\u7528\uff08\u8bf7\u53c2\u89c1\u4e0a\u9762\u7684\u793a\u4f8b\uff09\u3002"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(a,{...e})}):a(e)}},54213:(e,n,r)=>{r.d(n,{R:()=>d,x:()=>t});var s=r(36672);const c={},l=s.createContext(c);function d(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:d(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);