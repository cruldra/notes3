"use strict";(self.webpackChunknotes_3=self.webpackChunknotes_3||[]).push([[81726],{2342:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>d,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"AI/\u63d0\u793a\u8bcd\u5de5\u7a0b/DSPy/\u5b66\u4e60/\u7f16\u7a0b/\u9002\u914d\u5668","title":"\u9002\u914d\u5668","description":"\u4ec0\u4e48\u662f\u9002\u914d\u5668\uff1f","source":"@site/docs/AI/\u63d0\u793a\u8bcd\u5de5\u7a0b/DSPy/\u5b66\u4e60/\u7f16\u7a0b/\u9002\u914d\u5668.md","sourceDirName":"AI/\u63d0\u793a\u8bcd\u5de5\u7a0b/DSPy/\u5b66\u4e60/\u7f16\u7a0b","slug":"/AI/\u63d0\u793a\u8bcd\u5de5\u7a0b/DSPy/\u5b66\u4e60/\u7f16\u7a0b/\u9002\u914d\u5668","permalink":"/notes3/docs/AI/\u63d0\u793a\u8bcd\u5de5\u7a0b/DSPy/\u5b66\u4e60/\u7f16\u7a0b/\u9002\u914d\u5668","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/AI/\u63d0\u793a\u8bcd\u5de5\u7a0b/DSPy/\u5b66\u4e60/\u7f16\u7a0b/\u9002\u914d\u5668.md","tags":[],"version":"current","frontMatter":{},"sidebar":"ai","previous":{"title":"\u65ad\u8a00","permalink":"/notes3/docs/AI/\u63d0\u793a\u8bcd\u5de5\u7a0b/DSPy/\u5b66\u4e60/\u7f16\u7a0b/\u65ad\u8a00"},"next":{"title":"\u6982\u89c8","permalink":"/notes3/docs/AI/\u63d0\u793a\u8bcd\u5de5\u7a0b/DSPy/\u5b66\u4e60/\u8bc4\u4f30/\u6982\u89c8"}}');var i=s(23420),r=s(54213);const d={},c=void 0,l={},o=[{value:"\u4ec0\u4e48\u662f\u9002\u914d\u5668\uff1f",id:"\u4ec0\u4e48\u662f\u9002\u914d\u5668",level:2},{value:"\u914d\u7f6e\u9002\u914d\u5668",id:"\u914d\u7f6e\u9002\u914d\u5668",level:2},{value:"\u9002\u914d\u5668\u5728\u7cfb\u7edf\u4e2d\u7684\u4f4d\u7f6e",id:"\u9002\u914d\u5668\u5728\u7cfb\u7edf\u4e2d\u7684\u4f4d\u7f6e",level:2},{value:"\u9002\u914d\u5668\u7c7b\u578b",id:"\u9002\u914d\u5668\u7c7b\u578b",level:2},{value:"ChatAdapter",id:"chatadapter",level:3},{value:"\u683c\u5f0f\u7ed3\u6784",id:"\u683c\u5f0f\u7ed3\u6784",level:4},{value:"\u4f55\u65f6\u4f7f\u7528 ChatAdapter",id:"\u4f55\u65f6\u4f7f\u7528-chatadapter",level:4},{value:"\u4f55\u65f6\u4e0d\u4f7f\u7528 ChatAdapter",id:"\u4f55\u65f6\u4e0d\u4f7f\u7528-chatadapter",level:4},{value:"JSONAdapter",id:"jsonadapter",level:3},{value:"\u683c\u5f0f\u7ed3\u6784",id:"\u683c\u5f0f\u7ed3\u6784-1",level:4},{value:"\u4f55\u65f6\u4f7f\u7528 JSONAdapter",id:"\u4f55\u65f6\u4f7f\u7528-jsonadapter",level:4},{value:"\u4f55\u65f6\u4e0d\u4f7f\u7528 JSONAdapter",id:"\u4f55\u65f6\u4e0d\u4f7f\u7528-jsonadapter",level:4},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function a(e){const n={code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"\u4ec0\u4e48\u662f\u9002\u914d\u5668",children:"\u4ec0\u4e48\u662f\u9002\u914d\u5668\uff1f"}),"\n",(0,i.jsxs)(n.p,{children:["\u9002\u914d\u5668\u662f ",(0,i.jsx)(n.code,{children:"dspy.Predict"})," \u548c\u5b9e\u9645\u8bed\u8a00\u6a21\u578b (LM) \u4e4b\u95f4\u7684\u6865\u6881\u3002\u5f53\u4f60\u8c03\u7528\u4e00\u4e2a DSPy \u6a21\u5757\u65f6\uff0c\u9002\u914d\u5668\u83b7\u53d6\u4f60\u7684\u7b7e\u540d\u3001\u7528\u6237\u8f93\u5165\u548c\u5176\u4ed6\u5c5e\u6027\uff08\u5982 ",(0,i.jsx)(n.code,{children:"demos"}),"\uff0c\u5373\u5c11\u6837\u672c\u793a\u4f8b\uff09\uff0c\u5e76\u5c06\u5b83\u4eec\u8f6c\u6362\u4e3a\u53d1\u9001\u7ed9 LM \u7684\u591a\u8f6e\u6d88\u606f\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u9002\u914d\u5668\u7cfb\u7edf\u8d1f\u8d23\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5c06 DSPy \u7b7e\u540d\u8f6c\u6362\u4e3a\u5b9a\u4e49\u4efb\u52a1\u548c\u8bf7\u6c42/\u54cd\u5e94\u7ed3\u6784\u7684\u7cfb\u7edf\u6d88\u606f\u3002"}),"\n",(0,i.jsx)(n.li,{children:"\u6839\u636e DSPy \u7b7e\u540d\u4e2d\u6982\u8ff0\u7684\u8bf7\u6c42\u7ed3\u6784\u683c\u5f0f\u5316\u8f93\u5165\u6570\u636e\u3002"}),"\n",(0,i.jsxs)(n.li,{children:["\u5c06 LM \u54cd\u5e94\u89e3\u6790\u56de\u7ed3\u6784\u5316\u7684 DSPy \u8f93\u51fa\uff0c\u4f8b\u5982 ",(0,i.jsx)(n.code,{children:"dspy.Prediction"})," \u5b9e\u4f8b\u3002"]}),"\n",(0,i.jsx)(n.li,{children:"\u7ba1\u7406\u5bf9\u8bdd\u5386\u53f2\u548c\u51fd\u6570\u8c03\u7528\u3002"}),"\n",(0,i.jsxs)(n.li,{children:["\u5c06\u9884\u6784\u5efa\u7684 DSPy \u7c7b\u578b\u8f6c\u6362\u4e3a LM \u63d0\u793a\u6d88\u606f\uff0c\u4f8b\u5982 ",(0,i.jsx)(n.code,{children:"dspy.Tool"}),"\u3001",(0,i.jsx)(n.code,{children:"dspy.Image"})," \u7b49\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u914d\u7f6e\u9002\u914d\u5668",children:"\u914d\u7f6e\u9002\u914d\u5668"}),"\n",(0,i.jsxs)(n.p,{children:["\u4f60\u53ef\u4ee5\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"dspy.configure(adapter=...)"})," \u4e3a\u6574\u4e2a Python \u8fdb\u7a0b\u9009\u62e9\u9002\u914d\u5668\uff0c\u6216\u8005\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"with dspy.context(adapter=...):"})," \u4ec5\u5f71\u54cd\u7279\u5b9a\u7684\u547d\u540d\u7a7a\u95f4\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5982\u679c\u5728 DSPy \u5de5\u4f5c\u6d41\u4e2d\u672a\u6307\u5b9a\u9002\u914d\u5668\uff0c\u6bcf\u4e2a ",(0,i.jsx)(n.code,{children:"dspy.Predict.__call__"})," \u9ed8\u8ba4\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"dspy.ChatAdapter"}),"\u3002\u56e0\u6b64\uff0c\u4e0b\u9762\u7684\u4e24\u4e2a\u4ee3\u7801\u7247\u6bb5\u662f\u7b49\u6548\u7684\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import dspy\n\ndspy.configure(lm=dspy.LM("openai/gpt-4o-mini"))\n\npredict = dspy.Predict("question -> answer")\nresult = predict(question="What is the capital of France?")\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import dspy\n\ndspy.configure(\n    lm=dspy.LM("openai/gpt-4o-mini"),\n    adapter=dspy.ChatAdapter(),  # \u8fd9\u662f\u9ed8\u8ba4\u503c\n)\n\npredict = dspy.Predict("question -> answer")\nresult = predict(question="What is the capital of France?")\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u9002\u914d\u5668\u5728\u7cfb\u7edf\u4e2d\u7684\u4f4d\u7f6e",children:"\u9002\u914d\u5668\u5728\u7cfb\u7edf\u4e2d\u7684\u4f4d\u7f6e"}),"\n",(0,i.jsx)(n.p,{children:"\u6d41\u7a0b\u5982\u4e0b\uff1a"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\u7528\u6237\u8c03\u7528\u4ed6\u4eec\u7684 DSPy \u667a\u80fd\u4f53\uff0c\u901a\u5e38\u662f\u4e00\u4e2a\u5e26\u6709\u8f93\u5165\u7684 ",(0,i.jsx)(n.code,{children:"dspy.Module"}),"\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:["\u8c03\u7528\u5185\u90e8\u7684 ",(0,i.jsx)(n.code,{children:"dspy.Predict"})," \u4ee5\u83b7\u53d6 LM \u54cd\u5e94\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dspy.Predict"})," \u8c03\u7528 ",(0,i.jsx)(n.strong,{children:"Adapter.format()"}),"\uff0c\u5c06\u5176\u7b7e\u540d\u3001\u8f93\u5165\u548c\u6f14\u793a\u8f6c\u6362\u4e3a\u53d1\u9001\u7ed9 ",(0,i.jsx)(n.code,{children:"dspy.LM"})," \u7684\u591a\u8f6e\u6d88\u606f\u3002",(0,i.jsx)(n.code,{children:"dspy.LM"})," \u662f ",(0,i.jsx)(n.code,{children:"litellm"})," \u7684\u4e00\u4e2a\u7626\u5305\u88c5\u5668\uff0c\u7528\u4e8e\u4e0e LM \u7aef\u70b9\u901a\u4fe1\u3002"]}),"\n",(0,i.jsx)(n.li,{children:"LM \u63a5\u6536\u6d88\u606f\u5e76\u751f\u6210\u54cd\u5e94\u3002"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Adapter.parse()"})," \u5c06 LM \u54cd\u5e94\u8f6c\u6362\u4e3a\u7ed3\u6784\u5316\u7684 DSPy \u8f93\u51fa\uff0c\u5982\u7b7e\u540d\u4e2d\u6240\u6307\u5b9a\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dspy.Predict"})," \u7684\u8c03\u7528\u8005\u63a5\u6536\u89e3\u6790\u540e\u7684\u8f93\u51fa\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u4f60\u53ef\u4ee5\u663e\u5f0f\u8c03\u7528 ",(0,i.jsx)(n.code,{children:"Adapter.format()"})," \u6765\u67e5\u770b\u53d1\u9001\u7ed9 LM \u7684\u6d88\u606f\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# Simplified flow example\nsignature = dspy.Signature("question -> answer")\ninputs = {"question": "What is 2+2?"}\ndemos = [{"question": "What is 1+1?", "answer": "2"}]\n\nadapter = dspy.ChatAdapter()\nprint(adapter.format(signature, demos, inputs))\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u8f93\u51fa\u5e94\u7c7b\u4f3c\u4e8e\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"{'role': 'system', 'content': 'Your input fields are:\\n1. `question` (str):\\nYour output fields are:\\n1. `answer` (str):\\nAll interactions will be structured in the following way, with the appropriate values filled in.\\n\\n[[ ## question ## ]]\\n{question}\\n\\n[[ ## answer ## ]]\\n{answer}\\n\\n[[ ## completed ## ]]\\nIn adhering to this structure, your objective is: \n        Given the fields `question`, produce the fields `answer`.`}\n{'role': 'user', 'content': '[[ ## question ## ]]\\nWhat is 1+1?'}\n{'role': 'assistant', 'content': '[[ ## answer ## ]]\\n2\\n\\n[[ ## completed ## ]]\\n'}\n{'role': 'user', 'content': '[[ ## question ## ]]\\nWhat is 2+2?\\n\\nRespond with the corresponding output fields, starting with the field `[[ ## answer ## ]]`, and then ending with the marker for `[[ ## completed ## ]]`.'}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528 ",(0,i.jsx)(n.code,{children:"adapter.format_system_message(signature)"})," \u4ec5\u83b7\u53d6\u7cfb\u7edf\u6d88\u606f\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import dspy\n\nsignature = dspy.Signature("question -> answer")\nsystem_message = dspy.ChatAdapter().format_system_message(signature)\nprint(system_message)\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u8f93\u51fa\u5e94\u7c7b\u4f3c\u4e8e\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Your input fields are:\n1. `question` (str):\nYour output fields are:\n1. `answer` (str):\nAll interactions will be structured in the following way, with the appropriate values filled in.\n\n[[ ## question ## ]]\n{question}\n[[ ## answer ## ]]\n{answer}\n[[ ## completed ## ]]\nIn adhering to this structure, your objective is: \n        Given the fields `question`, produce the fields `answer`.\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u9002\u914d\u5668\u7c7b\u578b",children:"\u9002\u914d\u5668\u7c7b\u578b"}),"\n",(0,i.jsx)(n.p,{children:"DSPy \u63d0\u4f9b\u4e86\u51e0\u79cd\u9002\u914d\u5668\u7c7b\u578b\uff0c\u6bcf\u79cd\u90fd\u9488\u5bf9\u7279\u5b9a\u7684\u7528\u4f8b\u91cf\u8eab\u5b9a\u5236\uff1a"}),"\n",(0,i.jsx)(n.h3,{id:"chatadapter",children:"ChatAdapter"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"ChatAdapter"})," \u662f\u9ed8\u8ba4\u9002\u914d\u5668\uff0c\u9002\u7528\u4e8e\u6240\u6709\u8bed\u8a00\u6a21\u578b\u3002\u5b83\u4f7f\u7528\u57fa\u4e8e\u5b57\u6bb5\u7684\u683c\u5f0f\uff0c\u5e26\u6709\u7279\u6b8a\u6807\u8bb0\u3002"]}),"\n",(0,i.jsx)(n.h4,{id:"\u683c\u5f0f\u7ed3\u6784",children:"\u683c\u5f0f\u7ed3\u6784"}),"\n",(0,i.jsxs)(n.p,{children:["ChatAdapter \u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"[[ ## field_name ## ]]"})," \u6807\u8bb0\u6765\u5212\u5206\u5b57\u6bb5\u3002\u5bf9\u4e8e\u975e\u539f\u59cb Python \u7c7b\u578b\u7684\u5b57\u6bb5\uff0c\u5b83\u5305\u542b\u7c7b\u578b\u7684 JSON \u6a21\u5f0f\u3002\u4e0b\u9762\uff0c\u6211\u4eec\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"dspy.inspect_history()"})," \u6e05\u695a\u5730\u663e\u793a ",(0,i.jsx)(n.code,{children:"dspy.ChatAdapter"})," \u683c\u5f0f\u5316\u7684\u6d88\u606f\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import dspy\nimport pydantic\n\ndspy.configure(lm=dspy.LM("openai/gpt-4o-mini"), adapter=dspy.ChatAdapter())\n\n\nclass ScienceNews(pydantic.BaseModel):\n    text: str\n    scientists_involved: list[str]\n\n\nclass NewsQA(dspy.Signature):\n    """Get news about the given science field"""\n\n    science_field: str = dspy.InputField()\n    year: int = dspy.InputField()\n    num_of_outputs: int = dspy.InputField()\n    news: list[ScienceNews] = dspy.OutputField(desc="science news")\n\n\npredict = dspy.Predict(NewsQA)\npredict(science_field="Computer Theory", year=2022, num_of_outputs=1)\ndspy.inspect_history()\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u8f93\u51fa\u5982\u4e0b\u6240\u793a\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'[2025-08-15T22:24:29.378666]\n\nSystem message:\n\nYour input fields are:\n1. `science_field` (str):\n2. `year` (int):\n3. `num_of_outputs` (int):\nYour output fields are:\n1. `news` (list[ScienceNews]): science news\nAll interactions will be structured in the following way, with the appropriate values filled in.\n\n[[ ## science_field ## ]]\n{science_field}\n\n[[ ## year ## ]]\n{year}\n\n[[ ## num_of_outputs ## ]]\n{num_of_outputs}\n\n[[ ## news ## ]]\n{news}        # note: the value you produce must adhere to the JSON schema: {"type": "array", "$defs": {"ScienceNews": {"type": "object", "properties": {"scientists_involved": {"type": "array", "items": {"type": "string"}, "title": "Scientists Involved"}, "text": {"type": "string", "title": "Text"}}, "required": ["text", "scientists_involved"], "title": "ScienceNews"}}, "items": {"$ref": "#/$defs/ScienceNews"}}\n\n[[ ## completed ## ]]\nIn adhering to this structure, your objective is:\n        Get news about the given science field\n\n\nUser message:\n\n[[ ## science_field ## ]]\nComputer Theory\n\n[[ ## year ## ]]\n2022\n\n[[ ## num_of_outputs ## ]]\n1\n\nRespond with the corresponding output fields, starting with the field `[[ ## news ## ]]` (must be formatted as a valid Python list[ScienceNews]), and then ending with the marker for `[[ ## completed ## ]]`.\n\n\nResponse:\n\n[[ ## news ## ]]\n[\n    {\n        "scientists_involved": ["John Doe", "Jane Smith"],\n        "text": "In 2022, researchers made significant advancements in quantum computing algorithms, demonstrating their potential to solve complex problems faster than classical computers. This breakthrough could revolutionize fields such as cryptography and optimization."\n    }\n]\n\n[[ ## completed ## ]]\n'})}),"\n",(0,i.jsx)(n.p,{children:'!!! info "\u7ec3\u4e60\uff1a\u5728\u6253\u5370\u7684 LM \u5386\u53f2\u8bb0\u5f55\u4e2d\u5b9a\u4f4d\u7b7e\u540d\u4fe1\u606f"'}),"\n",(0,i.jsx)(n.p,{children:"\u5c1d\u8bd5\u8c03\u6574\u7b7e\u540d\uff0c\u5e76\u89c2\u5bdf\u66f4\u6539\u5982\u4f55\u53cd\u6620\u5728\u6253\u5370\u7684 LM \u6d88\u606f\u4e2d\u3002"}),"\n",(0,i.jsxs)(n.p,{children:["\u6bcf\u4e2a\u5b57\u6bb5\u524d\u9762\u90fd\u6709\u4e00\u4e2a\u6807\u8bb0 ",(0,i.jsx)(n.code,{children:"[[ ## field_name ## ]]"}),"\u3002\u5982\u679c\u8f93\u51fa\u5b57\u6bb5\u5177\u6709\u975e\u539f\u59cb\u7c7b\u578b\uff0c\u8bf4\u660e\u4e2d\u5c06\u5305\u542b\u7c7b\u578b\u7684 JSON \u6a21\u5f0f\uff0c\u5e76\u4e14\u8f93\u51fa\u5c06\u76f8\u5e94\u5730\u683c\u5f0f\u5316\u3002\u7531\u4e8e\u8f93\u51fa\u5b57\u6bb5\u662f\u6309\u7167 ChatAdapter \u5b9a\u4e49\u7684\u7ed3\u6784\u7ec4\u7ec7\u7684\uff0c\u56e0\u6b64\u53ef\u4ee5\u81ea\u52a8\u5c06\u5176\u89e3\u6790\u4e3a\u7ed3\u6784\u5316\u6570\u636e\u3002"]}),"\n",(0,i.jsx)(n.h4,{id:"\u4f55\u65f6\u4f7f\u7528-chatadapter",children:"\u4f55\u65f6\u4f7f\u7528 ChatAdapter"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"ChatAdapter"})," \u63d0\u4f9b\u4ee5\u4e0b\u4f18\u52bf\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u901a\u7528\u517c\u5bb9\u6027"}),"\uff1a\u9002\u7528\u4e8e\u6240\u6709\u8bed\u8a00\u6a21\u578b\uff0c\u5c3d\u7ba1\u8f83\u5c0f\u7684\u6a21\u578b\u751f\u6210\u7684\u54cd\u5e94\u53ef\u80fd\u4e0d\u7b26\u5408\u8981\u6c42\u7684\u683c\u5f0f\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u56de\u9000\u4fdd\u62a4"}),"\uff1a\u5982\u679c ",(0,i.jsx)(n.code,{children:"ChatAdapter"})," \u5931\u8d25\uff0c\u5b83\u4f1a\u81ea\u52a8\u91cd\u8bd5 ",(0,i.jsx)(n.code,{children:"JSONAdapter"}),"\u3002"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["\u603b\u7684\u6765\u8bf4\uff0c\u5982\u679c\u4f60\u6ca1\u6709\u7279\u6b8a\u8981\u6c42\uff0c",(0,i.jsx)(n.code,{children:"ChatAdapter"})," \u662f\u4e00\u4e2a\u53ef\u9760\u7684\u9009\u62e9\u3002"]}),"\n",(0,i.jsx)(n.h4,{id:"\u4f55\u65f6\u4e0d\u4f7f\u7528-chatadapter",children:"\u4f55\u65f6\u4e0d\u4f7f\u7528 ChatAdapter"}),"\n",(0,i.jsxs)(n.p,{children:["\u5982\u679c\u4f60\u5c5e\u4e8e\u4ee5\u4e0b\u60c5\u51b5\uff0c\u8bf7\u907f\u514d\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"ChatAdapter"}),"\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u5ef6\u8fdf\u654f\u611f"}),"\uff1a\u4e0e\u5176\u4ed6\u9002\u914d\u5668\u76f8\u6bd4\uff0c",(0,i.jsx)(n.code,{children:"ChatAdapter"})," \u5305\u542b\u66f4\u591a\u7684\u6837\u677f\u8f93\u51fa\u6807\u8bb0\uff0c\u56e0\u6b64\u5982\u679c\u4f60\u6b63\u5728\u6784\u5efa\u5bf9\u5ef6\u8fdf\u654f\u611f\u7684\u7cfb\u7edf\uff0c\u8bf7\u8003\u8651\u4f7f\u7528\u5176\u4ed6\u9002\u914d\u5668\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"jsonadapter",children:"JSONAdapter"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"JSONAdapter"})," \u63d0\u793a LM \u8fd4\u56de\u5305\u542b\u7b7e\u540d\u4e2d\u6307\u5b9a\u7684\u6240\u6709\u8f93\u51fa\u5b57\u6bb5\u7684 JSON \u6570\u636e\u3002\u5bf9\u4e8e\u652f\u6301\u901a\u8fc7 ",(0,i.jsx)(n.code,{children:"response_format"})," \u53c2\u6570\u8fdb\u884c\u7ed3\u6784\u5316\u8f93\u51fa\u7684\u6a21\u578b\uff0c\u5b83\u975e\u5e38\u6709\u6548\uff0c\u5229\u7528\u672c\u673a JSON \u751f\u6210\u529f\u80fd\u5b9e\u73b0\u66f4\u53ef\u9760\u7684\u89e3\u6790\u3002"]}),"\n",(0,i.jsx)(n.h4,{id:"\u683c\u5f0f\u7ed3\u6784-1",children:"\u683c\u5f0f\u7ed3\u6784"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"JSONAdapter"})," \u683c\u5f0f\u5316\u7684\u63d0\u793a\u7684\u8f93\u5165\u90e8\u5206\u7c7b\u4f3c\u4e8e ",(0,i.jsx)(n.code,{children:"ChatAdapter"}),"\uff0c\u4f46\u8f93\u51fa\u90e8\u5206\u6709\u6240\u4e0d\u540c\uff0c\u5982\u4e0b\u6240\u793a\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import dspy\nimport pydantic\n\ndspy.configure(lm=dspy.LM("openai/gpt-4o-mini"), adapter=dspy.JSONAdapter())\n\n\nclass ScienceNews(pydantic.BaseModel):\n    text: str\n    scientists_involved: list[str]\n\n\nclass NewsQA(dspy.Signature):\n    """Get news about the given science field"""\n\n    science_field: str = dspy.InputField()\n    year: int = dspy.InputField()\n    num_of_outputs: int = dspy.InputField()\n    news: list[ScienceNews] = dspy.OutputField(desc="science news")\n\n\npredict = dspy.Predict(NewsQA)\npredict(science_field="Computer Theory", year=2022, num_of_outputs=1)\ndspy.inspect_history()\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'System message:\n\nYour input fields are:\n1. `science_field` (str):\n2. `year` (int):\n3. `num_of_outputs` (int):\nYour output fields are:\n1. `news` (list[ScienceNews]): science news\nAll interactions will be structured in the following way, with the appropriate values filled in.\n\nInputs will have the following structure:\n\n[[ ## science_field ## ]]\n{science_field}\n\n[[ ## year ## ]]\n{year}\n\n[[ ## num_of_outputs ## ]]\n{num_of_outputs}\n\nOutputs will be a JSON object with the following fields.\n\n{\n  "news": "{news}        # note: the value you produce must adhere to the JSON schema: {\\"type\\": \\"array\\", \\"$defs\\": {\\"ScienceNews\\": {\\"type\\": \\"object\\", \\"properties\\": {\\"scientists_involved\\": {\\"type\\": \\"array\\", \\"items\\": {\\"type\\": \\"string\\"}, \\"title\\": \\"Scientists Involved\\"}, \\"text\\": {\\"type\\": \\"string\\", \\"title\\": \\"Text\\"}}, \\"required\\": [\\"text\\", \\"scientists_involved\\"], \\"title\\": \\"ScienceNews\\"}}, \\"items\\": {\\"$ref\\": \\"#/$defs/ScienceNews\\"}}"\n}\nIn adhering to this structure, your objective is:\n        Get news about the given science field\n\n\nUser message:\n\n[[ ## science_field ## ]]\nComputer Theory\n\n[[ ## year ## ]]\n2022\n\n[[ ## num_of_outputs ## ]]\n1\n\nRespond with a JSON object in the following order of fields: `news` (must be formatted as a valid Python list[ScienceNews]).\n\n\nResponse:\n\n{\n  "news": [\n    {\n      "text": "In 2022, researchers made significant advancements in quantum computing algorithms, demonstrating that quantum systems can outperform classical computers in specific tasks. This breakthrough could revolutionize fields such as cryptography and complex system simulations.",\n      "scientists_involved": [\n        "Dr. Alice Smith",\n        "Dr. Bob Johnson",\n        "Dr. Carol Lee"\n      ]\n    }\n  ]\n}\n'})}),"\n",(0,i.jsx)(n.h4,{id:"\u4f55\u65f6\u4f7f\u7528-jsonadapter",children:"\u4f55\u65f6\u4f7f\u7528 JSONAdapter"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"JSONAdapter"})," \u64c5\u957f\u4e8e\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u7ed3\u6784\u5316\u8f93\u51fa\u652f\u6301"}),"\uff1a\u5f53\u6a21\u578b\u652f\u6301 ",(0,i.jsx)(n.code,{children:"response_format"})," \u53c2\u6570\u65f6\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u4f4e\u5ef6\u8fdf"}),"\uff1aLM \u54cd\u5e94\u4e2d\u7684\u6837\u677f\u6700\u5c11\uff0c\u4ece\u800c\u4ea7\u751f\u66f4\u5feb\u7684\u54cd\u5e94\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"\u4f55\u65f6\u4e0d\u4f7f\u7528-jsonadapter",children:"\u4f55\u65f6\u4e0d\u4f7f\u7528 JSONAdapter"}),"\n",(0,i.jsxs)(n.p,{children:["\u5982\u679c\u4f60\u5c5e\u4e8e\u4ee5\u4e0b\u60c5\u51b5\uff0c\u8bf7\u907f\u514d\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"JSONAdapter"}),"\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u4f7f\u7528\u4e0d\u652f\u6301\u539f\u751f\u7ed3\u6784\u5316\u8f93\u51fa\u7684\u6a21\u578b\uff0c\u4f8b\u5982\u5728 Ollama \u4e0a\u6258\u7ba1\u7684\u5c0f\u578b\u5f00\u6e90\u6a21\u578b\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,i.jsx)(n.p,{children:"\u9002\u914d\u5668\u662f DSPy \u7684\u91cd\u8981\u7ec4\u6210\u90e8\u5206\uff0c\u5b83\u5f25\u5408\u4e86\u7ed3\u6784\u5316 DSPy \u7b7e\u540d\u548c\u8bed\u8a00\u6a21\u578b API \u4e4b\u95f4\u7684\u5dee\u8ddd\u3002\n\u4e86\u89e3\u4f55\u65f6\u4ee5\u53ca\u5982\u4f55\u4f7f\u7528\u4e0d\u540c\u7684\u9002\u914d\u5668\u5c06\u5e2e\u52a9\u4f60\u6784\u5efa\u66f4\u53ef\u9760\u3001\u66f4\u9ad8\u6548\u7684 DSPy \u7a0b\u5e8f\u3002"})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},54213:(e,n,s)=>{s.d(n,{R:()=>d,x:()=>c});var t=s(36672);const i={},r=t.createContext(i);function d(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);