# Rust æ¨¡å—ç³»ç»Ÿè¯¦è§£

## ğŸ“š ä»€ä¹ˆæ˜¯æ¨¡å—ï¼Ÿ

**æ¨¡å—**ï¼ˆModuleï¼‰æ˜¯ Rust ä¸­ç»„ç»‡ä»£ç çš„åŸºæœ¬å•ä½ï¼Œç±»ä¼¼äºå…¶ä»–è¯­è¨€ä¸­çš„å‘½åç©ºé—´æˆ–åŒ…ã€‚

### æ¨¡å—çš„ä½œç”¨

- âœ… **ç»„ç»‡ä»£ç ** - å°†ç›¸å…³åŠŸèƒ½åˆ†ç»„
- âœ… **æ§åˆ¶å¯è§æ€§** - å†³å®šå“ªäº›ä»£ç æ˜¯å…¬å¼€çš„
- âœ… **é¿å…å‘½åå†²çª** - ä¸åŒæ¨¡å—å¯ä»¥æœ‰åŒåå‡½æ•°
- âœ… **ä»£ç å¤ç”¨** - æ¨¡å—å¯ä»¥è¢«å…¶ä»–æ¨¡å—å¼•ç”¨

---

## ğŸ¯ æ¨¡å—çš„ä¸‰ç§ç»„ç»‡æ–¹å¼

### 1ï¸âƒ£ å†…è”æ¨¡å—ï¼ˆåŒä¸€æ–‡ä»¶ï¼‰

**é€‚ç”¨åœºæ™¯**: å°å‹é¡¹ç›®ã€å¿«é€ŸåŸå‹

```rust
// main.rs
mod math {
    pub fn add(a: i32, b: i32) -> i32 {
        a + b
    }
    
    pub mod advanced {
        pub fn multiply(a: i32, b: i32) -> i32 {
            a * b
        }
    }
}

fn main() {
    let sum = math::add(1, 2);
    let product = math::advanced::multiply(3, 4);
    
    println!("Sum: {}, Product: {}", sum, product);
}
```

**ç‰¹ç‚¹**:
- âœ… ç®€å•ç›´æ¥
- âœ… é€‚åˆå°é¡¹ç›®
- âŒ æ–‡ä»¶ä¼šå˜å¾—å¾ˆå¤§
- âŒ éš¾ä»¥ç»´æŠ¤

---

### 2ï¸âƒ£ åˆ†ç¦»åˆ°å•ç‹¬æ–‡ä»¶ï¼ˆç°ä»£é£æ ¼ï¼‰â­

**é€‚ç”¨åœºæ™¯**: ä¸­å¤§å‹é¡¹ç›®ï¼ˆæ¨èï¼‰

#### åŸºæœ¬ç»“æ„

```
src/
â”œâ”€â”€ main.rs
â””â”€â”€ math.rs
```

```rust
// main.rs
mod math;  // å£°æ˜æ¨¡å—ï¼ŒRust ä¼šè‡ªåŠ¨æ‰¾ math.rs

fn main() {
    let sum = math::add(1, 2);
    println!("Sum: {}", sum);
}
```

```rust
// math.rs
pub fn add(a: i32, b: i32) -> i32 {
    a + b
}

pub fn subtract(a: i32, b: i32) -> i32 {
    a - b
}
```

#### å¸¦å­æ¨¡å—çš„ç»“æ„

```
src/
â”œâ”€â”€ main.rs
â”œâ”€â”€ math.rs
â””â”€â”€ math/
    â”œâ”€â”€ basic.rs
    â””â”€â”€ advanced.rs
```

```rust
// main.rs
mod math;

fn main() {
    math::basic::add(1, 2);
    math::advanced::multiply(3, 4);
}
```

```rust
// math.rs
pub mod basic;     // å£°æ˜å­æ¨¡å—ï¼Œå¯¹åº” math/basic.rs
pub mod advanced;  // å£°æ˜å­æ¨¡å—ï¼Œå¯¹åº” math/advanced.rs

pub fn init() {
    println!("Math module initialized");
}
```

```rust
// math/basic.rs
pub fn add(a: i32, b: i32) -> i32 {
    a + b
}

pub fn subtract(a: i32, b: i32) -> i32 {
    a - b
}
```

```rust
// math/advanced.rs
pub fn multiply(a: i32, b: i32) -> i32 {
    a * b
}

pub fn divide(a: i32, b: i32) -> i32 {
    a / b
}
```

---

### 3ï¸âƒ£ ä½¿ç”¨ mod.rsï¼ˆæ—§é£æ ¼ï¼‰

**é€‚ç”¨åœºæ™¯**: ç»´æŠ¤æ—§é¡¹ç›®

```
src/
â”œâ”€â”€ main.rs
â””â”€â”€ math/
    â”œâ”€â”€ mod.rs      â† çˆ¶æ¨¡å—
    â”œâ”€â”€ basic.rs    â† å­æ¨¡å—
    â””â”€â”€ advanced.rs â† å­æ¨¡å—
```

```rust
// main.rs
mod math;

fn main() {
    math::basic::add(1, 2);
}
```

```rust
// math/mod.rs
pub mod basic;
pub mod advanced;

pub fn init() {
    println!("Math module initialized");
}
```

```rust
// math/basic.rs
pub fn add(a: i32, b: i32) -> i32 {
    a + b
}
```

**ç¼ºç‚¹**:
- âŒ å¤šä¸ª `mod.rs` æ–‡ä»¶åç›¸åŒï¼ŒIDE éš¾åŒºåˆ†
- âŒ çˆ¶æ¨¡å—æ²¡æœ‰ç‹¬ç«‹çš„æ–‡ä»¶å

---

## ğŸ“Š ä¸¤ç§é£æ ¼å¯¹æ¯”

| ç‰¹æ€§ | ç°ä»£é£æ ¼ | æ—§é£æ ¼ |
|------|---------|--------|
| **çˆ¶æ¨¡å—æ–‡ä»¶** | `parent.rs` | `parent/mod.rs` |
| **å­æ¨¡å—æ–‡ä»¶** | `parent/child.rs` | `parent/child.rs` |
| **æ¸…æ™°åº¦** | âœ… é«˜ | âš ï¸ ä¸­ |
| **IDE æ”¯æŒ** | âœ… å¥½ | âš ï¸ ä¸€èˆ¬ |
| **æ¨èåº¦** | â­â­â­â­â­ | â­â­â­ |

---

## ğŸ¨ å®Œæ•´ç¤ºä¾‹ï¼šWeb åº”ç”¨

### é¡¹ç›®ç»“æ„

```
my_web_app/
â”œâ”€â”€ Cargo.toml
â””â”€â”€ src/
    â”œâ”€â”€ main.rs
    â”œâ”€â”€ config.rs
    â”œâ”€â”€ routes.rs
    â”œâ”€â”€ routes/
    â”‚   â”œâ”€â”€ user.rs
    â”‚   â”œâ”€â”€ post.rs
    â”‚   â””â”€â”€ auth.rs
    â”œâ”€â”€ models.rs
    â”œâ”€â”€ models/
    â”‚   â”œâ”€â”€ user.rs
    â”‚   â””â”€â”€ post.rs
    â”œâ”€â”€ database.rs
    â””â”€â”€ database/
        â”œâ”€â”€ mysql.rs
        â””â”€â”€ postgres.rs
```

### ä»£ç å®ç°

```rust
// main.rs
mod config;
mod routes;
mod models;
mod database;

fn main() {
    config::load();
    database::init();
    
    routes::user::list();
    routes::post::create();
    
    let user = models::user::find_by_id(1);
}
```

```rust
// config.rs
pub struct Config {
    pub port: u16,
    pub host: String,
}

pub fn load() -> Config {
    Config {
        port: 8080,
        host: "localhost".to_string(),
    }
}
```

```rust
// routes.rs
pub mod user;
pub mod post;
pub mod auth;

pub fn init() {
    println!("Routes initialized");
}
```

```rust
// routes/user.rs
pub fn list() {
    println!("Listing users...");
}

pub fn create() {
    println!("Creating user...");
}

pub fn update(id: i32) {
    println!("Updating user {}...", id);
}

pub fn delete(id: i32) {
    println!("Deleting user {}...", id);
}
```

```rust
// routes/post.rs
pub fn list() {
    println!("Listing posts...");
}

pub fn create() {
    println!("Creating post...");
}
```

```rust
// routes/auth.rs
pub fn login(username: &str, password: &str) -> bool {
    println!("Logging in user: {}", username);
    true
}

pub fn logout() {
    println!("Logging out...");
}
```

```rust
// models.rs
pub mod user;
pub mod post;
```

```rust
// models/user.rs
pub struct User {
    pub id: i32,
    pub name: String,
    pub email: String,
}

pub fn find_by_id(id: i32) -> Option<User> {
    println!("Finding user with id: {}", id);
    Some(User {
        id,
        name: "Alice".to_string(),
        email: "alice@example.com".to_string(),
    })
}

pub fn find_all() -> Vec<User> {
    println!("Finding all users...");
    vec![]
}
```

```rust
// models/post.rs
pub struct Post {
    pub id: i32,
    pub title: String,
    pub content: String,
    pub author_id: i32,
}

pub fn find_by_id(id: i32) -> Option<Post> {
    println!("Finding post with id: {}", id);
    None
}
```

```rust
// database.rs
pub mod mysql;
pub mod postgres;

pub fn init() {
    println!("Database module initialized");
}
```

```rust
// database/mysql.rs
pub fn connect() {
    println!("Connecting to MySQL...");
}

pub fn query(sql: &str) {
    println!("Executing MySQL query: {}", sql);
}
```

```rust
// database/postgres.rs
pub fn connect() {
    println!("Connecting to PostgreSQL...");
}

pub fn query(sql: &str) {
    println!("Executing PostgreSQL query: {}", sql);
}
```

---

## ğŸ”‘ æ¨¡å—æŸ¥æ‰¾è§„åˆ™

### è§„åˆ™è¡¨

| å£°æ˜ä½ç½® | æŸ¥æ‰¾æ–‡ä»¶ |
|---------|---------|
| `main.rs` ä¸­ `mod foo;` | `foo.rs` æˆ– `foo/mod.rs` |
| `lib.rs` ä¸­ `mod foo;` | `foo.rs` æˆ– `foo/mod.rs` |
| `foo.rs` ä¸­ `mod bar;` | `foo/bar.rs` |
| `foo/mod.rs` ä¸­ `mod bar;` | `foo/bar.rs` |

### ç¤ºä¾‹

```rust
// main.rs
mod database;  // æŸ¥æ‰¾ database.rs æˆ– database/mod.rs
```

```rust
// database.rs
pub mod mysql;  // æŸ¥æ‰¾ database/mysql.rs
```

```rust
// database/mysql.rs
pub mod connection;  // æŸ¥æ‰¾ database/mysql/connection.rs
```

---

## ğŸ”’ å¯è§æ€§æ§åˆ¶

### pub å…³é”®å­—

```rust
// math.rs
pub fn public_function() {
    println!("This is public");
}

fn private_function() {
    println!("This is private");
}

pub mod advanced {
    pub fn multiply(a: i32, b: i32) -> i32 {
        a * b
    }
}

mod internal {
    pub fn helper() {
        println!("Internal helper");
    }
}
```

```rust
// main.rs
mod math;

fn main() {
    math::public_function();  // âœ… å¯ä»¥è®¿é—®
    // math::private_function();  // âŒ é”™è¯¯ï¼šç§æœ‰å‡½æ•°
    
    math::advanced::multiply(2, 3);  // âœ… å¯ä»¥è®¿é—®
    // math::internal::helper();  // âŒ é”™è¯¯ï¼šç§æœ‰æ¨¡å—
}
```

### pub(crate) - ä»…åœ¨å½“å‰ crate å¯è§

```rust
// lib.rs
pub(crate) fn internal_api() {
    println!("Only visible within this crate");
}
```

### pub(super) - ä»…åœ¨çˆ¶æ¨¡å—å¯è§

```rust
// parent.rs
mod child {
    pub(super) fn helper() {
        println!("Only visible to parent");
    }
}

fn parent_function() {
    child::helper();  // âœ… å¯ä»¥è®¿é—®
}
```

---

## ğŸ“¦ use å…³é”®å­—

### åŸºæœ¬ç”¨æ³•

```rust
// ä¸ä½¿ç”¨ use
fn main() {
    std::collections::HashMap::new();
    std::io::stdin();
}

// ä½¿ç”¨ use
use std::collections::HashMap;
use std::io::stdin;

fn main() {
    HashMap::new();
    stdin();
}
```

### å¯¼å…¥å¤šä¸ªé¡¹

```rust
use std::collections::{HashMap, HashSet, BTreeMap};
use std::io::{self, Read, Write};  // self è¡¨ç¤º std::io æœ¬èº«
```

### é‡å‘½å

```rust
use std::collections::HashMap as Map;
use std::io::Result as IoResult;

fn main() {
    let map = Map::new();
}
```

### å¯¼å…¥æ‰€æœ‰å…¬å¼€é¡¹ï¼ˆä¸æ¨èï¼‰

```rust
use std::collections::*;  // å¯¼å…¥æ‰€æœ‰å…¬å¼€é¡¹
```

### é‡æ–°å¯¼å‡º

```rust
// lib.rs
mod internal {
    pub fn helper() {}
}

pub use internal::helper;  // é‡æ–°å¯¼å‡ºï¼Œå¤–éƒ¨å¯ä»¥ç›´æ¥ä½¿ç”¨
```

---

## ğŸ¯ æœ€ä½³å®è·µ

### âœ… æ¨èåšæ³•

1. **ä½¿ç”¨ç°ä»£é£æ ¼**
   ```
   src/
   â”œâ”€â”€ main.rs
   â”œâ”€â”€ parent.rs
   â””â”€â”€ parent/
       â””â”€â”€ child.rs
   ```

2. **ä¸€ä¸ªæ–‡ä»¶ä¸€ä¸ªæ¨¡å—**
   - ä¿æŒæ–‡ä»¶å°è€Œä¸“æ³¨ï¼ˆ< 300 è¡Œï¼‰
   - æ¯ä¸ªæ–‡ä»¶åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½

3. **æŒ‰åŠŸèƒ½ç»„ç»‡ï¼Œä¸æ˜¯æŒ‰ç±»å‹**
   ```
   âœ… å¥½ï¼š
   src/
   â”œâ”€â”€ user/
   â”‚   â”œâ”€â”€ model.rs
   â”‚   â”œâ”€â”€ service.rs
   â”‚   â””â”€â”€ controller.rs
   
   âŒ å·®ï¼š
   src/
   â”œâ”€â”€ models/
   â”‚   â””â”€â”€ user.rs
   â”œâ”€â”€ services/
   â”‚   â””â”€â”€ user.rs
   â””â”€â”€ controllers/
       â””â”€â”€ user.rs
   ```

4. **ä½¿ç”¨ pub use ç®€åŒ–è·¯å¾„**
   ```rust
   // lib.rs
   pub use models::user::User;
   pub use models::post::Post;
   
   // å¤–éƒ¨ä½¿ç”¨
   use my_crate::{User, Post};  // è€Œä¸æ˜¯ my_crate::models::user::User
   ```

5. **é¿å…è¿‡åº¦åµŒå¥—**
   - æœ€å¤š 3-4 å±‚
   - è¶…è¿‡ 4 å±‚è€ƒè™‘é‡æ„

### âŒ é¿å…åšæ³•

1. âŒ æ‰€æœ‰ä»£ç æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶
2. âŒ æ··ç”¨æ–°æ—§é£æ ¼
3. âŒ å¾ªç¯ä¾èµ–
4. âŒ è¿‡åº¦ä½¿ç”¨ `pub`ï¼ˆæš´éœ²å¤ªå¤šå†…éƒ¨å®ç°ï¼‰
5. âŒ ä½¿ç”¨ `use *`ï¼ˆæ±¡æŸ“å‘½åç©ºé—´ï¼‰

---

## ğŸ› å¸¸è§é”™è¯¯

### é”™è¯¯ 1: å¿˜è®°å£°æ˜æ¨¡å—

```rust
// main.rs
// âŒ é”™è¯¯ï¼šå¿˜è®°å£°æ˜ math æ¨¡å—
fn main() {
    math::add(1, 2);  // é”™è¯¯ï¼šæ‰¾ä¸åˆ° math
}
```

```rust
// âœ… æ­£ç¡®
mod math;  // å£°æ˜æ¨¡å—

fn main() {
    math::add(1, 2);
}
```

### é”™è¯¯ 2: ç§æœ‰æ¨¡å—

```rust
// lib.rs
mod internal {  // âŒ ç§æœ‰æ¨¡å—
    pub fn helper() {}
}
```

```rust
// main.rs
use my_crate::internal::helper;  // âŒ é”™è¯¯ï¼šinternal æ˜¯ç§æœ‰çš„
```

```rust
// âœ… æ­£ç¡®
pub mod internal {  // å…¬å¼€æ¨¡å—
    pub fn helper() {}
}
```

### é”™è¯¯ 3: å¾ªç¯ä¾èµ–

```rust
// a.rs
use crate::b;

pub fn func_a() {
    b::func_b();
}
```

```rust
// b.rs
use crate::a;  // âŒ å¾ªç¯ä¾èµ–

pub fn func_b() {
    a::func_a();
}
```

**è§£å†³æ–¹æ¡ˆ**: æå–å…¬å…±é€»è¾‘åˆ°ç¬¬ä¸‰ä¸ªæ¨¡å—

---

## ğŸ“š æ€»ç»“

### æ ¸å¿ƒè¦ç‚¹

1. **æ¨¡å—å£°æ˜**: `mod foo;` å£°æ˜æ¨¡å—
2. **æ–‡ä»¶æŸ¥æ‰¾**: `foo.rs` æˆ– `foo/mod.rs`
3. **å­æ¨¡å—**: åœ¨ `foo.rs` ä¸­å£°æ˜ `mod bar;`ï¼ŒæŸ¥æ‰¾ `foo/bar.rs`
4. **å¯è§æ€§**: ä½¿ç”¨ `pub` æ§åˆ¶
5. **å¯¼å…¥**: ä½¿ç”¨ `use` ç®€åŒ–è·¯å¾„

### æ¨¡å—ç»„ç»‡æ¨¡å¼

| åœºæ™¯ | æ¨èæ–¹å¼ |
|------|---------|
| å°é¡¹ç›® | å†…è”æ¨¡å— |
| ä¸­å¤§å‹é¡¹ç›® | ç°ä»£é£æ ¼ï¼ˆ`parent.rs` + `parent/`ï¼‰ |
| ç»´æŠ¤æ—§é¡¹ç›® | æ—§é£æ ¼ï¼ˆ`parent/mod.rs`ï¼‰ |

### è®°å¿†å£è¯€

- **mod** = å£°æ˜æ¨¡å—
- **pub** = å…¬å¼€è®¿é—®
- **use** = å¯¼å…¥ç®€åŒ–
- **ç°ä»£é£æ ¼** = æ–‡ä»¶åæ¸…æ™°
- **æ—§é£æ ¼** = mod.rs æ··ä¹±

æŒæ¡æ¨¡å—ç³»ç»Ÿæ˜¯ç»„ç»‡å¤§å‹ Rust é¡¹ç›®çš„å…³é”®ï¼ğŸ¦€âœ¨

