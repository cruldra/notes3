# Rust å·¥å…·é“¾ï¼šrustupã€cargoã€rustc

Rust çš„å·¥å…·é“¾ç”±ä¸‰ä¸ªæ ¸å¿ƒå·¥å…·ç»„æˆï¼Œå®ƒä»¬ååŒå·¥ä½œï¼Œä¸ºå¼€å‘è€…æä¾›å®Œæ•´çš„å¼€å‘ä½“éªŒã€‚

---

## ğŸ¦€ å·¥å…·é“¾æ¦‚è§ˆ

```mermaid
graph TD
    A[rustup<br/>å·¥å…·é“¾ç®¡ç†å™¨] --> B[rustc<br/>Rust ç¼–è¯‘å™¨]
    A --> C[cargo<br/>åŒ…ç®¡ç†å™¨]
    C --> B
    C --> D[æ„å»ºç³»ç»Ÿ]
    C --> E[ä¾èµ–ç®¡ç†]
    C --> F[é¡¹ç›®ç®¡ç†]
```

---

## 1ï¸âƒ£ rustup - Rust å·¥å…·é“¾ç®¡ç†å™¨

### ğŸ“– ä»€ä¹ˆæ˜¯ rustupï¼Ÿ

**rustup** æ˜¯ Rust çš„å®˜æ–¹å·¥å…·é“¾å®‰è£…å™¨å’Œç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œç±»ä¼¼äºï¼š
- Node.js çš„ `nvm`
- Python çš„ `pyenv`
- Ruby çš„ `rbenv`

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

#### 1. ç®¡ç† Rust ç‰ˆæœ¬

Rust æœ‰ä¸‰ä¸ªå‘å¸ƒé€šé“ï¼š

- **stable**ï¼ˆç¨³å®šç‰ˆï¼‰ï¼šæ¯ 6 å‘¨å‘å¸ƒä¸€æ¬¡ï¼Œæ¨èæ—¥å¸¸ä½¿ç”¨
- **beta**ï¼ˆæµ‹è¯•ç‰ˆï¼‰ï¼šä¸‹ä¸€ä¸ªç¨³å®šç‰ˆçš„å€™é€‰ç‰ˆæœ¬
- **nightly**ï¼ˆæ¯å¤œç‰ˆï¼‰ï¼šæœ€æ–°çš„å®éªŒæ€§åŠŸèƒ½

```bash
# å®‰è£…ç¨³å®šç‰ˆ
rustup install stable

# å®‰è£… nightly ç‰ˆ
rustup install nightly

# å®‰è£…ç‰¹å®šç‰ˆæœ¬
rustup install 1.75.0

# æŸ¥çœ‹å·²å®‰è£…çš„å·¥å…·é“¾
rustup toolchain list

# è®¾ç½®é»˜è®¤å·¥å…·é“¾
rustup default stable
```

#### 2. ç®¡ç†ç¼–è¯‘ç›®æ ‡

æ”¯æŒäº¤å‰ç¼–è¯‘åˆ°ä¸åŒå¹³å°ï¼š

```bash
# æŸ¥çœ‹å½“å‰å·²å®‰è£…çš„ç›®æ ‡
rustup target list --installed

# æ·»åŠ ç¼–è¯‘ç›®æ ‡
rustup target add x86_64-pc-windows-msvc      # Windows
rustup target add x86_64-unknown-linux-gnu    # Linux
rustup target add x86_64-apple-darwin         # macOS
rustup target add wasm32-unknown-unknown      # WebAssembly
rustup target add aarch64-linux-android       # Android ARM64

# ç§»é™¤ç¼–è¯‘ç›®æ ‡
rustup target remove wasm32-unknown-unknown
```

#### 3. ç®¡ç†ç»„ä»¶

```bash
# æŸ¥çœ‹å¯ç”¨ç»„ä»¶
rustup component list

# å®‰è£…å¸¸ç”¨ç»„ä»¶
rustup component add rustfmt      # ä»£ç æ ¼å¼åŒ–å·¥å…·
rustup component add clippy       # ä»£ç æ£€æŸ¥å·¥å…·
rustup component add rust-src     # Rust æºä»£ç ï¼ˆç”¨äº IDE è¡¥å…¨ï¼‰
rustup component add rust-docs    # ç¦»çº¿æ–‡æ¡£
rustup component add rust-analyzer # LSP æœåŠ¡å™¨

# ç§»é™¤ç»„ä»¶
rustup component remove rustfmt
```

#### 4. æ›´æ–°å·¥å…·é“¾

```bash
# æ›´æ–°æ‰€æœ‰å·²å®‰è£…çš„å·¥å…·é“¾
rustup update

# æ›´æ–°ç‰¹å®šå·¥å…·é“¾
rustup update stable
rustup update nightly

# æ£€æŸ¥æ›´æ–°
rustup check
```

### ğŸ”§ å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹ rustup ç‰ˆæœ¬
rustup --version

# æŸ¥çœ‹å½“å‰æ¿€æ´»çš„å·¥å…·é“¾
rustup show

# æ‰“å¼€æœ¬åœ°æ–‡æ¡£
rustup doc

# æ‰“å¼€æ ‡å‡†åº“æ–‡æ¡£
rustup doc --std

# æ‰“å¼€ The Rust Book
rustup doc --book

# å¸è½½ Rust
rustup self uninstall

# æ›´æ–° rustup è‡ªèº«
rustup self update
```

### ğŸ“ é¡¹ç›®çº§å·¥å…·é“¾é…ç½®

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `rust-toolchain.toml`ï¼š

```toml
[toolchain]
channel = "1.75.0"
components = ["rustfmt", "clippy"]
targets = ["wasm32-unknown-unknown"]
```

æˆ–ç®€å•ç‰ˆæœ¬ `rust-toolchain`ï¼š

```
1.75.0
```

å½“è¿›å…¥è¯¥ç›®å½•æ—¶ï¼Œrustup ä¼šè‡ªåŠ¨åˆ‡æ¢åˆ°æŒ‡å®šçš„å·¥å…·é“¾ã€‚

### ğŸŒ ç¯å¢ƒå˜é‡

```bash
# è®¾ç½®å·¥å…·é“¾å®‰è£…ç›®å½•ï¼ˆé»˜è®¤ ~/.rustupï¼‰
RUSTUP_HOME=/custom/path

# è®¾ç½® cargo å®‰è£…ç›®å½•ï¼ˆé»˜è®¤ ~/.cargoï¼‰
CARGO_HOME=/custom/path

# ä½¿ç”¨é•œåƒåŠ é€Ÿï¼ˆä¸­å›½å¤§é™†ï¼‰
RUSTUP_DIST_SERVER=https://mirrors.ustc.edu.cn/rust-static
RUSTUP_UPDATE_ROOT=https://mirrors.ustc.edu.cn/rust-static/rustup
```

---

## 2ï¸âƒ£ cargo - Rust åŒ…ç®¡ç†å™¨å’Œæ„å»ºå·¥å…·

### ğŸ“– ä»€ä¹ˆæ˜¯ cargoï¼Ÿ

**cargo** æ˜¯ Rust çš„å®˜æ–¹åŒ…ç®¡ç†å™¨å’Œæ„å»ºç³»ç»Ÿï¼Œç±»ä¼¼äºï¼š
- Node.js çš„ `npm`
- Python çš„ `pip`
- Java çš„ `Maven`

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

#### 1. é¡¹ç›®ç®¡ç†

```bash
# åˆ›å»ºæ–°é¡¹ç›®ï¼ˆäºŒè¿›åˆ¶ç¨‹åºï¼‰
cargo new my-project

# åˆ›å»ºæ–°é¡¹ç›®ï¼ˆåº“ï¼‰
cargo new my-lib --lib

# åœ¨å½“å‰ç›®å½•åˆå§‹åŒ–é¡¹ç›®
cargo init

# é¡¹ç›®ç»“æ„
my-project/
â”œâ”€â”€ Cargo.toml          # é¡¹ç›®é…ç½®æ–‡ä»¶
â”œâ”€â”€ Cargo.lock          # ä¾èµ–é”å®šæ–‡ä»¶
â”œâ”€â”€ src/
â”‚   â””â”€â”€ main.rs         # å…¥å£æ–‡ä»¶
â””â”€â”€ target/             # ç¼–è¯‘è¾“å‡ºç›®å½•
```

#### 2. æ„å»ºå’Œè¿è¡Œ

```bash
# ç¼–è¯‘é¡¹ç›®ï¼ˆdebug æ¨¡å¼ï¼‰
cargo build

# ç¼–è¯‘é¡¹ç›®ï¼ˆrelease æ¨¡å¼ï¼Œå¯ç”¨ä¼˜åŒ–ï¼‰
cargo build --release

# ç¼–è¯‘å¹¶è¿è¡Œ
cargo run

# è¿è¡Œå¹¶ä¼ é€’å‚æ•°
cargo run -- arg1 arg2

# åªæ£€æŸ¥ä»£ç ï¼Œä¸ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼ˆé€Ÿåº¦å¿«ï¼‰
cargo check

# æ¸…ç†ç¼–è¯‘äº§ç‰©
cargo clean
```

#### 3. ä¾èµ–ç®¡ç†

**Cargo.toml ç¤ºä¾‹ï¼š**

```toml
[package]
name = "my-project"
version = "0.1.0"
edition = "2021"

[dependencies]
serde = "1.0"                          # æœ€æ–° 1.x ç‰ˆæœ¬
tokio = { version = "1.35", features = ["full"] }
rand = "0.8.5"

[dev-dependencies]
criterion = "0.5"                      # ä»…ç”¨äºæµ‹è¯•/åŸºå‡†æµ‹è¯•

[build-dependencies]
cc = "1.0"                             # ä»…ç”¨äºæ„å»ºè„šæœ¬
```

**å¸¸ç”¨å‘½ä»¤ï¼š**

```bash
# æ·»åŠ ä¾èµ–
cargo add serde
cargo add tokio --features full

# ç§»é™¤ä¾èµ–
cargo remove serde

# æ›´æ–°ä¾èµ–
cargo update                # æ›´æ–°æ‰€æœ‰ä¾èµ–
cargo update serde          # æ›´æ–°ç‰¹å®šä¾èµ–

# æŸ¥çœ‹ä¾èµ–æ ‘
cargo tree

# æœç´¢ crates.io ä¸Šçš„åŒ…
cargo search serde
```

#### 4. æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
cargo test

# è¿è¡Œç‰¹å®šæµ‹è¯•
cargo test test_name

# æ˜¾ç¤ºæµ‹è¯•è¾“å‡º
cargo test -- --nocapture

# è¿è¡Œæ–‡æ¡£æµ‹è¯•
cargo test --doc

# è¿è¡ŒåŸºå‡†æµ‹è¯•
cargo bench
```

#### 5. æ–‡æ¡£

```bash
# ç”Ÿæˆå¹¶æ‰“å¼€é¡¹ç›®æ–‡æ¡£
cargo doc --open

# ç”Ÿæˆæ–‡æ¡£ï¼ˆåŒ…å«ä¾èµ–ï¼‰
cargo doc --no-deps

# ç”Ÿæˆæ–‡æ¡£ï¼ˆåŒ…å«ç§æœ‰é¡¹ï¼‰
cargo doc --document-private-items
```

#### 6. å‘å¸ƒ

```bash
# æ‰“åŒ…é¡¹ç›®
cargo package

# å‘å¸ƒåˆ° crates.io
cargo publish

# ç™»å½• crates.io
cargo login <token>

# æ’¤å›å·²å‘å¸ƒçš„ç‰ˆæœ¬
cargo yank --vers 1.0.0
```

### ğŸ”§ å¸¸ç”¨å‘½ä»¤

```bash
# æ ¼å¼åŒ–ä»£ç 
cargo fmt

# ä»£ç æ£€æŸ¥ï¼ˆlintï¼‰
cargo clippy

# ä¿®å¤å¯è‡ªåŠ¨ä¿®å¤çš„é—®é¢˜
cargo fix

# æŸ¥çœ‹é¡¹ç›®å…ƒæ•°æ®
cargo metadata

# å®‰è£…äºŒè¿›åˆ¶ç¨‹åº
cargo install ripgrep
cargo install cargo-watch

# å¸è½½äºŒè¿›åˆ¶ç¨‹åº
cargo uninstall ripgrep

# åˆ—å‡ºå·²å®‰è£…çš„äºŒè¿›åˆ¶ç¨‹åº
cargo install --list
```

### ğŸ“¦ Workspaceï¼ˆå·¥ä½œç©ºé—´ï¼‰

ç®¡ç†å¤šä¸ªç›¸å…³çš„åŒ…ï¼š

```toml
# Cargo.tomlï¼ˆæ ¹ç›®å½•ï¼‰
[workspace]
members = [
    "crate-a",
    "crate-b",
    "crate-c",
]

[workspace.dependencies]
serde = "1.0"  # å…±äº«ä¾èµ–ç‰ˆæœ¬
```

```bash
# æ„å»ºå·¥ä½œç©ºé—´ä¸­çš„æ‰€æœ‰åŒ…
cargo build --workspace

# æµ‹è¯•å·¥ä½œç©ºé—´ä¸­çš„æ‰€æœ‰åŒ…
cargo test --workspace
```

### ğŸš€ å¸¸ç”¨ Cargo æ’ä»¶

```bash
# ç›‘å¬æ–‡ä»¶å˜åŒ–è‡ªåŠ¨é‡æ–°ç¼–è¯‘
cargo install cargo-watch
cargo watch -x run

# ç”Ÿæˆä¾èµ–å›¾
cargo install cargo-deps
cargo deps | dot -Tpng > graph.png

# æ£€æŸ¥è¿‡æ—¶çš„ä¾èµ–
cargo install cargo-outdated
cargo outdated

# å®¡è®¡å®‰å…¨æ¼æ´
cargo install cargo-audit
cargo audit

# æ‰©å±• Cargo.toml
cargo install cargo-edit
cargo add/rm/upgrade

# ç”Ÿæˆä»£ç è¦†ç›–ç‡
cargo install cargo-tarpaulin
cargo tarpaulin
```

---

## 3ï¸âƒ£ rustc - Rust ç¼–è¯‘å™¨

### ğŸ“– ä»€ä¹ˆæ˜¯ rustcï¼Ÿ

**rustc** æ˜¯ Rust çš„ç¼–è¯‘å™¨ï¼Œè´Ÿè´£å°† Rust æºä»£ç ç¼–è¯‘æˆæœºå™¨ç ã€‚

é€šå¸¸ä¸ç›´æ¥ä½¿ç”¨ rustcï¼Œè€Œæ˜¯é€šè¿‡ cargo é—´æ¥è°ƒç”¨ã€‚

### ğŸ¯ åŸºæœ¬ç”¨æ³•

```bash
# ç¼–è¯‘å•ä¸ªæ–‡ä»¶
rustc main.rs

# æŒ‡å®šè¾“å‡ºæ–‡ä»¶å
rustc main.rs -o my_program

# ä¼˜åŒ–ç¼–è¯‘
rustc -O main.rs

# æŸ¥çœ‹ç‰ˆæœ¬
rustc --version

# æŸ¥çœ‹è¯¦ç»†ç‰ˆæœ¬ä¿¡æ¯
rustc --version --verbose
```

### ğŸ”§ ç¼–è¯‘é€‰é¡¹

```bash
# æŒ‡å®šç¼–è¯‘ç›®æ ‡
rustc --target wasm32-unknown-unknown main.rs

# ç”Ÿæˆåº“æ–‡ä»¶
rustc --crate-type lib lib.rs

# è®¾ç½®ä¼˜åŒ–çº§åˆ«ï¼ˆ0-3ï¼‰
rustc -C opt-level=3 main.rs

# ç”Ÿæˆè°ƒè¯•ä¿¡æ¯
rustc -g main.rs

# æ˜¾ç¤ºè­¦å‘Š
rustc -W warnings main.rs

# å°†è­¦å‘Šè§†ä¸ºé”™è¯¯
rustc -D warnings main.rs
```

### ğŸ“Š æŸ¥çœ‹ç¼–è¯‘ä¿¡æ¯

```bash
# æŸ¥çœ‹æ”¯æŒçš„ç›®æ ‡å¹³å°
rustc --print target-list

# æŸ¥çœ‹é»˜è®¤ç›®æ ‡å¹³å°
rustc --print target-spec-json

# æŸ¥çœ‹ sysroot è·¯å¾„
rustc --print sysroot

# å±•å¼€å®
rustc -Z unstable-options --pretty=expanded main.rs

# ç”Ÿæˆ LLVM IR
rustc --emit=llvm-ir main.rs

# ç”Ÿæˆæ±‡ç¼–ä»£ç 
rustc --emit=asm main.rs
```

### ğŸ¨ é€šè¿‡ Cargo ä½¿ç”¨ rustc é€‰é¡¹

åœ¨ `Cargo.toml` ä¸­é…ç½®ï¼š

```toml
[profile.dev]
opt-level = 0      # ä¸ä¼˜åŒ–

[profile.release]
opt-level = 3      # æœ€é«˜ä¼˜åŒ–
lto = true         # é“¾æ¥æ—¶ä¼˜åŒ–
codegen-units = 1  # å•ä¸ªä»£ç ç”Ÿæˆå•å…ƒï¼ˆæ›´å¥½çš„ä¼˜åŒ–ï¼‰
strip = true       # ç§»é™¤ç¬¦å·ä¿¡æ¯ï¼ˆå‡å°ä½“ç§¯ï¼‰
```

æˆ–é€šè¿‡ç¯å¢ƒå˜é‡ï¼š

```bash
# ä¼ é€’é€‰é¡¹ç»™ rustc
RUSTFLAGS="-C target-cpu=native" cargo build --release
```

---

## ğŸ”„ å·¥å…·é“¾åä½œæµç¨‹

```mermaid
sequenceDiagram
    participant Dev as å¼€å‘è€…
    participant Cargo as cargo
    participant Rustc as rustc
    participant Crates as crates.io

    Dev->>Cargo: cargo new my-project
    Cargo->>Dev: åˆ›å»ºé¡¹ç›®ç»“æ„
    
    Dev->>Cargo: cargo add serde
    Cargo->>Crates: ä¸‹è½½ä¾èµ–
    Crates->>Cargo: è¿”å› serde
    
    Dev->>Cargo: cargo build
    Cargo->>Rustc: è°ƒç”¨ç¼–è¯‘å™¨
    Rustc->>Cargo: è¿”å›ç¼–è¯‘äº§ç‰©
    Cargo->>Dev: ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶
    
    Dev->>Cargo: cargo run
    Cargo->>Dev: è¿è¡Œç¨‹åº
```

---

## ğŸ“š å®ç”¨æŠ€å·§

### 1. åŠ é€Ÿç¼–è¯‘

```bash
# ä½¿ç”¨ sccache ç¼“å­˜ç¼–è¯‘ç»“æœ
cargo install sccache
export RUSTC_WRAPPER=sccache

# ä½¿ç”¨ mold é“¾æ¥å™¨ï¼ˆLinuxï¼‰
sudo apt install mold
export RUSTFLAGS="-C link-arg=-fuse-ld=mold"

# å¢åŠ å¹¶è¡Œç¼–è¯‘å•å…ƒ
export CARGO_BUILD_JOBS=8
```

### 2. é…ç½®å›½å†…é•œåƒ

åˆ›å»º `~/.cargo/config.toml`ï¼š

```toml
[source.crates-io]
replace-with = 'ustc'

[source.ustc]
registry = "https://mirrors.ustc.edu.cn/crates.io-index"

[source.tuna]
registry = "https://mirrors.tuna.tsinghua.edu.cn/git/crates.io-index.git"

[source.sjtu]
registry = "https://mirrors.sjtug.sjtu.edu.cn/git/crates.io-index/"
```

### 3. å¸¸ç”¨åˆ«å

åœ¨ `~/.cargo/config.toml` ä¸­æ·»åŠ ï¼š

```toml
[alias]
b = "build"
r = "run"
t = "test"
c = "check"
br = "build --release"
rr = "run --release"
```

ä½¿ç”¨ï¼š

```bash
cargo b      # ç­‰åŒäº cargo build
cargo rr     # ç­‰åŒäº cargo run --release
```

---

## ğŸ¯ å¿«é€Ÿå‚è€ƒ

### rustup å¸¸ç”¨å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `rustup update` | æ›´æ–°å·¥å…·é“¾ |
| `rustup default stable` | è®¾ç½®é»˜è®¤å·¥å…·é“¾ |
| `rustup show` | æ˜¾ç¤ºå½“å‰å·¥å…·é“¾ |
| `rustup doc` | æ‰“å¼€æœ¬åœ°æ–‡æ¡£ |
| `rustup component add clippy` | å®‰è£…ç»„ä»¶ |
| `rustup target add <target>` | æ·»åŠ ç¼–è¯‘ç›®æ ‡ |

### cargo å¸¸ç”¨å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `cargo new <name>` | åˆ›å»ºæ–°é¡¹ç›® |
| `cargo build` | ç¼–è¯‘é¡¹ç›® |
| `cargo run` | è¿è¡Œé¡¹ç›® |
| `cargo test` | è¿è¡Œæµ‹è¯• |
| `cargo check` | å¿«é€Ÿæ£€æŸ¥ä»£ç  |
| `cargo fmt` | æ ¼å¼åŒ–ä»£ç  |
| `cargo clippy` | ä»£ç æ£€æŸ¥ |
| `cargo doc --open` | ç”Ÿæˆå¹¶æ‰“å¼€æ–‡æ¡£ |

### rustc å¸¸ç”¨é€‰é¡¹

| é€‰é¡¹ | è¯´æ˜ |
|------|------|
| `-O` | ä¼˜åŒ–ç¼–è¯‘ |
| `-g` | ç”Ÿæˆè°ƒè¯•ä¿¡æ¯ |
| `--target <target>` | æŒ‡å®šç¼–è¯‘ç›®æ ‡ |
| `--emit=asm` | ç”Ÿæˆæ±‡ç¼–ä»£ç  |
| `-C opt-level=3` | è®¾ç½®ä¼˜åŒ–çº§åˆ« |

---

## ğŸ› ï¸ Rust å®‰è£…æ—¶åŒ…å«çš„æ‰€æœ‰å·¥å…·

å½“ä½ é€šè¿‡ `rustup` å®‰è£… Rust æ—¶ï¼Œä¼šè‡ªåŠ¨å®‰è£…ä»¥ä¸‹ç»„ä»¶ï¼š

### æ ¸å¿ƒç»„ä»¶ï¼ˆé»˜è®¤å®‰è£…ï¼‰

#### 1. **cargo** - åŒ…ç®¡ç†å™¨å’Œæ„å»ºå·¥å…·
```bash
cargo --version
```
- é¡¹ç›®ç®¡ç†ã€ä¾èµ–ç®¡ç†ã€æ„å»ºç³»ç»Ÿ
- è¯¦è§ä¸Šæ–‡ "cargo" ç« èŠ‚

#### 2. **clippy** - ä»£ç æ£€æŸ¥å·¥å…·ï¼ˆLinterï¼‰
```bash
cargo clippy
```

**åŠŸèƒ½ï¼š**
- æ£€æµ‹å¸¸è§é”™è¯¯å’Œä¸è‰¯å®è·µ
- æä¾›ä»£ç æ”¹è¿›å»ºè®®
- è¶…è¿‡ 600 ä¸ª lint è§„åˆ™

**ç¤ºä¾‹ï¼š**
```rust
// ä¸æ¨èçš„å†™æ³•
let x = 0;
if x == 0 {
    println!("zero");
}

// clippy ä¼šå»ºè®®ï¼š
if x.is_zero() {  // æ›´æ¸…æ™°
    println!("zero");
}
```

**å¸¸ç”¨å‘½ä»¤ï¼š**
```bash
# è¿è¡Œ clippy
cargo clippy

# å°†è­¦å‘Šè§†ä¸ºé”™è¯¯
cargo clippy -- -D warnings

# è‡ªåŠ¨ä¿®å¤éƒ¨åˆ†é—®é¢˜
cargo clippy --fix

# æŸ¥çœ‹æ‰€æœ‰ lint è§„åˆ™
cargo clippy --help
```

**é…ç½® clippyï¼š**

åœ¨ `Cargo.toml` ä¸­ï¼š
```toml
[lints.clippy]
all = "warn"
pedantic = "warn"
nursery = "warn"
```

æˆ–åœ¨ä»£ç ä¸­ï¼š
```rust
#![warn(clippy::all)]
#![warn(clippy::pedantic)]
#![deny(clippy::unwrap_used)]  // ç¦æ­¢ä½¿ç”¨ unwrap
```

---

#### 3. **rust-docs** - ç¦»çº¿æ–‡æ¡£
```bash
rustup doc
```

**åŒ…å«çš„æ–‡æ¡£ï¼š**
- **The Rust Book** - Rust å®˜æ–¹æ•™ç¨‹
- **Rust by Example** - ç¤ºä¾‹å­¦ä¹ 
- **Standard Library API** - æ ‡å‡†åº“æ–‡æ¡£
- **Cargo Book** - Cargo ä½¿ç”¨æŒ‡å—
- **rustc Book** - ç¼–è¯‘å™¨æ–‡æ¡£
- **rustdoc Book** - æ–‡æ¡£ç”Ÿæˆå·¥å…·æŒ‡å—

**å¸¸ç”¨å‘½ä»¤ï¼š**
```bash
# æ‰“å¼€ä¸»æ–‡æ¡£é¡µé¢
rustup doc

# æ‰“å¼€ The Rust Book
rustup doc --book

# æ‰“å¼€æ ‡å‡†åº“æ–‡æ¡£
rustup doc --std

# æ‰“å¼€ Cargo Book
rustup doc --cargo

# æ‰“å¼€ç‰¹å®šæ¨¡å—æ–‡æ¡£
rustup doc std::collections
```

**ä¼˜åŠ¿ï¼š**
- âœ… å®Œå…¨ç¦»çº¿å¯ç”¨
- âœ… ä¸å®‰è£…çš„ Rust ç‰ˆæœ¬å®Œå…¨åŒ¹é…
- âœ… åŒ…å«æ‰€æœ‰æ ‡å‡†åº“ API
- âœ… æœç´¢åŠŸèƒ½å¼ºå¤§

---

#### 4. **rustfmt** - ä»£ç æ ¼å¼åŒ–å·¥å…·
```bash
cargo fmt
```

**åŠŸèƒ½ï¼š**
- è‡ªåŠ¨æ ¼å¼åŒ– Rust ä»£ç 
- ç»Ÿä¸€ä»£ç é£æ ¼
- æ”¯æŒè‡ªå®šä¹‰é…ç½®

**å¸¸ç”¨å‘½ä»¤ï¼š**
```bash
# æ ¼å¼åŒ–æ•´ä¸ªé¡¹ç›®
cargo fmt

# æ£€æŸ¥æ ¼å¼ä½†ä¸ä¿®æ”¹
cargo fmt -- --check

# æ ¼å¼åŒ–å•ä¸ªæ–‡ä»¶
rustfmt src/main.rs

# æ˜¾ç¤ºæ ¼å¼åŒ–å·®å¼‚
cargo fmt -- --emit=diff
```

**é…ç½® rustfmtï¼š**

åˆ›å»º `rustfmt.toml` æˆ– `.rustfmt.toml`ï¼š
```toml
max_width = 100
hard_tabs = false
tab_spaces = 4
newline_style = "Unix"
use_small_heuristics = "Default"
reorder_imports = true
reorder_modules = true
remove_nested_parens = true
edition = "2021"
```

**å¸¸ç”¨é…ç½®é¡¹ï¼š**
```toml
# æ¯è¡Œæœ€å¤§å­—ç¬¦æ•°
max_width = 100

# å¯¼å…¥æ’åº
reorder_imports = true

# å‡½æ•°å‚æ•°æ¢è¡Œ
fn_args_layout = "Tall"

# é“¾å¼è°ƒç”¨æ¢è¡Œ
chain_width = 60

# æ³¨é‡Šå®½åº¦
comment_width = 80

# ä½¿ç”¨å­—æ®µåˆå§‹åŒ–ç®€å†™
use_field_init_shorthand = true
```

**åœ¨ CI ä¸­ä½¿ç”¨ï¼š**
```bash
# æ£€æŸ¥ä»£ç æ ¼å¼
cargo fmt -- --check || exit 1
```

---

#### 5. **rustc** - Rust ç¼–è¯‘å™¨
```bash
rustc --version
```
- å°† Rust ä»£ç ç¼–è¯‘æˆæœºå™¨ç 
- è¯¦è§ä¸Šæ–‡ "rustc" ç« èŠ‚

---

#### 6. **rust-std** - Rust æ ‡å‡†åº“
```bash
rustc --print sysroot
```

**åŒ…å«çš„å†…å®¹ï¼š**
- **æ ¸å¿ƒåº“ï¼ˆcoreï¼‰** - ä¸ä¾èµ–æ“ä½œç³»ç»Ÿçš„åŸºç¡€åŠŸèƒ½
- **æ ‡å‡†åº“ï¼ˆstdï¼‰** - å®Œæ•´çš„æ ‡å‡†åº“
- **alloc** - å †åˆ†é…ç›¸å…³åŠŸèƒ½
- **proc_macro** - è¿‡ç¨‹å®æ”¯æŒ

**æ ‡å‡†åº“æ¨¡å—ï¼š**
- `std::collections` - é›†åˆç±»å‹ï¼ˆVec, HashMap ç­‰ï¼‰
- `std::io` - è¾“å…¥è¾“å‡º
- `std::fs` - æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
- `std::net` - ç½‘ç»œç¼–ç¨‹
- `std::thread` - çº¿ç¨‹
- `std::sync` - åŒæ­¥åŸè¯­
- `std::process` - è¿›ç¨‹ç®¡ç†
- `std::env` - ç¯å¢ƒå˜é‡

**æŸ¥çœ‹æ ‡å‡†åº“æºç ï¼š**
```bash
# å®‰è£…æºç ç»„ä»¶
rustup component add rust-src

# æºç ä½ç½®
rustc --print sysroot
# é€šå¸¸åœ¨ <sysroot>/lib/rustlib/src/rust/library/
```

---

### å¯é€‰ç»„ä»¶ï¼ˆéœ€è¦æ‰‹åŠ¨å®‰è£…ï¼‰

#### 7. **rust-src** - Rust æºä»£ç 
```bash
rustup component add rust-src
```

**ç”¨é€”ï¼š**
- IDE ä»£ç è¡¥å…¨å’Œè·³è½¬
- æŸ¥çœ‹æ ‡å‡†åº“å®ç°
- äº¤å‰ç¼–è¯‘æŸäº›ç›®æ ‡
- å­¦ä¹  Rust å†…éƒ¨å®ç°

**ä½¿ç”¨åœºæ™¯ï¼š**
```bash
# è·³è½¬åˆ°æ ‡å‡†åº“å®šä¹‰ï¼ˆåœ¨ IDE ä¸­ï¼‰
# ä¾‹å¦‚ï¼šè·³è½¬åˆ° Vec::push çš„å®ç°

# åµŒå…¥å¼å¼€å‘
cargo build --target thumbv7em-none-eabihf
```

---

#### 8. **rust-analyzer** - LSP è¯­è¨€æœåŠ¡å™¨
```bash
rustup component add rust-analyzer
```

**åŠŸèƒ½ï¼š**
- ä»£ç è¡¥å…¨
- ç±»å‹æç¤º
- é”™è¯¯æ£€æŸ¥
- ä»£ç å¯¼èˆªï¼ˆè·³è½¬å®šä¹‰ã€æŸ¥æ‰¾å¼•ç”¨ï¼‰
- é‡æ„æ”¯æŒ
- å†…è”æç¤º

**æ”¯æŒçš„ç¼–è¾‘å™¨ï¼š**
- VS Codeï¼ˆæ¨èæ’ä»¶ï¼šrust-analyzerï¼‰
- IntelliJ IDEA / CLion
- Vim / Neovim
- Emacs
- Sublime Text
- Helix

**VS Code é…ç½®ç¤ºä¾‹ï¼š**
```json
{
  "rust-analyzer.checkOnSave.command": "clippy",
  "rust-analyzer.cargo.features": "all",
  "rust-analyzer.inlayHints.enable": true,
  "rust-analyzer.completion.autoimport.enable": true
}
```

---

#### 9. **rustdoc** - æ–‡æ¡£ç”Ÿæˆå·¥å…·
```bash
rustdoc --version
```

**åŠŸèƒ½ï¼š**
- ä»ä»£ç æ³¨é‡Šç”Ÿæˆ HTML æ–‡æ¡£
- æ”¯æŒ Markdown è¯­æ³•
- è‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£
- è¿è¡Œæ–‡æ¡£æµ‹è¯•

**æ–‡æ¡£æ³¨é‡Šè¯­æ³•ï¼š**
```rust
/// è®¡ç®—ä¸¤ä¸ªæ•°çš„å’Œ
///
/// # Examples
///
/// ```
/// let result = add(2, 3);
/// assert_eq!(result, 5);
/// ```
///
/// # Panics
///
/// å½“ç»“æœæº¢å‡ºæ—¶ä¼š panic
pub fn add(a: i32, b: i32) -> i32 {
    a + b
}
```

**å¸¸ç”¨å‘½ä»¤ï¼š**
```bash
# ç”Ÿæˆæ–‡æ¡£
cargo doc

# ç”Ÿæˆå¹¶æ‰“å¼€æ–‡æ¡£
cargo doc --open

# åŒ…å«ç§æœ‰é¡¹
cargo doc --document-private-items

# ä¸åŒ…å«ä¾èµ–çš„æ–‡æ¡£
cargo doc --no-deps

# æµ‹è¯•æ–‡æ¡£ä¸­çš„ä»£ç ç¤ºä¾‹
cargo test --doc
```

---

#### 10. **rust-mingw**ï¼ˆä»… Windowsï¼‰
```bash
# Windows ä¸Šè‡ªåŠ¨å®‰è£…
```

**åŠŸèƒ½ï¼š**
- æä¾› MinGW å·¥å…·é“¾
- ç”¨äº `x86_64-pc-windows-gnu` ç›®æ ‡
- åŒ…å« GCC å’Œç›¸å…³å·¥å…·

**ç›®æ ‡é€‰æ‹©ï¼š**
- `x86_64-pc-windows-msvc` - ä½¿ç”¨ MSVCï¼ˆæ¨èï¼‰
- `x86_64-pc-windows-gnu` - ä½¿ç”¨ MinGW

---

### å…¶ä»–å®ç”¨å·¥å…·

#### 11. **cargo-fmt** / **cargo-clippy**
è¿™äº›æ˜¯ cargo çš„å­å‘½ä»¤ï¼Œç”±å¯¹åº”ç»„ä»¶æä¾›ï¼š
```bash
cargo fmt    # ç”± rustfmt æä¾›
cargo clippy # ç”± clippy æä¾›
```

---

## ğŸ“¦ å®Œæ•´çš„å®‰è£…æ¸…å•

æ ¹æ®ä½ çš„å®‰è£…æˆªå›¾ï¼Œæ ‡å‡†å®‰è£…åŒ…å«ï¼š

| ç»„ä»¶ | å¤§å° | è¯´æ˜ |
|------|------|------|
| **cargo** | ~20 MiB | åŒ…ç®¡ç†å™¨å’Œæ„å»ºå·¥å…· |
| **clippy** | ~20 MiB | ä»£ç æ£€æŸ¥å·¥å…· |
| **rust-docs** | ~20 MiB | ç¦»çº¿æ–‡æ¡£ |
| **rust-std** | ~20 MiB | æ ‡å‡†åº“ |
| **rustc** | ~76 MiB | Rust ç¼–è¯‘å™¨ |
| **rustfmt** | ~76 MiB | ä»£ç æ ¼å¼åŒ–å·¥å…· |

**æ€»å¤§å°ï¼š** çº¦ 230-250 MiB

---

## ğŸ¯ æ¨èçš„å¼€å‘ç¯å¢ƒé…ç½®

### 1. å®‰è£…å¿…è¦ç»„ä»¶

```bash
# åŸºç¡€ç»„ä»¶ï¼ˆå·²é»˜è®¤å®‰è£…ï¼‰
rustup component add rustfmt
rustup component add clippy

# æ¨èé¢å¤–å®‰è£…
rustup component add rust-src        # IDE æ”¯æŒ
rustup component add rust-analyzer   # LSP æœåŠ¡å™¨
```

### 2. å®‰è£…å¸¸ç”¨å·¥å…·

```bash
# ç›‘å¬æ–‡ä»¶å˜åŒ–è‡ªåŠ¨ç¼–è¯‘
cargo install cargo-watch

# æ›´å¥½çš„é”™è¯¯ä¿¡æ¯æ˜¾ç¤º
cargo install cargo-expand

# ä¾èµ–ç®¡ç†
cargo install cargo-edit
cargo install cargo-outdated
cargo install cargo-audit

# æ€§èƒ½åˆ†æ
cargo install cargo-flamegraph
cargo install cargo-benchcmp
```

### 3. é…ç½®ç¼–è¾‘å™¨

**VS Codeï¼š**
```bash
# å®‰è£… rust-analyzer æ‰©å±•
code --install-extension rust-lang.rust-analyzer
```

**é…ç½®æ–‡ä»¶ï¼ˆ.vscode/settings.jsonï¼‰ï¼š**
```json
{
  "rust-analyzer.checkOnSave.command": "clippy",
  "rust-analyzer.cargo.features": "all",
  "editor.formatOnSave": true,
  "[rust]": {
    "editor.defaultFormatter": "rust-lang.rust-analyzer"
  }
}
```

---

## ğŸ” éªŒè¯å®‰è£…

è¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯æ‰€æœ‰å·¥å…·æ˜¯å¦æ­£ç¡®å®‰è£…ï¼š

```bash
# æ ¸å¿ƒå·¥å…·
rustc --version
cargo --version
rustup --version

# ç»„ä»¶
cargo fmt --version
cargo clippy --version
rustdoc --version

# æ£€æŸ¥å·²å®‰è£…ç»„ä»¶
rustup component list --installed

# æ£€æŸ¥å·¥å…·é“¾
rustup show
```

**é¢„æœŸè¾“å‡ºï¼š**
```
rustc 1.90.0 (11159782cd 2025-05-1d)
cargo 1.90.0 (11159782cd 2025-05-1d)
rustup 1.27.0 (2024-09-18)
rustfmt 1.7.0-stable (11159782cd 2025-05-1d)
clippy 0.1.80 (11159782cd 2025-05-1d)
rustdoc 1.90.0 (11159782cd 2025-05-1d)
```

---

## ğŸ”— ç›¸å…³èµ„æº

- [rustup å®˜æ–¹æ–‡æ¡£](https://rust-lang.github.io/rustup/)
- [cargo å®˜æ–¹æ–‡æ¡£](https://doc.rust-lang.org/cargo/)
- [rustc å®˜æ–¹æ–‡æ¡£](https://doc.rust-lang.org/rustc/)
- [The Cargo Book](https://doc.rust-lang.org/cargo/index.html)
- [crates.io](https://crates.io/) - Rust åŒ…ä»“åº“
- [rust-analyzer å®˜ç½‘](https://rust-analyzer.github.io/)
- [clippy lint åˆ—è¡¨](https://rust-lang.github.io/rust-clippy/master/)

---

**ç›¸å…³æ–‡æ¡£ï¼š**
- [Rust å­¦ä¹ è·¯çº¿](./å­¦ä¹ è·¯çº¿.mdx)
- [ä¸ºä»€ä¹ˆå­¦ä¹  Rust](./ä¸ºä»€ä¹ˆå­¦ä¹ Rust.mdx)

