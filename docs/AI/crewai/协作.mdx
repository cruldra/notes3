è¿™æ˜¯ CrewAI å®˜æ–¹æ–‡æ¡£ä¸­å…³äºâ€œCollaborationï¼ˆåä½œï¼‰â€éƒ¨åˆ†çš„ä¸­æ–‡ç¿»è¯‘ã€‚

---

# æ ¸å¿ƒæ¦‚å¿µ - åä½œ (Collaboration)

å¦‚ä½•è®©ä»£ç†ï¼ˆAgentsï¼‰ååŒå·¥ä½œã€å§”æ´¾ä»»åŠ¡å¹¶åœ¨ CrewAI å›¢é˜Ÿä¸­è¿›è¡Œæœ‰æ•ˆçš„æ²Ÿé€šã€‚

## æ¦‚è§ˆ (Overview)

CrewAI ä¸­çš„åä½œä¸ºä»£ç†æä¾›äº†å›¢é˜Ÿåˆä½œçš„èƒ½åŠ›ï¼Œå®ƒä»¬å¯ä»¥é€šè¿‡å§”æ´¾ä»»åŠ¡å’Œç›¸äº’æé—®æ¥åˆ©ç”¨å½¼æ­¤çš„ä¸“é•¿ã€‚å½“è®¾ç½® `allow_delegation=True` æ—¶ï¼Œä»£ç†å°†è‡ªåŠ¨è·å¾—å¼ºå¤§çš„åä½œå·¥å…·è®¿é—®æƒé™ã€‚

## å¿«é€Ÿå¼€å§‹ï¼šå¯ç”¨åä½œ (Quick Start: Enable Collaboration)

```python
from crewai import Agent, Crew, Task

# ä¸ºä»£ç†å¯ç”¨åä½œ
researcher = Agent(
    role="Research Specialist",
    goal="Conduct thorough research on any topic",
    backstory="Expert researcher with access to various sources",
    allow_delegation=True,  # ğŸ”‘ åä½œçš„å…³é”®è®¾ç½®
    verbose=True
)

writer = Agent(
    role="Content Writer",
    goal="Create engaging content based on research",
    backstory="Skilled writer who transforms research into compelling content",
    allow_delegation=True,  # ğŸ”‘ å…è®¸å‘å…¶ä»–ä»£ç†æé—®
    verbose=True
)

# ä»£ç†ç°åœ¨å¯ä»¥è‡ªåŠ¨åä½œ
crew = Crew(
    agents=[researcher, writer],
    tasks=[...],
    verbose=True
)
```

## ä»£ç†åä½œæ˜¯å¦‚ä½•å·¥ä½œçš„ (How Agent Collaboration Works)

å½“ `allow_delegation=True` æ—¶ï¼ŒCrewAI ä¼šè‡ªåŠ¨ä¸ºä»£ç†æä¾›ä¸¤ä¸ªå¼ºå¤§çš„å·¥å…·ï¼š

### 1. å§”æ´¾å·¥ä½œå·¥å…· (Delegate Work Tool)

å…è®¸ä»£ç†å°†ä»»åŠ¡åˆ†é…ç»™å…·æœ‰ç‰¹å®šä¸“é•¿çš„é˜Ÿå‹ã€‚

```python
# ä»£ç†è‡ªåŠ¨è·å¾—æ­¤å·¥å…·ï¼š
# Delegate work to coworker(task: str, context: str, coworker: str)
# (å§”æ´¾å·¥ä½œç»™åŒäº‹)
```

### 2. æé—®å·¥å…· (Ask Question Tool)

ä½¿ä»£ç†èƒ½å¤Ÿå‘åŒäº‹æå‡ºå…·ä½“é—®é¢˜ä»¥æ”¶é›†ä¿¡æ¯ã€‚

```python
# ä»£ç†è‡ªåŠ¨è·å¾—æ­¤å·¥å…·ï¼š
# Ask question to coworker(question: str, context: str, coworker: str)
# (å‘åŒäº‹æé—®)
```

## å®æˆ˜ä¸­çš„åä½œ (Collaboration in Action)

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ï¼Œå±•ç¤ºäº†ä»£ç†åœ¨å†…å®¹åˆ›ä½œä»»åŠ¡ä¸­çš„åä½œï¼š

```python
from crewai import Agent, Crew, Task, Process

# åˆ›å»ºåä½œä»£ç†
researcher = Agent(
    role="Research Specialist",
    goal="Find accurate, up-to-date information on any topic",
    backstory="""You're a meticulous researcher with expertise in finding
    reliable sources and fact-checking information across various domains.""",
    allow_delegation=True,
    verbose=True
)

writer = Agent(
    role="Content Writer",
    goal="Create engaging, well-structured content",
    backstory="""You're a skilled content writer who excels at transforming
    research into compelling, readable content for different audiences.""",
    allow_delegation=True,
    verbose=True
)

editor = Agent(
    role="Content Editor",
    goal="Ensure content quality and consistency",
    backstory="""You're an experienced editor with an eye for detail,
    ensuring content meets high standards for clarity and accuracy.""",
    allow_delegation=True,
    verbose=True
)

# åˆ›å»ºä¸€ä¸ªé¼“åŠ±åä½œçš„ä»»åŠ¡
article_task = Task(
    description="""Write a comprehensive 1000-word article about 'The Future of AI in Healthcare'.

    The article should include:
    - Current AI applications in healthcare
    - Emerging trends and technologies
    - Potential challenges and ethical considerations
    - Expert predictions for the next 5 years

    Collaborate with your teammates to ensure accuracy and quality.""",
    expected_output="A well-researched, engaging 1000-word article with proper structure and citations",
    agent=writer  # ä½œå®¶ä¸»å¯¼ï¼Œä½†å¯ä»¥å°†ç ”ç©¶å·¥ä½œå§”æ´¾ç»™ç ”ç©¶å‘˜
)

# åˆ›å»ºåä½œå›¢é˜Ÿ
crew = Crew(
    agents=[researcher, writer, editor],
    tasks=[article_task],
    process=Process.sequential,
    verbose=True
)

result = crew.kickoff()
```

## åä½œæ¨¡å¼ (Collaboration Patterns)

### æ¨¡å¼ 1ï¼šç ”ç©¶ â†’ å†™ä½œ â†’ ç¼–è¾‘ (Research â†’ Write â†’ Edit)

```python
research_task = Task(
    description="Research the latest developments in quantum computing",
    expected_output="Comprehensive research summary with key findings and sources",
    agent=researcher
)

writing_task = Task(
    description="Write an article based on the research findings",
    expected_output="Engaging 800-word article about quantum computing",
    agent=writer,
    context=[research_task]  # è·å–ç ”ç©¶è¾“å‡ºä½œä¸ºä¸Šä¸‹æ–‡
)

editing_task = Task(
    description="Edit and polish the article for publication",
    expected_output="Publication-ready article with improved clarity and flow",
    agent=editor,
    context=[writing_task]  # è·å–æ–‡ç« è‰ç¨¿ä½œä¸ºä¸Šä¸‹æ–‡
)
```

### æ¨¡å¼ 2ï¼šåä½œå•ä»»åŠ¡ (Collaborative Single Task)

```python
collaborative_task = Task(
    description="""Create a marketing strategy for a new AI product.

    Writer: Focus on messaging and content strategy
    Researcher: Provide market analysis and competitor insights

    Work together to create a comprehensive strategy.""",
    expected_output="Complete marketing strategy with research backing",
    agent=writer  # é¦–å¸­ä»£ç†ï¼Œä½†å¯ä»¥å§”æ´¾ç»™ç ”ç©¶å‘˜
)
```

## å±‚çº§åä½œ (Hierarchical Collaboration)

å¯¹äºå¤æ‚çš„é¡¹ç›®ï¼Œè¯·ä½¿ç”¨å¸¦æœ‰ç®¡ç†ä»£ç†ï¼ˆManager Agentï¼‰çš„å±‚çº§æµç¨‹ï¼š

```python
from crewai import Agent, Crew, Task, Process

# ç®¡ç†ä»£ç†åè°ƒå›¢é˜Ÿ
manager = Agent(
    role="Project Manager",
    goal="Coordinate team efforts and ensure project success",
    backstory="Experienced project manager skilled at delegation and quality control",
    allow_delegation=True,
    verbose=True
)

# ä¸“å®¶ä»£ç†
researcher = Agent(
    role="Researcher",
    goal="Provide accurate research and analysis",
    backstory="Expert researcher with deep analytical skills",
    allow_delegation=False,  # ä¸“å®¶ä¸“æ³¨äºä»–ä»¬çš„ä¸“é•¿
    verbose=True
)

writer = Agent(
    role="Writer",
    goal="Create compelling content",
    backstory="Skilled writer who creates engaging content",
    allow_delegation=False,
    verbose=True
)

# ç»ç†ä¸»å¯¼çš„ä»»åŠ¡
project_task = Task(
    description="Create a comprehensive market analysis report with recommendations",
    expected_output="Executive summary, detailed analysis, and strategic recommendations",
    agent=manager  # ç»ç†å°†å§”æ´¾ç»™ä¸“å®¶
)

# å±‚çº§å›¢é˜Ÿ
crew = Crew(
    agents=[manager, researcher, writer],
    tasks=[project_task],
    process=Process.hierarchical,  # ç»ç†åè°ƒä¸€åˆ‡
    manager_llm="gpt-4o",  # ä¸ºç»ç†æŒ‡å®š LLM
    verbose=True
)
```

## åä½œçš„æœ€ä½³å®è·µ (Best Practices for Collaboration)

### 1. æ¸…æ™°çš„è§’è‰²å®šä¹‰

```python
# âœ… å¥½ï¼šå…·ä½“ã€äº’è¡¥çš„è§’è‰²
researcher = Agent(role="Market Research Analyst", ...)
writer = Agent(role="Technical Content Writer", ...)

# âŒ é¿å…ï¼šé‡å æˆ–æ¨¡ç³Šçš„è§’è‰²
agent1 = Agent(role="General Assistant", ...)
agent2 = Agent(role="Helper", ...)
```

### 2. ç­–ç•¥æ€§åœ°å¯ç”¨å§”æ´¾

```python
# âœ… ä¸ºåè°ƒè€…å’Œé€šæ‰å¯ç”¨å§”æ´¾
lead_agent = Agent(
    role="Content Lead",
    allow_delegation=True,  # å¯ä»¥å§”æ´¾ç»™ä¸“å®¶
    ...
)

# âœ… ä¸ºä¸“æ³¨çš„ä¸“å®¶ç¦ç”¨ï¼ˆå¯é€‰ï¼‰
specialist_agent = Agent(
    role="Data Analyst",
    allow_delegation=False,  # ä¸“æ³¨äºæ ¸å¿ƒä¸“é•¿
    ...
)
```

### 3. ä¸Šä¸‹æ–‡å…±äº«

```python
# âœ… ä½¿ç”¨ context å‚æ•°å¤„ç†ä»»åŠ¡ä¾èµ–
writing_task = Task(
    description="Write article based on research",
    agent=writer,
    context=[research_task],  # å…±äº«ç ”ç©¶ç»“æœ
    ...
)
```

### 4. æ¸…æ™°çš„ä»»åŠ¡æè¿°

```python
# âœ… å…·ä½“ã€å¯æ“ä½œçš„æè¿°
Task(
    description="""Research competitors in the AI chatbot space.
    Focus on: pricing models, key features, target markets.
    Provide data in a structured format.""",
    ...
)

# âŒ æ¨¡ç³Šçš„æè¿°ï¼Œæ— æ³•å¼•å¯¼åä½œ
Task(description="Do some research about chatbots", ...)
```

## åä½œæ•…éšœæ’é™¤ (Troubleshooting Collaboration)

### é—®é¢˜ï¼šä»£ç†ä¸åä½œ

**ç—‡çŠ¶ï¼š** ä»£ç†å„è‡ªä¸ºæˆ˜ï¼Œæ²¡æœ‰å‘ç”Ÿå§”æ´¾ã€‚

```python
# âœ… è§£å†³æ–¹æ¡ˆï¼šç¡®ä¿å¯ç”¨äº†å§”æ´¾
agent = Agent(
    role="...",
    allow_delegation=True,  # è¿™æ˜¯å¿…é¡»çš„ï¼
    ...
)
```

### é—®é¢˜ï¼šåå¤äº¤äº’å¤ªå¤š

**ç—‡çŠ¶ï¼š** ä»£ç†æå‡ºè¿‡å¤šé—®é¢˜ï¼Œè¿›åº¦ç¼“æ…¢ã€‚

```python
# âœ… è§£å†³æ–¹æ¡ˆï¼šæä¾›æ›´å¥½çš„ä¸Šä¸‹æ–‡å’Œå…·ä½“çš„è§’è‰²
Task(
    description="""Write a technical blog post about machine learning.

    Context: Target audience is software developers with basic ML knowledge.
    Length: 1200 words
    Include: code examples, practical applications, best practices

    If you need specific technical details, delegate research to the researcher.""",
    ...
)
```

### é—®é¢˜ï¼šå§”æ´¾æ­»å¾ªç¯

**ç—‡çŠ¶ï¼š** ä»£ç†ä¹‹é—´æ— é™æœŸåœ°é€šè¿‡å§”æ´¾ç›¸äº’æ¨è¯¿ã€‚

```python
# âœ… è§£å†³æ–¹æ¡ˆï¼šæ¸…æ™°çš„å±‚çº§å’ŒèŒè´£
manager = Agent(role="Manager", allow_delegation=True)
specialist1 = Agent(role="Specialist A", allow_delegation=False)  # ç¦æ­¢å†æ¬¡å§”æ´¾
specialist2 = Agent(role="Specialist B", allow_delegation=False)
```

## é«˜çº§åä½œåŠŸèƒ½ (Advanced Collaboration Features)

### è‡ªå®šä¹‰åä½œè§„åˆ™

```python
# åœ¨ä»£ç†èƒŒæ™¯æ•…äº‹ä¸­è®¾ç½®ç‰¹å®šçš„åä½œå‡†åˆ™
agent = Agent(
    role="Senior Developer",
    backstory="""You lead development projects and coordinate with team members.

    Collaboration guidelines:
    - Delegate research tasks to the Research Analyst
    - Ask the Designer for UI/UX guidance
    - Consult the QA Engineer for testing strategies
    - Only escalate blocking issues to the Project Manager""",
    allow_delegation=True
)
```

### ç›‘æ§åä½œ

```python
def track_collaboration(output):
    """è¿½è¸ªåä½œæ¨¡å¼"""
    if "Delegate work to coworker" in output.raw:
        print("ğŸ¤ Delegation occurred")
    if "Ask question to coworker" in output.raw:
        print("â“ Question asked")

crew = Crew(
    agents=[...],
    tasks=[...],
    step_callback=track_collaboration,  # ç›‘æ§åä½œ
    verbose=True
)
```

## è®°å¿†ä¸å­¦ä¹  (Memory and Learning)

è®©ä»£ç†è®°ä½è¿‡å»çš„åä½œï¼š

```python
agent = Agent(
    role="Content Lead",
    memory=True,  # è®°ä½è¿‡å»çš„äº’åŠ¨
    allow_delegation=True,
    verbose=True
)
```

å¯ç”¨è®°å¿†åï¼Œä»£ç†ä¼šä»ä»¥å‰çš„åä½œä¸­å­¦ä¹ ï¼Œå¹¶éšç€æ—¶é—´çš„æ¨ç§»æ”¹è¿›å…¶å§”æ´¾å†³ç­–ã€‚

## ä¸‹ä¸€æ­¥ (Next Steps)

*   **å°è¯•ç¤ºä¾‹**ï¼šä»åŸºæœ¬çš„åä½œç¤ºä¾‹å¼€å§‹ã€‚
*   **å®éªŒè§’è‰²**ï¼šæµ‹è¯•ä¸åŒçš„ä»£ç†è§’è‰²ç»„åˆã€‚
*   **ç›‘æ§äº¤äº’**ï¼šä½¿ç”¨ `verbose=True` æŸ¥çœ‹åä½œè¿‡ç¨‹ã€‚
*   **ä¼˜åŒ–ä»»åŠ¡æè¿°**ï¼šæ¸…æ™°çš„ä»»åŠ¡å¸¦æ¥æ›´å¥½çš„åä½œã€‚
*   **æ‰©å±•è§„æ¨¡**ï¼šå¯¹å¤æ‚çš„é¡¹ç›®å°è¯•å±‚çº§æµç¨‹ã€‚

åä½œå°†å•ä¸ª AI ä»£ç†è½¬å˜ä¸ºå¼ºå¤§çš„å›¢é˜Ÿï¼Œå¯ä»¥å…±åŒåº”å¯¹å¤æ‚ã€å¤šæ–¹é¢çš„æŒ‘æˆ˜ã€‚