<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-AI/CrewAI/事件监听器" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">事件监听器 | Cruldra</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/notes3/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/notes3/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/notes3/docs/AI/CrewAI/事件监听器"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="事件监听器 | Cruldra"><meta data-rh="true" name="description" content="这是 CrewAI 官方文档中关于“Event Listeners（事件监听器）”部分的中文翻译。"><meta data-rh="true" property="og:description" content="这是 CrewAI 官方文档中关于“Event Listeners（事件监听器）”部分的中文翻译。"><link data-rh="true" rel="icon" href="/notes3/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/notes3/docs/AI/CrewAI/事件监听器"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/notes3/docs/AI/CrewAI/事件监听器" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/notes3/docs/AI/CrewAI/事件监听器" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"事件监听器","item":"https://your-docusaurus-site.example.com/notes3/docs/AI/CrewAI/事件监听器"}]}</script><link rel="alternate" type="application/rss+xml" href="/notes3/blog/rss.xml" title="Cruldra RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/notes3/blog/atom.xml" title="Cruldra Atom Feed"><link rel="stylesheet" href="/notes3/assets/css/styles.8c4657fb.css">
<script src="/notes3/assets/js/runtime~main.69ef4660.js" defer="defer"></script>
<script src="/notes3/assets/js/main.09658b62.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme",window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-theme-choice","system"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/notes3/img/logo.svg"><style data-mantine-styles="classes">@media (max-width: 35.99375em) {.mantine-visible-from-xs {display: none !important;}}@media (min-width: 36em) {.mantine-hidden-from-xs {display: none !important;}}@media (max-width: 47.99375em) {.mantine-visible-from-sm {display: none !important;}}@media (min-width: 48em) {.mantine-hidden-from-sm {display: none !important;}}@media (max-width: 61.99375em) {.mantine-visible-from-md {display: none !important;}}@media (min-width: 62em) {.mantine-hidden-from-md {display: none !important;}}@media (max-width: 74.99375em) {.mantine-visible-from-lg {display: none !important;}}@media (min-width: 75em) {.mantine-hidden-from-lg {display: none !important;}}@media (max-width: 87.99375em) {.mantine-visible-from-xl {display: none !important;}}@media (min-width: 88em) {.mantine-hidden-from-xl {display: none !important;}}</style><div role="region" aria-label="Skip to main content"><a class="skipToContent_aA1M" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/notes3/"><div class="navbar__logo"><img src="/notes3/img/logo.svg" alt="My Site Logo" class="themedComponent_E3Xm themedComponent--light_DVqC"><img src="/notes3/img/logo.svg" alt="My Site Logo" class="themedComponent_E3Xm themedComponent--dark_B_L3"></div><b class="navbar__title text--truncate">Cruldra</b></a><a class="navbar__item navbar__link" href="/notes3/docs/category/设计模式">JVM</a><a class="navbar__item navbar__link" href="/notes3/docs/category/css">前端</a><a class="navbar__item navbar__link" href="/notes3/docs/category/astrbot">工具</a><a class="navbar__item navbar__link" href="/notes3/docs/category/ai电竞酒店">个人</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/notes3/docs/AI/Agno/介绍">AI</a><a class="navbar__item navbar__link" href="/notes3/docs/category/内置模块">Python</a><a class="navbar__item navbar__link" href="/notes3/docs/category/actix-web">Rust</a><a class="navbar__item navbar__link" href="/notes3/docs/category/数据库系统">软件工程</a><a class="navbar__item navbar__link" href="/notes3/docs/category/上古卷轴5">游戏</a><a class="navbar__item navbar__link" href="/notes3/docs/Go/Go-Python-Java三语言全方位对比">Go</a><a class="navbar__item navbar__link" href="/notes3/docs/Hardware/intro">硬件</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_PufJ"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_ctfR"><div class="docsWrapper_ByIB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_KwvU" type="button"></button><div class="docRoot_hD6z"><aside class="theme-doc-sidebar-container docSidebarContainer_KuHC"><div class="sidebarViewport_LCjr"><div class="sidebar_L77d"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_VYAF"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/Agno/介绍"><span title="Agno" class="categoryLinkLabel_FHN4">Agno</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/notes3/docs/AI/CrewAI/CLI"><span title="CrewAI" class="categoryLinkLabel_FHN4">CrewAI</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/AI/CrewAI/CLI"><span title="CLI" class="linkLabel__RqX">CLI</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/notes3/docs/AI/CrewAI/事件监听器"><span title="事件监听器" class="linkLabel__RqX">事件监听器</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/AI/CrewAI/任务"><span title="任务" class="linkLabel__RqX">任务</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/AI/CrewAI/协作"><span title="协作" class="linkLabel__RqX">协作</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/notes3/docs/AI/CrewAI/可观测性/MLflow"><span title="可观测性" class="categoryLinkLabel_FHN4">可观测性</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/AI/CrewAI/命名哲学"><span title="命名哲学" class="linkLabel__RqX">命名哲学</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/AI/CrewAI/团队"><span title="团队" class="linkLabel__RqX">团队</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/notes3/docs/AI/CrewAI/学习/模型选择指南"><span title="学习" class="categoryLinkLabel_FHN4">学习</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/AI/CrewAI/工作流"><span title="工作流" class="linkLabel__RqX">工作流</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/AI/CrewAI/工具"><span title="工具" class="linkLabel__RqX">工具</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/AI/CrewAI/快速开始"><span title="快速开始" class="linkLabel__RqX">快速开始</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/AI/CrewAI/执行流程"><span title="执行流程" class="linkLabel__RqX">执行流程</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/AI/CrewAI/推理"><span title="推理" class="linkLabel__RqX">推理</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/AI/CrewAI/智能体"><span title="智能体" class="linkLabel__RqX">智能体</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/AI/CrewAI/知识库"><span title="知识库" class="linkLabel__RqX">知识库</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/AI/CrewAI/简介"><span title="什么是 CrewAI?" class="linkLabel__RqX">什么是 CrewAI?</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/AI/CrewAI/训练"><span title="训练" class="linkLabel__RqX">训练</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/AI/CrewAI/记忆"><span title="记忆" class="linkLabel__RqX">记忆</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/DALLE成本计算"><span title="DALL-E 画图成本计算" class="linkLabel__RqX">DALL-E 画图成本计算</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/MCP/MCP-Python-SDK"><span title="MCP" class="categoryLinkLabel_FHN4">MCP</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/Transformer"><span title="Transformer" class="linkLabel__RqX">Transformer</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist" href="/notes3/docs/AI/vllm"><span title="vLLM 学习资料" class="categoryLinkLabel_FHN4">vLLM 学习资料</span></a><button aria-label="Expand sidebar category &#x27;vLLM 学习资料&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/一些概念1"><span title="一些概念1" class="linkLabel__RqX">一些概念1</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/一些概念2"><span title="一些概念2" class="linkLabel__RqX">一些概念2</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/一些概念3"><span title="一些概念3" class="linkLabel__RqX">一些概念3</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/一些概念4"><span title="一些概念4" class="linkLabel__RqX">一些概念4</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/一些概念5"><span title="一些概念5" class="linkLabel__RqX">一些概念5</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/候选模型"><span title="候选模型" class="linkLabel__RqX">候选模型</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/变分自编码器详解"><span title="变分自编码器（VAE）详解" class="linkLabel__RqX">变分自编码器（VAE）详解</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/大模型核心概念通俗解释"><span title="大模型核心概念通俗解释" class="linkLabel__RqX">大模型核心概念通俗解释</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/大模型训练中的随机种子：为什么需要它？"><span title="大模型训练中的随机种子：为什么需要它？" class="linkLabel__RqX">大模型训练中的随机种子：为什么需要它？</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/嵌入和向量/Chroma与PGVector对比"><span title="嵌入和向量" class="categoryLinkLabel_FHN4">嵌入和向量</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/感知机"><span title="感知机" class="linkLabel__RqX">感知机</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/提示词工程/DSPy/API/优化器/BetterTogether"><span title="提示词工程" class="categoryLinkLabel_FHN4">提示词工程</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/智能体"><span title="智能体(Agent)" class="linkLabel__RqX">智能体(Agent)</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/深度学习/入门"><span title="深度学习" class="categoryLinkLabel_FHN4">深度学习</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/理解大模型：从函数视角看AI的本质"><span title="理解大模型：从函数视角看AI的本质" class="linkLabel__RqX">理解大模型：从函数视角看AI的本质</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/知识蒸馏"><span title="知识蒸馏" class="linkLabel__RqX">知识蒸馏</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/联邦学习概念"><span title="联邦学习概念" class="linkLabel__RqX">联邦学习概念</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/通义千问/阿里云百炼"><span title="通义千问" class="categoryLinkLabel_FHN4">通义千问</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/金丝雀发布和AB测试"><span title="金丝雀发布和AB测试" class="linkLabel__RqX">金丝雀发布和AB测试</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_WxcZ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_Zd2x"><div class="docItemContainer_EEW4"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_xL_w" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/notes3/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_zA1U"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">CrewAI</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">事件监听器</span></li></ul></nav><div class="tocCollapsible_aZGz theme-doc-toc-mobile tocMobile_ShCt"><button type="button" class="clean-btn tocCollapsibleButton_fxzH">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>事件监听器</h1></header><p>这是 CrewAI 官方文档中关于“Event Listeners（事件监听器）”部分的中文翻译。</p>
<hr>
<h1>核心概念 - 事件监听器 (Event Listeners)</h1>
<p>利用 CrewAI 事件来构建自定义集成和监控。</p>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="概览-overview">概览 (Overview)<a href="#概览-overview" class="hash-link" aria-label="Direct link to 概览 (Overview)" title="Direct link to 概览 (Overview)" translate="no">​</a></h2>
<p>CrewAI 提供了一个强大的事件系统，允许你监听并响应 Crew 执行过程中发生的各种事件。此功能使你能够构建自定义集成、监控解决方案、日志系统，或任何其他需要基于 CrewAI 内部事件触发的功能。</p>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="工作原理-how-it-works">工作原理 (How It Works)<a href="#工作原理-how-it-works" class="hash-link" aria-label="Direct link to 工作原理 (How It Works)" title="Direct link to 工作原理 (How It Works)" translate="no">​</a></h2>
<p>CrewAI 使用事件总线架构在整个执行生命周期中发出事件。该事件系统建立在以下组件之上：</p>
<ol>
<li class=""><strong>CrewAIEventsBus</strong>：一个单例事件总线，管理事件的注册和发射。</li>
<li class=""><strong>BaseEvent</strong>：系统中所有事件的基类。</li>
<li class=""><strong>BaseEventListener</strong>：用于创建自定义事件监听器的抽象基类。</li>
</ol>
<p>当 CrewAI 中发生特定操作时（例如 Crew 开始执行、Agent 完成任务或使用了工具），系统会发出相应的事件。你可以注册这些事件的处理程序，以便在事件发生时执行自定义代码。</p>
<p>CrewAI AOP 提供了一个内置的 <strong>Prompt Tracing（提示词追踪）</strong> 功能，利用事件系统来跟踪、存储和可视化所有提示词、补全及其关联的元数据。这为你的 Agent 操作提供了强大的调试能力和透明度。</p>
<p><img decoding="async" loading="lazy" src="https://mintcdn.com/crewai/Tp3HEbbp9mp-dy3H/images/enterprise/traces-overview.png?fit=max&amp;auto=format&amp;n=Tp3HEbbp9mp-dy3H&amp;q=85&amp;s=9c02d5b7306bf7adaeadd77a018f8fea" alt="Prompt Tracing Dashboard" class="img_kBI4"></p>
<p>通过提示词追踪，你可以：</p>
<ul>
<li class="">查看发送给 LLM 的所有提示词的完整历史记录</li>
<li class="">追踪 Token 使用量和成本</li>
<li class="">调试 Agent 推理失败的问题</li>
<li class="">与团队分享提示词序列</li>
<li class="">比较不同的提示词策略</li>
<li class="">导出追踪记录以用于合规和审计</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="创建自定义事件监听器-creating-a-custom-event-listener">创建自定义事件监听器 (Creating a Custom Event Listener)<a href="#创建自定义事件监听器-creating-a-custom-event-listener" class="hash-link" aria-label="Direct link to 创建自定义事件监听器 (Creating a Custom Event Listener)" title="Direct link to 创建自定义事件监听器 (Creating a Custom Event Listener)" translate="no">​</a></h2>
<p>要创建一个自定义事件监听器，你需要：</p>
<ol>
<li class="">创建一个继承自 <code>BaseEventListener</code> 的类。</li>
<li class="">实现 <code>setup_listeners</code> 方法。</li>
<li class="">为你感兴趣的事件注册处理程序。</li>
<li class="">在适当的文件中创建你的监听器实例。</li>
</ol>
<p>以下是一个简单的自定义事件监听器类示例：</p>
<div class="language-python codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-python codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> crewai</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">events </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CrewKickoffStartedEvent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CrewKickoffCompletedEvent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AgentExecutionCompletedEvent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> crewai</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">events </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> BaseEventListener</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">MyCustomListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">BaseEventListener</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setup_listeners</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> crewai_event_bus</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token decorator annotation punctuation" style="color:#393A34">@crewai_event_bus</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CrewKickoffStartedEvent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">on_crew_started</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Crew &#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">event</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">crew_name</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&#x27; bas started execution!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token decorator annotation punctuation" style="color:#393A34">@crewai_event_bus</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CrewKickoffCompletedEvent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">on_crew_completed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Crew &#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">event</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">crew_name</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&#x27; has completed execution!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Output: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">event</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">output</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token decorator annotation punctuation" style="color:#393A34">@crewai_event_bus</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">AgentExecutionCompletedEvent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">on_agent_execution_completed</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Agent &#x27;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">event</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">agent</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">role</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&#x27; completed task&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Output: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">event</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">output</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="正确注册你的监听器-properly-registering-your-listener">正确注册你的监听器 (Properly Registering Your Listener)<a href="#正确注册你的监听器-properly-registering-your-listener" class="hash-link" aria-label="Direct link to 正确注册你的监听器 (Properly Registering Your Listener)" title="Direct link to 正确注册你的监听器 (Properly Registering Your Listener)" translate="no">​</a></h2>
<p>仅仅定义你的监听器类是不够的。你需要创建一个它的实例，并确保在你的应用程序中导入它。这能确保：</p>
<ol>
<li class="">事件处理程序被注册到事件总线上。</li>
<li class="">监听器实例如终保留在内存中（不被垃圾回收）。</li>
<li class="">当事件发出时，监听器处于活动状态。</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="选项-1在你的-crew-或-flow-实现中导入并实例化">选项 1：在你的 Crew 或 Flow 实现中导入并实例化<a href="#选项-1在你的-crew-或-flow-实现中导入并实例化" class="hash-link" aria-label="Direct link to 选项 1：在你的 Crew 或 Flow 实现中导入并实例化" title="Direct link to 选项 1：在你的 Crew 或 Flow 实现中导入并实例化" translate="no">​</a></h3>
<p>最重要的事是在定义和执行 Crew 或 Flow 的文件中创建监听器的实例：</p>
<h4 class="anchor anchorTargetStickyNavbar_aDle" id="对于基于-crew-的应用程序">对于基于 Crew 的应用程序<a href="#对于基于-crew-的应用程序" class="hash-link" aria-label="Direct link to 对于基于 Crew 的应用程序" title="Direct link to 对于基于 Crew 的应用程序" translate="no">​</a></h4>
<p>在你的 Crew 实现文件的顶部创建并导入你的监听器：</p>
<div class="language-python codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-python codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 在你的 crew.py 文件中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> crewai </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Agent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Crew</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> my_listeners </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> MyCustomListener</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 创建你的监听器实例</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">my_listener </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> MyCustomListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">MyCustomCrew</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 你的 crew 实现...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">crew</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> Crew</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            agents</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            tasks</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_aDle" id="对于基于-flow-的应用程序">对于基于 Flow 的应用程序<a href="#对于基于-flow-的应用程序" class="hash-link" aria-label="Direct link to 对于基于 Flow 的应用程序" title="Direct link to 对于基于 Flow 的应用程序" translate="no">​</a></h4>
<p>在你的 Flow 实现文件的顶部创建并导入你的监听器：</p>
<div class="language-python codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-python codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 在你的 main.py 或 flow.py 文件中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> crewai</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">flow </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Flow</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> listen</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> my_listeners </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> MyCustomListener</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 创建你的监听器实例</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">my_listener </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> MyCustomListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">MyCustomFlow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Flow</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 你的 flow 实现...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@start</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">first_step</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># ...</span><br></span></code></pre></div></div>
<p>这确保了当你的 Crew 或 Flow 执行时，监听器已被加载并激活。</p>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="选项-2为你的监听器创建一个包">选项 2：为你的监听器创建一个包<a href="#选项-2为你的监听器创建一个包" class="hash-link" aria-label="Direct link to 选项 2：为你的监听器创建一个包" title="Direct link to 选项 2：为你的监听器创建一个包" translate="no">​</a></h3>
<p>若要采用更结构化的方法，特别是当你包含多个监听器时：</p>
<ol>
<li class="">为你的监听器创建一个包：</li>
</ol>
<div class="language-text codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-text codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">my_project/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├── listeners/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   ├── __init__.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   ├── my_custom_listener.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  │   └── another_listener.py</span><br></span></code></pre></div></div>
<ol start="2">
<li class="">在 <code>my_custom_listener.py</code> 中，定义你的监听器类并创建一个实例：</li>
</ol>
<div class="language-python codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-python codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># my_custom_listener.py</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> crewai</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">events </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> BaseEventListener</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># ... 导入事件 ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">MyCustomListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">BaseEventListener</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># ... 实现 ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 创建你的监听器实例</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">my_custom_listener </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> MyCustomListener</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<ol start="3">
<li class="">在 <code>__init__.py</code> 中，导入监听器实例以确保它们被加载：</li>
</ol>
<div class="language-python codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-python codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># __init__.py</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">my_custom_listener </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> my_custom_listener</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">another_listener </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> another_listener</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 如果你需要在其他地方访问它们，可以选择导出它们</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">__all__ </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;my_custom_listener&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;another_listener&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre></div></div>
<ol start="4">
<li class="">在你的 Crew 或 Flow 文件中导入你的监听器包：</li>
</ol>
<div class="language-python codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-python codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 在你的 crew.py 或 flow.py 文件中</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> my_project</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">listeners  </span><span class="token comment" style="color:#999988;font-style:italic"># 这会加载你所有的监听器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">MyCustomCrew</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 你的 crew 实现...</span><br></span></code></pre></div></div>
<p>这就是 CrewAI 代码库中注册第三方事件监听器的方式。</p>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="可用的事件类型-available-event-types">可用的事件类型 (Available Event Types)<a href="#可用的事件类型-available-event-types" class="hash-link" aria-label="Direct link to 可用的事件类型 (Available Event Types)" title="Direct link to 可用的事件类型 (Available Event Types)" translate="no">​</a></h2>
<p>CrewAI 提供了广泛的事件供你监听：</p>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="crew-事件">Crew 事件<a href="#crew-事件" class="hash-link" aria-label="Direct link to Crew 事件" title="Direct link to Crew 事件" translate="no">​</a></h3>
<ul>
<li class=""><strong>CrewKickoffStartedEvent</strong>：Crew 开始执行时发出</li>
<li class=""><strong>CrewKickoffCompletedEvent</strong>：Crew 完成执行时发出</li>
<li class=""><strong>CrewKickoffFailedEvent</strong>：Crew 执行失败时发出</li>
<li class=""><strong>CrewTestStartedEvent</strong>：Crew 开始测试时发出</li>
<li class=""><strong>CrewTestCompletedEvent</strong>：Crew 完成测试时发出</li>
<li class=""><strong>CrewTestFailedEvent</strong>：Crew 测试失败时发出</li>
<li class=""><strong>CrewTrainStartedEvent</strong>：Crew 开始训练时发出</li>
<li class=""><strong>CrewTrainCompletedEvent</strong>：Crew 完成训练时发出</li>
<li class=""><strong>CrewTrainFailedEvent</strong>：Crew 训练失败时发出</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="agent-事件">Agent 事件<a href="#agent-事件" class="hash-link" aria-label="Direct link to Agent 事件" title="Direct link to Agent 事件" translate="no">​</a></h3>
<ul>
<li class=""><strong>AgentExecutionStartedEvent</strong>：Agent 开始执行任务时发出</li>
<li class=""><strong>AgentExecutionCompletedEvent</strong>：Agent 完成执行任务时发出</li>
<li class=""><strong>AgentExecutionErrorEvent</strong>：Agent 在执行过程中遇到错误时发出</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="task-事件">Task 事件<a href="#task-事件" class="hash-link" aria-label="Direct link to Task 事件" title="Direct link to Task 事件" translate="no">​</a></h3>
<ul>
<li class=""><strong>TaskStartedEvent</strong>：Task 开始执行时发出</li>
<li class=""><strong>TaskCompletedEvent</strong>：Task 完成执行时发出</li>
<li class=""><strong>TaskFailedEvent</strong>：Task 执行失败时发出</li>
<li class=""><strong>TaskEvaluationEvent</strong>：Task 被评估时发出</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="工具使用事件">工具使用事件<a href="#工具使用事件" class="hash-link" aria-label="Direct link to 工具使用事件" title="Direct link to 工具使用事件" translate="no">​</a></h3>
<ul>
<li class=""><strong>ToolUsageStartedEvent</strong>：工具开始执行时发出</li>
<li class=""><strong>ToolUsageFinishedEvent</strong>：工具完成执行时发出</li>
<li class=""><strong>ToolUsageErrorEvent</strong>：工具执行遇到错误时发出</li>
<li class=""><strong>ToolValidateInputErrorEvent</strong>：工具输入验证遇到错误时发出</li>
<li class=""><strong>ToolExecutionErrorEvent</strong>：工具执行遇到错误时发出</li>
<li class=""><strong>ToolSelectionErrorEvent</strong>：选择工具时发生错误时发出</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="知识库事件">知识库事件<a href="#知识库事件" class="hash-link" aria-label="Direct link to 知识库事件" title="Direct link to 知识库事件" translate="no">​</a></h3>
<ul>
<li class=""><strong>KnowledgeRetrievalStartedEvent</strong>：知识检索开始时发出</li>
<li class=""><strong>KnowledgeRetrievalCompletedEvent</strong>：知识检索完成时发出</li>
<li class=""><strong>KnowledgeQueryStartedEvent</strong>：知识查询开始时发出</li>
<li class=""><strong>KnowledgeQueryCompletedEvent</strong>：知识查询完成时发出</li>
<li class=""><strong>KnowledgeQueryFailedEvent</strong>：知识查询失败时发出</li>
<li class=""><strong>KnowledgeSearchQueryFailedEvent</strong>：知识搜索查询失败时发出</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="llm-护栏-guardrail-事件">LLM 护栏 (Guardrail) 事件<a href="#llm-护栏-guardrail-事件" class="hash-link" aria-label="Direct link to LLM 护栏 (Guardrail) 事件" title="Direct link to LLM 护栏 (Guardrail) 事件" translate="no">​</a></h3>
<ul>
<li class=""><strong>LLMGuardrailStartedEvent</strong>：护栏验证开始时发出。包含有关正在应用的护栏和重试次数的详细信息。</li>
<li class=""><strong>LLMGuardrailCompletedEvent</strong>：护栏验证完成时发出。包含有关验证成功/失败、结果以及错误消息（如果有）的详细信息。</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="flow-事件">Flow 事件<a href="#flow-事件" class="hash-link" aria-label="Direct link to Flow 事件" title="Direct link to Flow 事件" translate="no">​</a></h3>
<ul>
<li class=""><strong>FlowCreatedEvent</strong>：Flow 被创建时发出</li>
<li class=""><strong>FlowStartedEvent</strong>：Flow 开始执行时发出</li>
<li class=""><strong>FlowFinishedEvent</strong>：Flow 完成执行时发出</li>
<li class=""><strong>FlowPlotEvent</strong>：Flow 被绘制图表时发出</li>
<li class=""><strong>MethodExecutionStartedEvent</strong>：Flow 方法开始执行时发出</li>
<li class=""><strong>MethodExecutionFinishedEvent</strong>：Flow 方法完成执行时发出</li>
<li class=""><strong>MethodExecutionFailedEvent</strong>：Flow 方法执行失败时发出</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="llm-事件">LLM 事件<a href="#llm-事件" class="hash-link" aria-label="Direct link to LLM 事件" title="Direct link to LLM 事件" translate="no">​</a></h3>
<ul>
<li class=""><strong>LLMCallStartedEvent</strong>：LLM 调用开始时发出</li>
<li class=""><strong>LLMCallCompletedEvent</strong>：LLM 调用完成时发出</li>
<li class=""><strong>LLMCallFailedEvent</strong>：LLM 调用失败时发出</li>
<li class=""><strong>LLMStreamChunkEvent</strong>：在流式 LLM 响应期间收到每个数据块时发出</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="记忆-memory-事件">记忆 (Memory) 事件<a href="#记忆-memory-事件" class="hash-link" aria-label="Direct link to 记忆 (Memory) 事件" title="Direct link to 记忆 (Memory) 事件" translate="no">​</a></h3>
<ul>
<li class=""><strong>MemoryQueryStartedEvent</strong>：内存查询开始时发出。包含查询、限制和可选的分数阈值。</li>
<li class=""><strong>MemoryQueryCompletedEvent</strong>：内存查询成功完成时发出。包含查询、结果、限制、分数阈值和查询执行时间。</li>
<li class=""><strong>MemoryQueryFailedEvent</strong>：内存查询失败时发出。包含查询、限制、分数阈值和错误消息。</li>
<li class=""><strong>MemorySaveStartedEvent</strong>：内存保存操作开始时发出。包含要保存的值、元数据和可选的 Agent 角色。</li>
<li class=""><strong>MemorySaveCompletedEvent</strong>：内存保存操作成功完成时发出。包含保存的值、元数据、Agent 角色和保存执行时间。</li>
<li class=""><strong>MemorySaveFailedEvent</strong>：内存保存操作失败时发出。包含值、元数据、Agent 角色和错误消息。</li>
<li class=""><strong>MemoryRetrievalStartedEvent</strong>：针对任务提示词的内存检索开始时发出。包含可选的任务 ID。</li>
<li class=""><strong>MemoryRetrievalCompletedEvent</strong>：针对任务提示词的内存检索成功完成时发出。包含任务 ID、内存内容和检索执行时间。</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="事件处理程序结构-event-handler-structure">事件处理程序结构 (Event Handler Structure)<a href="#事件处理程序结构-event-handler-structure" class="hash-link" aria-label="Direct link to 事件处理程序结构 (Event Handler Structure)" title="Direct link to 事件处理程序结构 (Event Handler Structure)" translate="no">​</a></h2>
<p>每个事件处理程序接收两个参数：</p>
<ol>
<li class=""><strong>source</strong>：发出事件的对象</li>
<li class=""><strong>event</strong>：事件实例，包含特定于事件的数据</li>
</ol>
<p>事件对象的结构取决于事件类型，但所有事件都继承自 <code>BaseEvent</code> 并包括：</p>
<ul>
<li class=""><strong>timestamp</strong>：事件发出的时间</li>
<li class=""><strong>type</strong>：事件类型的字符串标识符</li>
</ul>
<p>附加字段因事件类型而异。例如，<code>CrewKickoffCompletedEvent</code> 包含 <code>crew_name</code> 和 <code>output</code> 字段。</p>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="高级用法作用域处理程序-advanced-usage-scoped-handlers">高级用法：作用域处理程序 (Advanced Usage: Scoped Handlers)<a href="#高级用法作用域处理程序-advanced-usage-scoped-handlers" class="hash-link" aria-label="Direct link to 高级用法：作用域处理程序 (Advanced Usage: Scoped Handlers)" title="Direct link to 高级用法：作用域处理程序 (Advanced Usage: Scoped Handlers)" translate="no">​</a></h2>
<p>对于临时事件处理（对测试或特定操作很有用），你可以使用 <code>scoped_handlers</code> 上下文管理器：</p>
<div class="language-python codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-python codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> crewai</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">events </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> crewai_event_bus</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> CrewKickoffStartedEvent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> crewai_event_bus</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">scoped_handlers</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:#393A34">@crewai_event_bus</span><span class="token decorator annotation punctuation" style="color:#393A34">.</span><span class="token decorator annotation punctuation" style="color:#393A34">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">CrewKickoffStartedEvent</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">temp_handler</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">source</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;This handler only exists within this context&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 执行发射事件的操作</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 在上下文之外，临时处理程序被移除</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="用例-use-cases">用例 (Use Cases)<a href="#用例-use-cases" class="hash-link" aria-label="Direct link to 用例 (Use Cases)" title="Direct link to 用例 (Use Cases)" translate="no">​</a></h2>
<p>事件监听器可用于多种目的：</p>
<ol>
<li class=""><strong>日志和监控</strong>：跟踪 Crew 的执行并记录重要事件。</li>
<li class=""><strong>分析</strong>：收集有关 Crew 性能和行为的数据。</li>
<li class=""><strong>调试</strong>：设置临时监听器以调试特定问题。</li>
<li class=""><strong>集成</strong>：将 CrewAI 与外部系统与监控平台、数据库或通知服务连接。</li>
<li class=""><strong>自定义行为</strong>：根据特定事件触发自定义操作。</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="最佳实践-best-practices">最佳实践 (Best Practices)<a href="#最佳实践-best-practices" class="hash-link" aria-label="Direct link to 最佳实践 (Best Practices)" title="Direct link to 最佳实践 (Best Practices)" translate="no">​</a></h2>
<ol>
<li class=""><strong>保持处理程序轻量</strong>：事件处理程序应轻量级，避免阻塞操作。</li>
<li class=""><strong>错误处理</strong>：在事件处理程序中包含适当的错误处理，防止异常影响主执行流程。</li>
<li class=""><strong>清理</strong>：如果你的监听器分配了资源，请确保它们被正确清理。</li>
<li class=""><strong>选择性监听</strong>：仅监听你需要处理的事件。</li>
<li class=""><strong>测试</strong>：隔离测试你的事件监听器，以确保它们按预期运行。</li>
</ol>
<p>通过利用 CrewAI 的事件系统，你可以扩展其功能并将其与现有基础设施无缝集成。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_iDCr"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/AI/CrewAI/事件监听器.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_c0mv" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mxtt"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/notes3/docs/AI/CrewAI/CLI"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">CLI</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/notes3/docs/AI/CrewAI/任务"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">任务</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_r83r thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#概览-overview" class="table-of-contents__link toc-highlight">概览 (Overview)</a></li><li><a href="#工作原理-how-it-works" class="table-of-contents__link toc-highlight">工作原理 (How It Works)</a></li><li><a href="#创建自定义事件监听器-creating-a-custom-event-listener" class="table-of-contents__link toc-highlight">创建自定义事件监听器 (Creating a Custom Event Listener)</a></li><li><a href="#正确注册你的监听器-properly-registering-your-listener" class="table-of-contents__link toc-highlight">正确注册你的监听器 (Properly Registering Your Listener)</a><ul><li><a href="#选项-1在你的-crew-或-flow-实现中导入并实例化" class="table-of-contents__link toc-highlight">选项 1：在你的 Crew 或 Flow 实现中导入并实例化</a></li><li><a href="#选项-2为你的监听器创建一个包" class="table-of-contents__link toc-highlight">选项 2：为你的监听器创建一个包</a></li></ul></li><li><a href="#可用的事件类型-available-event-types" class="table-of-contents__link toc-highlight">可用的事件类型 (Available Event Types)</a><ul><li><a href="#crew-事件" class="table-of-contents__link toc-highlight">Crew 事件</a></li><li><a href="#agent-事件" class="table-of-contents__link toc-highlight">Agent 事件</a></li><li><a href="#task-事件" class="table-of-contents__link toc-highlight">Task 事件</a></li><li><a href="#工具使用事件" class="table-of-contents__link toc-highlight">工具使用事件</a></li><li><a href="#知识库事件" class="table-of-contents__link toc-highlight">知识库事件</a></li><li><a href="#llm-护栏-guardrail-事件" class="table-of-contents__link toc-highlight">LLM 护栏 (Guardrail) 事件</a></li><li><a href="#flow-事件" class="table-of-contents__link toc-highlight">Flow 事件</a></li><li><a href="#llm-事件" class="table-of-contents__link toc-highlight">LLM 事件</a></li><li><a href="#记忆-memory-事件" class="table-of-contents__link toc-highlight">记忆 (Memory) 事件</a></li></ul></li><li><a href="#事件处理程序结构-event-handler-structure" class="table-of-contents__link toc-highlight">事件处理程序结构 (Event Handler Structure)</a></li><li><a href="#高级用法作用域处理程序-advanced-usage-scoped-handlers" class="table-of-contents__link toc-highlight">高级用法：作用域处理程序 (Advanced Usage: Scoped Handlers)</a></li><li><a href="#用例-use-cases" class="table-of-contents__link toc-highlight">用例 (Use Cases)</a></li><li><a href="#最佳实践-best-practices" class="table-of-contents__link toc-highlight">最佳实践 (Best Practices)</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_rhIP"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_rhIP"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_rhIP"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/notes3/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_rhIP"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>