<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-AI/tiktoken/简介" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">简介 | Cruldra</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/notes3/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/notes3/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/notes3/docs/AI/tiktoken/简介"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="简介 | Cruldra"><meta data-rh="true" name="description" content="Tiktoken 是 OpenAI 开源的一种快速 BPE (Byte Pair Encoding) 分词器（Tokenizer）。它专为 OpenAI 的模型（如 GPT-3.5, GPT-4, o1 等）设计，用于将文本转换为模型可处理的 token 序列，并将 token 序列还原为文本。"><meta data-rh="true" property="og:description" content="Tiktoken 是 OpenAI 开源的一种快速 BPE (Byte Pair Encoding) 分词器（Tokenizer）。它专为 OpenAI 的模型（如 GPT-3.5, GPT-4, o1 等）设计，用于将文本转换为模型可处理的 token 序列，并将 token 序列还原为文本。"><link data-rh="true" rel="icon" href="/notes3/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/notes3/docs/AI/tiktoken/简介"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/notes3/docs/AI/tiktoken/简介" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/notes3/docs/AI/tiktoken/简介" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"简介","item":"https://your-docusaurus-site.example.com/notes3/docs/AI/tiktoken/简介"}]}</script><link rel="alternate" type="application/rss+xml" href="/notes3/blog/rss.xml" title="Cruldra RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/notes3/blog/atom.xml" title="Cruldra Atom Feed"><link rel="stylesheet" href="/notes3/assets/css/styles.8c4657fb.css">
<script src="/notes3/assets/js/runtime~main.930e6805.js" defer="defer"></script>
<script src="/notes3/assets/js/main.e99a5070.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme",window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-theme-choice","system"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/notes3/img/logo.svg"><style data-mantine-styles="classes">@media (max-width: 35.99375em) {.mantine-visible-from-xs {display: none !important;}}@media (min-width: 36em) {.mantine-hidden-from-xs {display: none !important;}}@media (max-width: 47.99375em) {.mantine-visible-from-sm {display: none !important;}}@media (min-width: 48em) {.mantine-hidden-from-sm {display: none !important;}}@media (max-width: 61.99375em) {.mantine-visible-from-md {display: none !important;}}@media (min-width: 62em) {.mantine-hidden-from-md {display: none !important;}}@media (max-width: 74.99375em) {.mantine-visible-from-lg {display: none !important;}}@media (min-width: 75em) {.mantine-hidden-from-lg {display: none !important;}}@media (max-width: 87.99375em) {.mantine-visible-from-xl {display: none !important;}}@media (min-width: 88em) {.mantine-hidden-from-xl {display: none !important;}}</style><div role="region" aria-label="Skip to main content"><a class="skipToContent_aA1M" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/notes3/"><div class="navbar__logo"><img src="/notes3/img/logo.svg" alt="My Site Logo" class="themedComponent_E3Xm themedComponent--light_DVqC"><img src="/notes3/img/logo.svg" alt="My Site Logo" class="themedComponent_E3Xm themedComponent--dark_B_L3"></div><b class="navbar__title text--truncate">Cruldra</b></a><a class="navbar__item navbar__link" href="/notes3/docs/category/设计模式">JVM</a><a class="navbar__item navbar__link" href="/notes3/docs/category/css">前端</a><a class="navbar__item navbar__link" href="/notes3/docs/category/astrbot">工具</a><a class="navbar__item navbar__link" href="/notes3/docs/category/ai电竞酒店">个人</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/notes3/docs/AI/ACP/架构">AI</a><a class="navbar__item navbar__link" href="/notes3/docs/category/内置模块">Python</a><a class="navbar__item navbar__link" href="/notes3/docs/category/actix-web">Rust</a><a class="navbar__item navbar__link" href="/notes3/docs/category/数据库系统">软件工程</a><a class="navbar__item navbar__link" href="/notes3/docs/category/上古卷轴5">游戏</a><a class="navbar__item navbar__link" href="/notes3/docs/Go/Go-Python-Java三语言全方位对比">Go</a><a class="navbar__item navbar__link" href="/notes3/docs/Hardware/intro">硬件</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_PufJ"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_ctfR"><div class="docsWrapper_ByIB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_KwvU" type="button"></button><div class="docRoot_hD6z"><aside class="theme-doc-sidebar-container docSidebarContainer_KuHC"><div class="sidebarViewport_LCjr"><div class="sidebar_L77d"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_VYAF"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/ACP/架构"><span title="ACP" class="categoryLinkLabel_FHN4">ACP</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/Agno/介绍"><span title="Agno" class="categoryLinkLabel_FHN4">Agno</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/CrewAI/CLI"><span title="CrewAI" class="categoryLinkLabel_FHN4">CrewAI</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/DALLE成本计算"><span title="DALL-E 画图成本计算" class="linkLabel__RqX">DALL-E 画图成本计算</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/LLamaIndex/CitationQueryEngine"><span title="LLamaIndex" class="categoryLinkLabel_FHN4">LLamaIndex</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/MCP/MCP-Python-SDK"><span title="MCP" class="categoryLinkLabel_FHN4">MCP</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/Pytorch/介绍"><span title="Pytorch" class="categoryLinkLabel_FHN4">Pytorch</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/SentencePiece/简介"><span title="SentencePiece" class="categoryLinkLabel_FHN4">SentencePiece</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/Transformer"><span title="Transformer" class="linkLabel__RqX">Transformer</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/cv_graph"><span title="计算机视觉 (CV) 知识图谱" class="linkLabel__RqX">计算机视觉 (CV) 知识图谱</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/datasets/demo"><span title="datasets" class="categoryLinkLabel_FHN4">datasets</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/huggingface_hub/简介"><span title="huggingface_hub" class="categoryLinkLabel_FHN4">huggingface_hub</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/llm_graph"><span title="LLM 知识图谱" class="linkLabel__RqX">LLM 知识图谱</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/notes3/docs/AI/tiktoken/简介"><span title="tiktoken" class="categoryLinkLabel_FHN4">tiktoken</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/notes3/docs/AI/tiktoken/简介"><span title="简介" class="linkLabel__RqX">简介</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/tokenizers/和tiktoken的区别"><span title="tokenizers" class="categoryLinkLabel_FHN4">tokenizers</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/transformers/分词器/PreTrainedTokenizer"><span title="transformers" class="categoryLinkLabel_FHN4">transformers</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist" href="/notes3/docs/AI/vllm"><span title="vLLM 学习资料" class="categoryLinkLabel_FHN4">vLLM 学习资料</span></a><button aria-label="Expand sidebar category &#x27;vLLM 学习资料&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/wandb/简介"><span title="wandb" class="categoryLinkLabel_FHN4">wandb</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/一些概念1"><span title="一些概念1" class="linkLabel__RqX">一些概念1</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/一些概念2"><span title="一些概念2" class="linkLabel__RqX">一些概念2</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/一些概念3"><span title="一些概念3" class="linkLabel__RqX">一些概念3</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/一些概念4"><span title="一些概念4" class="linkLabel__RqX">一些概念4</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/一些概念5"><span title="一些概念5" class="linkLabel__RqX">一些概念5</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/候选模型"><span title="候选模型" class="linkLabel__RqX">候选模型</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/变分自编码器详解"><span title="变分自编码器（VAE）详解" class="linkLabel__RqX">变分自编码器（VAE）详解</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/大模型核心概念通俗解释"><span title="大模型核心概念通俗解释" class="linkLabel__RqX">大模型核心概念通俗解释</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/大模型训练中的随机种子：为什么需要它？"><span title="大模型训练中的随机种子：为什么需要它？" class="linkLabel__RqX">大模型训练中的随机种子：为什么需要它？</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/如何看懂数学公式"><span title="如何看懂数学公式" class="linkLabel__RqX">如何看懂数学公式</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/嵌入和向量/Chroma与PGVector对比"><span title="嵌入和向量" class="categoryLinkLabel_FHN4">嵌入和向量</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/感知机"><span title="感知机" class="linkLabel__RqX">感知机</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/提示词工程/DSPy/API/优化器/BetterTogether"><span title="提示词工程" class="categoryLinkLabel_FHN4">提示词工程</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/智能体"><span title="智能体(Agent)" class="linkLabel__RqX">智能体(Agent)</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/深度学习/入门"><span title="深度学习" class="categoryLinkLabel_FHN4">深度学习</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/理解大模型：从函数视角看AI的本质"><span title="理解大模型：从函数视角看AI的本质" class="linkLabel__RqX">理解大模型：从函数视角看AI的本质</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/相关概念/Gradient"><span title="相关概念" class="categoryLinkLabel_FHN4">相关概念</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/联邦学习概念"><span title="联邦学习概念" class="linkLabel__RqX">联邦学习概念</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/AI/通义千问/阿里云百炼"><span title="通义千问" class="categoryLinkLabel_FHN4">通义千问</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/AI/金丝雀发布和AB测试"><span title="金丝雀发布和AB测试" class="linkLabel__RqX">金丝雀发布和AB测试</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_WxcZ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_Zd2x"><div class="docItemContainer_EEW4"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_xL_w" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/notes3/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_zA1U"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">tiktoken</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">简介</span></li></ul></nav><div class="tocCollapsible_aZGz theme-doc-toc-mobile tocMobile_ShCt"><button type="button" class="clean-btn tocCollapsibleButton_fxzH">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>简介</h1></header><p><strong>Tiktoken</strong> 是 OpenAI 开源的一种快速 <strong>BPE (Byte Pair Encoding)</strong> 分词器（Tokenizer）。它专为 OpenAI 的模型（如 GPT-3.5, GPT-4, o1 等）设计，用于将文本转换为模型可处理的 token 序列，并将 token 序列还原为文本。</p>
<p>Tiktoken 的核心特点是：</p>
<ul>
<li class=""><strong>高性能</strong>：底层使用 Rust 编写，速度比 Python 实现的 Hugging Face Tokenizers 快 3-6 倍。</li>
<li class=""><strong>确定性</strong>：确保在不同环境中对同一文本产生相同的 Token 序列。</li>
<li class=""><strong>无损性</strong>：支持可逆的编码和解码，确保文本信息的完整性。</li>
<li class=""><strong>字节级 BPE</strong>：直接在 UTF-8 字节上运行，无需复杂的 Unicode 预处理，能处理任何语言和二进制数据。</li>
</ul>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>Text</mtext><mover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mtext>Encode</mtext></mpadded></mover><mtext>List[Integers]</mtext><mover><mo stretchy="true" minsize="3.0em">→</mo><mpadded width="+0.6em" lspace="0.3em"><mtext>Decode</mtext></mpadded></mover><mtext>Text</mtext></mrow><annotation encoding="application/x-tex">\text{Text} \xrightarrow{\text{Encode}} \text{List[Integers]} \xrightarrow{\text{Decode}} \text{Text}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1191em;vertical-align:-0.011em"></span><span class="mord text"><span class="mord">Text</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1081em"><span style="top:-3.322em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Encode</span></span></span></span></span><span class="svg-align" style="top:-2.689em"><span class="pstrut" style="height:2.7em"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.3581em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">List[Integers]</span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel x-arrow"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1081em"><span style="top:-3.322em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight x-arrow-pad"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">Decode</span></span></span></span></span><span class="svg-align" style="top:-2.689em"><span class="pstrut" style="height:2.7em"></span><span class="hide-tail" style="height:0.522em;min-width:1.469em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.522em" viewBox="0 0 400000 522" preserveAspectRatio="xMaxYMin slice"><path d="M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.011em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord text"><span class="mord">Text</span></span></span></span></span></span>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="2-架构与原理-architecture--mechanism">2. 架构与原理 (Architecture &amp; Mechanism)<a href="#2-架构与原理-architecture--mechanism" class="hash-link" aria-label="Direct link to 2. 架构与原理 (Architecture &amp; Mechanism)" title="Direct link to 2. 架构与原理 (Architecture &amp; Mechanism)" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="21-字节对编码-byte-pair-encoding-bpe">2.1 字节对编码 (Byte Pair Encoding, BPE)<a href="#21-字节对编码-byte-pair-encoding-bpe" class="hash-link" aria-label="Direct link to 2.1 字节对编码 (Byte Pair Encoding, BPE)" title="Direct link to 2.1 字节对编码 (Byte Pair Encoding, BPE)" translate="no">​</a></h3>
<p>Tiktoken 使用的是 BPE 算法，这是一种迭代的合并算法。</p>
<p><strong>算法流程</strong>：</p>
<ol>
<li class=""><strong>初始化</strong>：将输入文本转换为 UTF-8 字节序列。初始词表包含 256 个基础字节（0-255）。</li>
<li class=""><strong>统计频率</strong>：统计所有相邻字节对（bigram）在数据集中出现的频率。</li>
<li class=""><strong>合并</strong>：选择出现频率最高的字节对，将其合并为一个新的 token，并加入词表。</li>
<li class=""><strong>迭代</strong>：重复步骤 2-3，直到达到预设的词表大小（如 GPT-4 的 <code>cl100k_base</code> 为 100,277 个 token）。</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="22-架构图解">2.2 架构图解<a href="#22-架构图解" class="hash-link" aria-label="Direct link to 2.2 架构图解" title="Direct link to 2.2 架构图解" translate="no">​</a></h3>
<!-- -->
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="23-关键组件详解">2.3 关键组件详解<a href="#23-关键组件详解" class="hash-link" aria-label="Direct link to 2.3 关键组件详解" title="Direct link to 2.3 关键组件详解" translate="no">​</a></h3>
<ol>
<li class="">
<p><strong>Regex Splitting (正则预分词)</strong>：</p>
<ul>
<li class="">在进行 BPE 合并前，先用正则表达式将文本切分为基础块（Chunks）。</li>
<li class=""><strong>目的</strong>：防止跨类别的合并（例如避免将 &quot;dog&quot; 和 &quot;.&quot; 合并，保持语义独立性）。</li>
<li class=""><strong>GPT-4 正则模式</strong>：<!-- -->
<div class="language-regex codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-regex codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;</span><span class="token group punctuation" style="color:#393A34">(?i:</span><span class="token char-class char-class-punctuation punctuation" style="color:#393A34">[</span><span class="token char-class">sdmt</span><span class="token char-class char-class-punctuation punctuation" style="color:#393A34">]</span><span class="token alternation keyword" style="color:#00009f">|</span><span class="token plain">ll</span><span class="token alternation keyword" style="color:#00009f">|</span><span class="token plain">ve</span><span class="token alternation keyword" style="color:#00009f">|</span><span class="token plain">re</span><span class="token group punctuation" style="color:#393A34">)</span><span class="token alternation keyword" style="color:#00009f">|</span><span class="token char-class char-class-punctuation punctuation" style="color:#393A34">[</span><span class="token char-class char-class-negation operator" style="color:#393A34">^</span><span class="token char-class escape">\r</span><span class="token char-class escape">\n</span><span class="token char-class char-set class-name">\p{L}</span><span class="token char-class char-set class-name">\p{N}</span><span class="token char-class char-class-punctuation punctuation" style="color:#393A34">]</span><span class="token quantifier number" style="color:#36acaa">?+</span><span class="token char-set class-name">\p{L}</span><span class="token quantifier number" style="color:#36acaa">+</span><span class="token alternation keyword" style="color:#00009f">|</span><span class="token char-set class-name">\p{N}</span><span class="token quantifier number" style="color:#36acaa">{1,3}</span><span class="token alternation keyword" style="color:#00009f">|</span><span class="token plain"> </span><span class="token quantifier number" style="color:#36acaa">?</span><span class="token char-class char-class-punctuation punctuation" style="color:#393A34">[</span><span class="token char-class char-class-negation operator" style="color:#393A34">^</span><span class="token char-class char-set class-name">\s</span><span class="token char-class char-set class-name">\p{L}</span><span class="token char-class char-set class-name">\p{N}</span><span class="token char-class char-class-punctuation punctuation" style="color:#393A34">]</span><span class="token quantifier number" style="color:#36acaa">++</span><span class="token char-class char-class-punctuation punctuation" style="color:#393A34">[</span><span class="token char-class escape">\r</span><span class="token char-class escape">\n</span><span class="token char-class char-class-punctuation punctuation" style="color:#393A34">]</span><span class="token quantifier number" style="color:#36acaa">*</span><span class="token alternation keyword" style="color:#00009f">|</span><span class="token char-set class-name">\s</span><span class="token quantifier number" style="color:#36acaa">*</span><span class="token char-class char-class-punctuation punctuation" style="color:#393A34">[</span><span class="token char-class escape">\r</span><span class="token char-class escape">\n</span><span class="token char-class char-class-punctuation punctuation" style="color:#393A34">]</span><span class="token alternation keyword" style="color:#00009f">|</span><span class="token char-set class-name">\s</span><span class="token quantifier number" style="color:#36acaa">+</span><span class="token group punctuation" style="color:#393A34">(?!</span><span class="token char-set class-name">\S</span><span class="token group punctuation" style="color:#393A34">)</span><span class="token alternation keyword" style="color:#00009f">|</span><span class="token char-set class-name">\s</span><span class="token quantifier number" style="color:#36acaa">+</span><br></span></code></pre></div></div>
<ul>
<li class=""><code>(?i:[sdmt]|ll|ve|re)</code>: 处理缩写（如 &#x27;s, &#x27;re），不区分大小写。</li>
<li class=""><code>\p{N}{1,3}</code>: 将数字按 1-3 位切分，防止长数字变成独立 token。</li>
</ul>
</li>
</ul>
</li>
<li class="">
<p><strong>Merge Rules (合并规则)</strong>：</p>
<ul>
<li class="">这是一个查找表（HashMap），映射 <code>(token_a, token_b) -&gt; new_token</code>。</li>
<li class=""><strong>Rank (优先级)</strong>：每个合并规则都有一个 rank，数字越小优先级越高。编码时按 rank 从小到大顺序执行合并。</li>
</ul>
</li>
<li class="">
<p><strong>Special Tokens (特殊 Token)</strong>：</p>
<ul>
<li class="">用于控制模型行为的特殊标记，不参与普通 BPE 合并。</li>
<li class="">例如：<code>&lt;|endoftext|&gt;</code> (文档结束), <code>&lt;|im_start|&gt;</code> (对话开始)。</li>
<li class="">Tiktoken 允许用户自定义特殊 token。</li>
</ul>
</li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="3-api-与代码示例-api--code-examples">3. API 与代码示例 (API &amp; Code Examples)<a href="#3-api-与代码示例-api--code-examples" class="hash-link" aria-label="Direct link to 3. API 与代码示例 (API &amp; Code Examples)" title="Direct link to 3. API 与代码示例 (API &amp; Code Examples)" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="31-基础用法">3.1 基础用法<a href="#31-基础用法" class="hash-link" aria-label="Direct link to 3.1 基础用法" title="Direct link to 3.1 基础用法" translate="no">​</a></h3>
<div class="language-python codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-python codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> tiktoken</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 1. 获取编码器 (Encoding)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># cl100k_base 是 GPT-4 和 GPT-3.5-turbo 使用的编码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tiktoken</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_encoding</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;cl100k_base&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 2. 编码 (Encode): 文本 -&gt; Token IDs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Hello, world!&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tokens </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> enc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Tokens: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">tokens</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: [9906, 11, 1917, 0] </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># (注意: 具体 ID 可能因版本略有差异，这里仅作示意)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 3. 解码 (Decode): Token IDs -&gt; 文本</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">decoded_text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> enc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tokens</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Decoded: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">decoded_text</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: Hello, world!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 4. 统计 Token 数量 (常用于计费估算)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Token count: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">tokens</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="32-指定模型获取编码器">3.2 指定模型获取编码器<a href="#32-指定模型获取编码器" class="hash-link" aria-label="Direct link to 3.2 指定模型获取编码器" title="Direct link to 3.2 指定模型获取编码器" translate="no">​</a></h3>
<p>如果你不知道某个模型具体用什么编码，可以使用 <code>encoding_for_model</code>：</p>
<div class="language-python codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-python codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 自动获取 gpt-4 对应的编码器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enc_gpt4 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tiktoken</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encoding_for_model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;gpt-4&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">enc_gpt4</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Output: cl100k_base</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 获取旧版 text-davinci-003 的编码器</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enc_p50k </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tiktoken</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encoding_for_model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;text-davinci-003&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">enc_p50k</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Output: p50k_base</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="33-处理特殊-token">3.3 处理特殊 Token<a href="#33-处理特殊-token" class="hash-link" aria-label="Direct link to 3.3 处理特殊 Token" title="Direct link to 3.3 处理特殊 Token" translate="no">​</a></h3>
<p>默认情况下，<code>encode</code> 方法会将特殊 token 字符串视为普通文本处理，以防止注入攻击。如果需要处理特殊 token，需显式指定 <code>allowed_special</code>。</p>
<div class="language-python codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-python codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">special_text </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Hello &lt;|endoftext|&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 默认行为：将 &lt;|endoftext|&gt; 视为普通字符编码</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">default_tokens </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> enc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">special_text</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">enc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">decode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">default_tokens</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: Hello &lt;|endoftext|&gt; (作为纯文本)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 允许特殊 token 解析</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">special_tokens </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> enc</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">special_text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> allowed_special</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;&lt;|endoftext|&gt;&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 或者允许所有特殊 token: allowed_special=&quot;all&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">special_tokens</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: [9906, 100257] (100257 是 &lt;|endoftext|&gt; 的 ID)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="4-常见编码方案对比-comparison">4. 常见编码方案对比 (Comparison)<a href="#4-常见编码方案对比-comparison" class="hash-link" aria-label="Direct link to 4. 常见编码方案对比 (Comparison)" title="Direct link to 4. 常见编码方案对比 (Comparison)" translate="no">​</a></h2>
<table><thead><tr><th style="text-align:left">编码名称</th><th style="text-align:left">适用模型</th><th style="text-align:left">词表大小</th><th style="text-align:left">特点</th></tr></thead><tbody><tr><td style="text-align:left"><strong>o200k_base</strong></td><td style="text-align:left">GPT-4o</td><td style="text-align:left">~200k</td><td style="text-align:left">最新方案，对多语言支持更好，压缩率更高。</td></tr><tr><td style="text-align:left"><strong>cl100k_base</strong></td><td style="text-align:left">GPT-4, GPT-3.5-turbo, text-embedding-ada-002</td><td style="text-align:left">~100k</td><td style="text-align:left">相比 p50k 词表翻倍，增强了对代码和数字的处理。</td></tr><tr><td style="text-align:left"><strong>p50k_base</strong></td><td style="text-align:left">Codex models, text-davinci-002/003</td><td style="text-align:left">~50k</td><td style="text-align:left">针对代码进行了优化。</td></tr><tr><td style="text-align:left"><strong>r50k_base</strong></td><td style="text-align:left">GPT-3 (davinci, curie, etc.)</td><td style="text-align:left">~50k</td><td style="text-align:left">早期的 GPT-3 编码方案。</td></tr></tbody></table>
<p><strong>压缩率对比</strong>：
通常 <code>o200k_base</code> &gt; <code>cl100k_base</code> &gt; <code>p50k_base</code>。更高的压缩率意味着同样的文本需要更少的 token，从而降低 API 调用成本并提升模型上下文窗口的利用率。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="5-常见问题与坑-pitfalls">5. 常见问题与坑 (Pitfalls)<a href="#5-常见问题与坑-pitfalls" class="hash-link" aria-label="Direct link to 5. 常见问题与坑 (Pitfalls)" title="Direct link to 5. 常见问题与坑 (Pitfalls)" translate="no">​</a></h2>
<ol>
<li class="">
<p><strong>空格处理</strong>：</p>
<ul>
<li class="">Tiktoken 通常将前导空格合并到单词 token 中（例如 <code>&quot; world&quot;</code> 是一个 token）。</li>
<li class=""><strong>注意</strong>：<code>encode(&quot;Hello world&quot;)</code> 和 <code>encode(&quot;Hello&quot;) + encode(&quot; world&quot;)</code> 结果通常一致，但 <code>encode(&quot;Hello&quot;) + encode(&quot;world&quot;)</code> (缺空格) 则是完全不同的 token。</li>
</ul>
</li>
<li class="">
<p><strong>非英语语言效率</strong>：</p>
<ul>
<li class="">虽然 BPE 支持 Unicode，但如果词表中缺乏特定语言的合并规则，该语言可能会退化为字节级编码，导致 Token 数量激增（效率低）。<code>o200k_base</code> 对此有显著改进。</li>
</ul>
</li>
<li class="">
<p><strong>特殊 Token 注入</strong>：</p>
<ul>
<li class="">在处理用户输入时，务必小心 <code>allowed_special=&quot;all&quot;</code>，这可能导致用户通过注入 <code>&lt;|im_start|&gt;</code> 等 Prompt 注入攻击来干扰模型逻辑。通常应保持默认设置（不解析特殊 token）。</li>
</ul>
</li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="6-参考资料-references">6. 参考资料 (References)<a href="#6-参考资料-references" class="hash-link" aria-label="Direct link to 6. 参考资料 (References)" title="Direct link to 6. 参考资料 (References)" translate="no">​</a></h2>
<ol>
<li class=""><strong>Tiktoken GitHub Repository</strong>: <a href="https://github.com/openai/tiktoken" target="_blank" rel="noopener noreferrer" class="">https://github.com/openai/tiktoken</a></li>
<li class=""><strong>OpenAI Cookbook</strong>: <a href="https://github.com/openai/openai-cookbook/blob/main/examples/How_to_count_tokens_with_tiktoken.ipynb" target="_blank" rel="noopener noreferrer" class="">How to count tokens with tiktoken</a></li>
<li class=""><strong>Sebastian Raschka&#x27;s Blog</strong>: <a href="https://sebastianraschka.com/blog/2025/bpe-from-scratch.html" target="_blank" rel="noopener noreferrer" class="">Implementing A Byte Pair Encoding (BPE) Tokenizer From Scratch</a></li>
<li class=""><strong>Hugging Face</strong>: <a href="https://huggingface.co/learn/nlp-course/chapter6/5?fw=pt" target="_blank" rel="noopener noreferrer" class="">Byte-Pair Encoding tokenization</a></li>
<li class=""><strong>Fast.ai</strong>: <a href="https://www.fast.ai/posts/2025-10-16-karpathy-tokenizers.html" target="_blank" rel="noopener noreferrer" class="">Let’s Build the GPT Tokenizer</a></li>
</ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_iDCr"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/AI/tiktoken/简介.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_c0mv" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mxtt"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/notes3/docs/AI/llm_graph"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">LLM 知识图谱</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/notes3/docs/AI/tokenizers/和tiktoken的区别"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">和tiktoken的区别</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_r83r thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#2-架构与原理-architecture--mechanism" class="table-of-contents__link toc-highlight">2. 架构与原理 (Architecture &amp; Mechanism)</a><ul><li><a href="#21-字节对编码-byte-pair-encoding-bpe" class="table-of-contents__link toc-highlight">2.1 字节对编码 (Byte Pair Encoding, BPE)</a></li><li><a href="#22-架构图解" class="table-of-contents__link toc-highlight">2.2 架构图解</a></li><li><a href="#23-关键组件详解" class="table-of-contents__link toc-highlight">2.3 关键组件详解</a></li></ul></li><li><a href="#3-api-与代码示例-api--code-examples" class="table-of-contents__link toc-highlight">3. API 与代码示例 (API &amp; Code Examples)</a><ul><li><a href="#31-基础用法" class="table-of-contents__link toc-highlight">3.1 基础用法</a></li><li><a href="#32-指定模型获取编码器" class="table-of-contents__link toc-highlight">3.2 指定模型获取编码器</a></li><li><a href="#33-处理特殊-token" class="table-of-contents__link toc-highlight">3.3 处理特殊 Token</a></li></ul></li><li><a href="#4-常见编码方案对比-comparison" class="table-of-contents__link toc-highlight">4. 常见编码方案对比 (Comparison)</a></li><li><a href="#5-常见问题与坑-pitfalls" class="table-of-contents__link toc-highlight">5. 常见问题与坑 (Pitfalls)</a></li><li><a href="#6-参考资料-references" class="table-of-contents__link toc-highlight">6. 参考资料 (References)</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_rhIP"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_rhIP"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_rhIP"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/notes3/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_rhIP"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>