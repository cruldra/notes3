{
  "version": "1",
  "metadata": {
    "marimo_version": "0.19.2"
  },
  "cells": [
    {
      "id": "MJUe",
      "code_hash": "d4080ac39d1b56f96e640e9b0108ce0b",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h1 id=\"_1\">\ud83c\udfaf \u5206\u8bcd\u5668\u4e0e\u8bcd\u5d4c\u5165\u5b8c\u6574\u6d41\u7a0b\u6f14\u793a</h1>\n<span class=\"paragraph\">\u672c\u7b14\u8bb0\u672c\u6f14\u793a\u4ece<strong>\u539f\u59cb\u6587\u672c</strong>\u5230<strong>\u8bcd\u5d4c\u5165\u5411\u91cf</strong>\u7684\u5b8c\u6574\u8f6c\u6362\u8fc7\u7a0b\u3002</span>\n<h2 id=\"_2\">\ud83d\udcca \u6d41\u7a0b\u6982\u89c8</h2></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "bkHC",
      "code_hash": "46f641d60c87332b22d79d84329d4116",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"1\">\ud83d\udd27 \u6b65\u9aa41: \u52a0\u8f7d\u9884\u8bad\u7ec3\u5206\u8bcd\u5668</h2>\n<span class=\"paragraph\">\u6211\u4eec\u4f7f\u7528 HuggingFace \u7684 <code>AutoTokenizer</code> \u52a0\u8f7d\u9884\u8bad\u7ec3\u7684\u5206\u8bcd\u5668\u3002\n\u8fd9\u91cc\u4f7f\u7528 Qwen2.5-7B-Instruct \u7684\u5206\u8bcd\u5668\u4f5c\u4e3a\u793a\u4f8b\u3002</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "PKri",
      "code_hash": "7ed622a6a705d9a54a9b26f43158f486",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"2-tokenization\">\ud83d\udd24 \u6b65\u9aa42: \u6587\u672c\u5206\u8bcd (Tokenization)</h2></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Xref",
      "code_hash": "ea3fea9219a6513fc96f9294dc05c900",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h3 id=\"_1\">\ud83d\udca1 \u5206\u8bcd\u5668\u5df2\u5c31\u7eea</h3>\n<span class=\"paragraph\"><code>AutoTokenizer.from_pretrained()</code> \u81ea\u52a8\u52a0\u8f7d\u4e86:</span>\n<ul>\n<li><strong>\u8bcd\u6c47\u8868 (vocab.json)</strong>: \u6240\u6709\u652f\u6301\u7684 Token \u53ca\u5176 ID</li>\n<li><strong>\u5408\u5e76\u89c4\u5219 (merges.txt/tokenizer.json)</strong>: BPE/WordPiece \u5206\u8bcd\u89c4\u5219</li>\n<li><strong>\u7279\u6b8a Token \u914d\u7f6e</strong>: BOS/EOS/PAD \u7b49\u6807\u8bb0</li>\n<li><strong>\u5206\u8bcd\u903b\u8f91</strong>: \u5b8c\u6574\u7684\u7f16\u7801/\u89e3\u7801\u529f\u80fd</li>\n</ul></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "SFPL",
      "code_hash": "1e34ea2d3ead125787487d23324dca83",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h3 id=\"_1\">\ud83d\udcdd \u5b9e\u9645\u6f14\u793a: \u5bf9 \"\u5c0f\u7ea2\u5e3d\u53bb\u68ee\u6797\" \u8fdb\u884c\u5206\u8bcd</h3></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "RGSE",
      "code_hash": "0f5d11f056a3032c286966f2a17e3690",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"3-embedding\">\ud83c\udfa8 \u6b65\u9aa43: \u8bcd\u5d4c\u5165 (Embedding)</h2></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Kclp",
      "code_hash": "303670e7d2994c534bfc9fe78d59b0b6",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h3 id=\"_1\">\u6838\u5fc3\u6982\u5ff5</h3>\n<span class=\"paragraph\"><strong>Embedding Layer</strong> = \u4e00\u4e2a\u67e5\u627e\u8868 (Lookup Table)</span>\n<ul>\n<li><strong>\u8f93\u5165</strong>: Token ID (\u6574\u6570, \u4f8b\u5982 453)</li>\n<li><strong>\u8f93\u51fa</strong>: \u5bc6\u96c6\u5411\u91cf (\u4f8b\u5982 512 \u7ef4\u7684\u6d6e\u70b9\u6570\u5411\u91cf)</li>\n<li><strong>\u672c\u8d28</strong>: \u4ece <code>vocab_size \u00d7 hidden_size</code> \u7684\u5927\u77e9\u9635\u4e2d,\u6839\u636e ID \u63d0\u53d6\u5bf9\u5e94\u7684\u884c</li>\n</ul></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Hstk",
      "code_hash": "ac93767f4a437af553a831cd630ff21d",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h3 id=\"token-ids\">\ud83d\udd0d \u6f14\u793a: \u5c06 Token IDs \u8f6c\u6362\u4e3a\u5d4c\u5165\u5411\u91cf</h3></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "iLit",
      "code_hash": "bf22635b81d37a6d2c4d952aa300d5d1",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"embedding\">\ud83d\udcca \u53ef\u89c6\u5316: Embedding \u67e5\u627e\u8fc7\u7a0b</h2>\n<span class=\"paragraph\">\u4ee5 Token \"\u5c0f\u7ea2\u5e3d\" (ID=453) \u4e3a\u4f8b:</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "ROlb",
      "code_hash": "2255ae244b66f5d0c58e3bcc2fa0a071",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"4\">\ud83e\uddee \u6b65\u9aa44: \u5b8c\u6574\u6d41\u7a0b\u4e32\u8054</h2>\n<span class=\"paragraph\">\u6a21\u62df\u5b8c\u6574\u7684 <strong>\u6587\u672c -&gt; Transformer</strong> \u8f93\u5165\u51c6\u5907\u8fc7\u7a0b</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "TqIu",
      "code_hash": "a8a8f8207b396619b9db12a7dcb70859",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"_1\">\ud83c\udf93 \u5173\u952e\u8981\u70b9\u603b\u7ed3</h2>\n<h3 id=\"1-embedding\">1\ufe0f\u20e3 \u4e3a\u4ec0\u4e48\u9700\u8981 Embedding?</h3>\n<table>\n<thead>\n<tr>\n<th>\u8868\u793a\u65b9\u5f0f</th>\n<th>\u4f18\u70b9</th>\n<th>\u7f3a\u70b9</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>One-Hot</strong> (\u72ec\u70ed\u7f16\u7801)</td>\n<td>\u7b80\u5355\u76f4\u89c2</td>\n<td>\u7ef4\u5ea6\u7206\u70b8 (6400\u7ef4), \u65e0\u8bed\u4e49\u4fe1\u606f</td>\n</tr>\n<tr>\n<td><strong>Embedding</strong> (\u5bc6\u96c6\u5411\u91cf)</td>\n<td>\u4f4e\u7ef4 (512\u7ef4), \u5305\u542b\u8bed\u4e49</td>\n<td>\u9700\u8981\u8bad\u7ec3\u5b66\u4e60</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"2-embedding\">2\ufe0f\u20e3 Embedding \u5982\u4f55\u5b66\u4e60\u8bed\u4e49?</h3>\n<ul>\n<li><strong>\u521d\u59cb\u5316</strong>: \u968f\u673a\u5c0f\u6570\u503c</li>\n<li><strong>\u8bad\u7ec3\u8fc7\u7a0b</strong>: \u901a\u8fc7\u53cd\u5411\u4f20\u64ad,\u6839\u636e\u4e0a\u4e0b\u6587\u81ea\u52a8\u8c03\u6574</li>\n<li><strong>\u7ed3\u679c</strong>: \u8bed\u4e49\u76f8\u8fd1\u7684\u8bcd\u5411\u91cf\u8ddd\u79bb\u66f4\u8fd1</li>\n</ul>\n<span class=\"paragraph\">\u4f8b\u5982\u8bad\u7ec3\u540e:\n<div class=\"language-text codehilite\"><pre><span></span><code>similarity(&quot;\u56fd\u738b&quot;, &quot;\u738b\u540e&quot;) &gt; similarity(&quot;\u56fd\u738b&quot;, &quot;\u82f9\u679c&quot;)\n</code></pre></div></span>\n<h3 id=\"3\">3\ufe0f\u20e3 \u5b9e\u9645\u4ee3\u7801\u5bf9\u5e94</h3>\n<div class=\"language-python codehilite\"><pre><span></span><code><span class=\"c1\"># \u6765\u81ea \u4ece\u5934\u5f00\u59cb\u8bad\u7ec3\u81ea\u5df1\u7684\u5927\u6a21\u578b.py</span>\n\n<span class=\"c1\"># \u5b9a\u4e49 Embedding \u5c42 (py:1160)</span>\n<span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">embedding</span> <span class=\"o\">=</span> <span class=\"n\">nn</span><span class=\"o\">.</span><span class=\"n\">Embedding</span><span class=\"p\">(</span><span class=\"n\">config</span><span class=\"o\">.</span><span class=\"n\">vocab_size</span><span class=\"p\">,</span> <span class=\"n\">config</span><span class=\"o\">.</span><span class=\"n\">hidden_size</span><span class=\"p\">)</span>\n\n<span class=\"c1\"># \u524d\u5411\u4f20\u64ad (py:1393)</span>\n<span class=\"n\">h</span> <span class=\"o\">=</span> <span class=\"bp\">self</span><span class=\"o\">.</span><span class=\"n\">embedding</span><span class=\"p\">(</span><span class=\"n\">idx</span><span class=\"p\">)</span>  <span class=\"c1\"># [batch, seq_len] -&gt; [batch, seq_len, hidden_size]</span>\n</code></pre></div>\n<h3 id=\"4\">4\ufe0f\u20e3 \u4e0b\u4e00\u6b65</h3>\n<span class=\"paragraph\">\u5d4c\u5165\u5411\u91cf\u4f1a\u9001\u5165 <strong>Transformer Blocks</strong> \u8fdb\u884c\u591a\u5c42\u5904\u7406:</span>\n<ul>\n<li>\u4f4d\u7f6e\u7f16\u7801 (RoPE)</li>\n<li>\u81ea\u6ce8\u610f\u529b\u673a\u5236 (Attention)</li>\n<li>\u524d\u9988\u7f51\u7edc (FeedForward)</li>\n<li>\u5c42\u5f52\u4e00\u5316 (RMSNorm)</li>\n</ul>\n<span class=\"paragraph\">\u6700\u7ec8\u8f93\u51fa\u9884\u6d4b\u4e0b\u4e00\u4e2a\u8bcd\u7684\u6982\u7387\u5206\u5e03\u3002</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Vxnm",
      "code_hash": "0699a9fb5f9cc9297e048799f1aefb05",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><h2 id=\"_1\">\ud83d\udd2c \u6269\u5c55\u5b9e\u9a8c: \u591a\u4e2a\u53e5\u5b50\u7684\u6279\u5904\u7406</h2>\n<span class=\"paragraph\">\u5b9e\u9645\u8bad\u7ec3\u65f6,\u6211\u4eec\u4f1a\u540c\u65f6\u5904\u7406\u591a\u4e2a\u53e5\u5b50 (batch)</span></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "ulZA",
      "code_hash": "4027b0035d6c1dc001ceae27c3c7b09f",
      "outputs": [
        {
          "type": "data",
          "data": {
            "text/markdown": "<span class=\"markdown prose dark:prose-invert contents\"><hr />\n<h2 id=\"_1\">\ud83d\udcda \u53c2\u8003\u8d44\u6599</h2>\n<ul>\n<li>\u5b8c\u6574\u4ee3\u7801: <code>\u4ece\u5934\u5f00\u59cb\u8bad\u7ec3\u81ea\u5df1\u7684\u5927\u6a21\u578b.py</code></li>\n<li>\u8be6\u7ec6\u89e3\u91ca: <code>\u4ece\u5934\u5f00\u59cb\u8bad\u7ec3\u81ea\u5df1\u7684\u5927\u6a21\u578b.md</code></li>\n<li>Transformer \u8bba\u6587: <a href=\"https://arxiv.org/abs/1706.03762\" rel=\"noopener noreferrer\" target=\"_blank\">Attention Is All You Need</a></li>\n</ul></span>"
          }
        }
      ],
      "console": []
    },
    {
      "id": "Hbol",
      "code_hash": "ef4aa68db4bd14348bee73032bfb1728",
      "outputs": [],
      "console": []
    },
    {
      "id": "vblA",
      "code_hash": "9d1bbc8561f4c8c91bd7bec1b65cfee2",
      "outputs": [],
      "console": []
    },
    {
      "id": "lEQa",
      "code_hash": "5aaf10e8191908c1ec044cb832752fc3",
      "outputs": [],
      "console": []
    },
    {
      "id": "BYtC",
      "code_hash": "1539ec467be0569c039dcec215e3d07f",
      "outputs": [],
      "console": []
    },
    {
      "id": "emfo",
      "code_hash": "7953d44341ea94aabd553962059b5599",
      "outputs": [],
      "console": []
    },
    {
      "id": "nWHF",
      "code_hash": "e17586a5667be0a153e29ff08ed33633",
      "outputs": [],
      "console": []
    },
    {
      "id": "ZHCJ",
      "code_hash": "6aa67abce5fc6081940b4ceee8128849",
      "outputs": [],
      "console": []
    },
    {
      "id": "qnkX",
      "code_hash": "053c361b789f4a430c51b5c371bd2c2e",
      "outputs": [],
      "console": []
    },
    {
      "id": "DnEU",
      "code_hash": "c7ab7e46ffc02c1416c70ae2d68902f8",
      "outputs": [],
      "console": []
    }
  ]
}