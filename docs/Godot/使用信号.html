<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Godot/使用信号" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">使用信号 | Cruldra</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/notes3/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/notes3/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/notes3/docs/Godot/使用信号"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="使用信号 | Cruldra"><meta data-rh="true" name="description" content="在本节课中，我们将探讨信号。信号是节点在发生特定事件时发出的消息，例如按钮被按下。其他节点可以连接到该信号，并在事件发生时调用一个函数。"><meta data-rh="true" property="og:description" content="在本节课中，我们将探讨信号。信号是节点在发生特定事件时发出的消息，例如按钮被按下。其他节点可以连接到该信号，并在事件发生时调用一个函数。"><link data-rh="true" rel="icon" href="/notes3/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/notes3/docs/Godot/使用信号"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/notes3/docs/Godot/使用信号" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/notes3/docs/Godot/使用信号" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"使用信号","item":"https://your-docusaurus-site.example.com/notes3/docs/Godot/使用信号"}]}</script><link rel="alternate" type="application/rss+xml" href="/notes3/blog/rss.xml" title="Cruldra RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/notes3/blog/atom.xml" title="Cruldra Atom Feed"><link rel="stylesheet" href="/notes3/assets/css/styles.48a6e6d2.css">
<script src="/notes3/assets/js/runtime~main.04368516.js" defer="defer"></script>
<script src="/notes3/assets/js/main.dcb0ce96.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme",window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-theme-choice","system"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/notes3/img/logo.svg"><style data-mantine-styles="classes">@media (max-width: 35.99375em) {.mantine-visible-from-xs {display: none !important;}}@media (min-width: 36em) {.mantine-hidden-from-xs {display: none !important;}}@media (max-width: 47.99375em) {.mantine-visible-from-sm {display: none !important;}}@media (min-width: 48em) {.mantine-hidden-from-sm {display: none !important;}}@media (max-width: 61.99375em) {.mantine-visible-from-md {display: none !important;}}@media (min-width: 62em) {.mantine-hidden-from-md {display: none !important;}}@media (max-width: 74.99375em) {.mantine-visible-from-lg {display: none !important;}}@media (min-width: 75em) {.mantine-hidden-from-lg {display: none !important;}}@media (max-width: 87.99375em) {.mantine-visible-from-xl {display: none !important;}}@media (min-width: 88em) {.mantine-hidden-from-xl {display: none !important;}}</style><div role="region" aria-label="Skip to main content"><a class="skipToContent_aA1M" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/notes3/"><div class="navbar__logo"><img src="/notes3/img/logo.svg" alt="My Site Logo" class="themedComponent_E3Xm themedComponent--light_DVqC"><img src="/notes3/img/logo.svg" alt="My Site Logo" class="themedComponent_E3Xm themedComponent--dark_B_L3"></div><b class="navbar__title text--truncate">Cruldra</b></a><a class="navbar__item navbar__link" href="/notes3/docs/category/设计模式">JVM</a><a class="navbar__item navbar__link" href="/notes3/docs/category/css">前端</a><a class="navbar__item navbar__link" href="/notes3/docs/category/astrbot">工具</a><a class="navbar__item navbar__link" href="/notes3/docs/category/ai电竞酒店">个人</a><a class="navbar__item navbar__link" href="/notes3/docs/AI/ACP/架构">AI</a><a class="navbar__item navbar__link" href="/notes3/docs/category/内置模块">Python</a><a class="navbar__item navbar__link" href="/notes3/docs/category/actix-web">Rust</a><a class="navbar__item navbar__link" href="/notes3/docs/category/数据库系统">软件工程</a><a class="navbar__item navbar__link" href="/notes3/docs/category/上古卷轴5">游戏</a><a class="navbar__item navbar__link" href="/notes3/docs/Go/Go-Python-Java三语言全方位对比">Go</a><a class="navbar__item navbar__link" href="/notes3/docs/Hardware/GPU工作原理">硬件</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/notes3/docs/Godot/功能列表">Godot</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_PufJ"><div class="navbar__search searchBarContainer_r6C1" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_G4_y" value=""><div class="loadingRing__Zfe searchBarLoadingRing_f0pn"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_ctfR"><div class="docsWrapper_ByIB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_KwvU" type="button"></button><div class="docRoot_hD6z"><aside class="theme-doc-sidebar-container docSidebarContainer_KuHC"><div class="sidebarViewport_LCjr"><div class="sidebar_L77d"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_VYAF"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Godot/功能列表"><span title="功能列表" class="linkLabel__RqX">功能列表</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Godot/核心概念概览"><span title="核心概念概览" class="linkLabel__RqX">核心概念概览</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Godot/初识编辑器界面"><span title="初识编辑器界面" class="linkLabel__RqX">初识编辑器界面</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Godot/学习新特性"><span title="学习新特性" class="linkLabel__RqX">学习新特性</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Godot/设计理念"><span title="设计理念" class="linkLabel__RqX">设计理念</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Godot/节点与场景"><span title="节点与场景" class="linkLabel__RqX">节点与场景</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Godot/创建场景实例"><span title="创建场景实例" class="linkLabel__RqX">创建场景实例</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Godot/脚本语言"><span title="脚本语言" class="linkLabel__RqX">脚本语言</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Godot/编写你的第一个脚本"><span title="编写你的第一个脚本" class="linkLabel__RqX">编写你的第一个脚本</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Godot/监听玩家输入"><span title="监听玩家输入" class="linkLabel__RqX">监听玩家输入</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/notes3/docs/Godot/使用信号"><span title="使用信号" class="linkLabel__RqX">使用信号</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/Godot/GodotScript/Lesson_1_What_Code_Is_Like"><span title="GodotScript" class="categoryLinkLabel_FHN4">GodotScript</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Godot/Godot简介"><span title="Godot简介" class="linkLabel__RqX">Godot简介</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Godot/Node、Sprint、Area这三个2d类的区别"><span title="Node、Sprint、Area这三个2d类的区别" class="linkLabel__RqX">Node、Sprint、Area这三个2d类的区别</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Godot/介绍"><span title="介绍" class="linkLabel__RqX">介绍</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Godot/使用GDScript学习编程"><span title="使用GDScript学习编程" class="linkLabel__RqX">使用GDScript学习编程</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Godot/发布策略"><span title="发布策略" class="linkLabel__RqX">发布策略</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Godot/常见问题"><span title="常见问题" class="linkLabel__RqX">常见问题</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/Godot/第一个2D游戏/简介"><span title="第一个2D游戏" class="categoryLinkLabel_FHN4">第一个2D游戏</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Godot/简介"><span title="简介" class="linkLabel__RqX">简介</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/Godot/遇到的问题/保存场景时遇到性能警告"><span title="遇到的问题" class="categoryLinkLabel_FHN4">遇到的问题</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_WxcZ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_Zd2x"><div class="docItemContainer_EEW4"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_xL_w" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/notes3/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_zA1U"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">使用信号</span></li></ul></nav><div class="tocCollapsible_aZGz theme-doc-toc-mobile tocMobile_ShCt"><button type="button" class="clean-btn tocCollapsibleButton_fxzH">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>使用信号</h1></header><p>在本节课中，我们将探讨信号。信号是节点在发生特定事件时发出的消息，例如按钮被按下。其他节点可以连接到该信号，并在事件发生时调用一个函数。</p>
<p>信号是 Godot 内置的一种委托机制，允许一个游戏对象在不引用另一个对象的情况下对另一个对象的更改做出反应。使用信号可以限制 <a href="https://en.wikipedia.org/wiki/Coupling_(computer_programming)" target="_blank" rel="noopener noreferrer" class="">耦合 (coupling)</a> 并保持代码的灵活性。</p>
<p>例如，你可能在屏幕上有一个代表玩家生命值的生命条。当玩家受到伤害或使用治疗药水时，你希望生命条反映这种变化。在 Godot 中，你会使用信号来实现这一点。</p>
<p>与方法 (<a href="https://docs.godotengine.org/en/stable/classes/class_callable.html" target="_blank" rel="noopener noreferrer" class="">Callable</a>) 一样，自 Godot 4.0 起，信号也是一等类型 (first-class type)。这意味着你可以直接将它们作为方法参数传递，而无需作为字符串传递，这有助于更好的自动补全并减少错误。有关直接使用 Signal 类型可以执行的操作列表，请参阅 <a href="https://docs.godotengine.org/en/stable/classes/class_signal.html" target="_blank" rel="noopener noreferrer" class="">Signal</a> 类参考。</p>
<blockquote>
<p><strong>另见</strong></p>
<p>正如简介中所述，信号是 Godot 版本的观察者模式。你可以在 <a href="https://gameprogrammingpatterns.com/observer.html" target="_blank" rel="noopener noreferrer" class="">《游戏编程模式》</a> 中了解更多相关信息。</p>
</blockquote>
<p>现在，我们将使用信号让上一课 (<a class="" href="/notes3/docs/Godot/监听玩家输入">监听玩家输入</a>) 中的 Godot 图标通过按下按钮来开始和停止移动。</p>
<blockquote>
<p><strong>注意</strong></p>
<p>在这个项目中，我们将遵循 Godot 的命名规范。</p>
<ul>
<li class=""><strong>GDScript</strong>：类（节点）使用 PascalCase，变量和函数使用 snake_case，常量使用 ALL_CAPS（参见 <a href="https://docs.godotengine.org/en/stable/tutorials/scripting/gdscript/gdscript_styleguide.html" target="_blank" rel="noopener noreferrer" class="">GDScript 风格指南</a>）。</li>
<li class=""><strong>C#</strong>：类、导出变量和方法使用 PascalCase，私有字段使用 _camelCase，局部变量和参数使用 camelCase（参见 <a href="https://docs.godotengine.org/en/stable/tutorials/scripting/c_sharp/c_sharp_style_guide.html" target="_blank" rel="noopener noreferrer" class="">C# 风格指南</a>）。在连接信号时，请务必准确输入方法名称。</li>
</ul>
</blockquote>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="场景设置-scene-setup">场景设置 (Scene setup)<a href="#场景设置-scene-setup" class="hash-link" aria-label="Direct link to 场景设置 (Scene setup)" title="Direct link to 场景设置 (Scene setup)" translate="no">​</a></h2>
<p>为了给游戏添加按钮，我们将创建一个新场景，其中包含一个 <a href="https://docs.godotengine.org/en/stable/classes/class_button.html" target="_blank" rel="noopener noreferrer" class="">Button</a> 节点和我们在 <a class="" href="/notes3/docs/Godot/编写你的第一个脚本">编写你的第一个脚本</a> 一课中创建的 <code>sprite_2d.tscn</code> 场景。</p>
<p>通过菜单 <strong>场景 &gt; 新建场景 (Scene &gt; New Scene)</strong> 创建一个新场景。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_01_new_scene.webp" alt="New Scene" class="img_kBI4"></p>
<p>在 “场景” 面板中，点击 <strong>2D 场景 (2D Scene)</strong> 按钮。这将添加一个 <code>Node2D</code> 作为我们的根节点。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_02_2d_scene.webp" alt="2D Scene" class="img_kBI4"></p>
<p>在 “文件系统 (FileSystem)” 面板中，点击并拖动你之前保存的 <code>sprite_2d.tscn</code> 文件到 <code>Node2D</code> 上以其实例化。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_03_dragging_scene.webp" alt="Dragging Scene" class="img_kBI4"></p>
<p>我们想添加另一个节点作为 <code>Sprite2D</code> 的兄弟节点。为此，右键点击 <code>Node2D</code> 并选择 <strong>添加子节点 (Add Child Node)</strong>。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_04_add_child_node.webp" alt="Add Child Node" class="img_kBI4"></p>
<p>搜索 <code>Button</code> 节点并添加它。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_05_add_button.webp" alt="Add Button" class="img_kBI4"></p>
<p>该节点默认很小。在视口中点击并拖动 <code>Button</code> 的右下角句柄来调整其大小。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_06_drag_button.png" alt="Drag Button" class="img_kBI4"></p>
<p>如果你没看到句柄，请确保工具栏中的选择工具已激活。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_07_select_tool.webp" alt="Select Tool" class="img_kBI4"></p>
<p>点击并拖动按钮本身，使其靠近精灵。</p>
<p>你还可以通过在检查器中编辑其 <code>Text</code> 属性来在按钮上写一个标签。输入 <code>Toggle motion</code> (切换运动)。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_08_toggle_motion_text.webp" alt="Toggle Motion Text" class="img_kBI4"></p>
<p>你的场景树和视口应该如下所示。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_09_scene_setup.webp" alt="Scene Setup" class="img_kBI4"></p>
<p>如果尚未保存，请将新创建的场景保存为 <code>node_2d.tscn</code>。然后你可以按 <strong>F6</strong> (macOS 为 <strong>Cmd + R</strong>) 运行它。目前，按钮是可见的，但按下它不会发生任何事情。</p>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="在编辑器中连接信号-connecting-a-signal-in-the-editor">在编辑器中连接信号 (Connecting a signal in the editor)<a href="#在编辑器中连接信号-connecting-a-signal-in-the-editor" class="hash-link" aria-label="Direct link to 在编辑器中连接信号 (Connecting a signal in the editor)" title="Direct link to 在编辑器中连接信号 (Connecting a signal in the editor)" translate="no">​</a></h2>
<p>这里，我们要将按钮的 “pressed” 信号连接到我们的 <code>Sprite2D</code>，并希望调用一个新函数来切换其运动的开启和关闭。我们需要在 <code>Sprite2D</code> 节点上附加一个脚本，我们在上一课已经完成了这一操作。</p>
<p>你可以在 “节点 (Node)” 面板中连接信号。选择 <code>Button</code> 节点，在编辑器右侧，点击检查器旁边的 <strong>节点 (Node)</strong> 选项卡，然后选择 <strong>信号 (Signals)</strong>。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_10_node_dock.webp" alt="Node Dock" class="img_kBI4"></p>
<p>该面板显示了所选节点上可用的信号列表。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_11_pressed_signals.webp" alt="Pressed Signals" class="img_kBI4"></p>
<p>双击 “pressed” 信号打开节点连接窗口。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_12_node_connection.webp" alt="Node Connection" class="img_kBI4"></p>
<p>在这里，你可以将信号连接到 <code>Sprite2D</code> 节点。该节点需要一个接收方法，即当按钮发出信号时 Godot 将调用的函数。编辑器会为你生成一个。按照惯例，我们将这些回调方法命名为 “_on_node_name_signal_name”。在这里，它将是 “_on_button_pressed”。</p>
<blockquote>
<p><strong>注意</strong></p>
<p>通过编辑器的 “节点” 面板连接信号时，你可以使用两种模式。简单模式仅允许你连接到已附加脚本的节点，并在其上创建新的回调函数。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_advanced_connection_window.webp" alt="Advanced Connection Window" class="img_kBI4"></p>
<p>高级视图允许你连接到任何节点和任何内置函数，为回调添加参数并设置选项。你可以点击窗口右下角的 “高级 (Advanced)” 按钮来切换模式。</p>
</blockquote>
<blockquote>
<p><strong>注意</strong></p>
<p>如果你使用的是外部编辑器（如 VS Code），这种自动代码生成可能无法工作。在这种情况下，你需要通过代码连接信号，如下一节所述。</p>
</blockquote>
<p>点击 <strong>连接 (Connect)</strong> 按钮完成信号连接并跳转到脚本工作区。你应该会在左侧边栏看到带有连接图标的新方法。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_13_signals_connection_icon.webp" alt="Signals Connection Icon" class="img_kBI4"></p>
<p>如果点击该图标，会弹出一个窗口并显示有关连接的信息。此功能仅在编辑器中连接节点时可用。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_14_signals_connection_info.webp" alt="Signals Connection Info" class="img_kBI4"></p>
<p>让我们用切换节点运动的代码替换带有 <code>pass</code> 关键字的行。</p>
<p>我们的 <code>Sprite2D</code> 通过 <code>_process()</code> 函数中的代码进行移动。Godot 提供了一个切换处理开启和关闭的方法：<a href="https://docs.godotengine.org/en/stable/classes/class_node.html#class-node-method-set-process" target="_blank" rel="noopener noreferrer" class="">Node.set_process()</a>。<code>Node</code> 类的另一个方法 <code>is_processing()</code> 在空闲处理激活时返回 <code>true</code>。我们可以使用 <code>not</code> 关键字来反转该值。</p>
<div class="language-gdscript codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-gdscript codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">func _on_button_pressed():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	set_process(not is_processing())</span><br></span></code></pre></div></div>
<div class="language-csharp codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-csharp codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">// 我们还在编辑器的连接窗口中以 PascalCase 指定了此函数名称。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">private void OnButtonPressed()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SetProcess(!IsProcessing());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>按下按钮后，此函数将切换处理，进而开启或关闭图标的运动。</p>
<p>在尝试游戏之前，我们需要简化我们的 <code>_process()</code> 函数以自动移动节点，而不是等待用户输入。将其替换为我们在两课前看到的以下代码：</p>
<div class="language-gdscript codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-gdscript codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">func _process(delta):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	rotation += angular_speed * delta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	var velocity = Vector2.UP.rotated(rotation) * speed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	position += velocity * delta</span><br></span></code></pre></div></div>
<div class="language-csharp codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-csharp codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">public override void _Process(double delta)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Rotation += _angularSpeed * (float)delta;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var velocity = Vector2.Up.Rotated(Rotation) * _speed;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Position += velocity * (float)delta;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>你的完整 <code>sprite_2d.gd</code> 代码应该如下所示：</p>
<div class="language-gdscript codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-gdscript codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">extends Sprite2D</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var speed = 400</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var angular_speed = PI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func _process(delta):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	rotation += angular_speed * delta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	var velocity = Vector2.UP.rotated(rotation) * speed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	position += velocity * delta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func _on_button_pressed():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	set_process(not is_processing())</span><br></span></code></pre></div></div>
<div class="language-csharp codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-csharp codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">using Godot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public partial class MySprite2D : Sprite2D</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private float _speed = 400;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private float _angularSpeed = Mathf.Pi;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public override void _Process(double delta)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Rotation += _angularSpeed * (float)delta;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var velocity = Vector2.Up.Rotated(Rotation) * _speed;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Position += velocity * (float)delta;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 我们还在编辑器的连接窗口中以 PascalCase 指定了此函数名称。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private void OnButtonPressed()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SetProcess(!IsProcessing());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>按 <strong>F6</strong> (macOS 为 <strong>Cmd + R</strong>) 运行当前场景，并点击按钮查看精灵的开始和停止。</p>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="通过代码连接信号-connecting-a-signal-via-code">通过代码连接信号 (Connecting a signal via code)<a href="#通过代码连接信号-connecting-a-signal-via-code" class="hash-link" aria-label="Direct link to 通过代码连接信号 (Connecting a signal via code)" title="Direct link to 通过代码连接信号 (Connecting a signal via code)" translate="no">​</a></h2>
<p>你可以通过代码而不是使用编辑器来连接信号。当你从脚本内部创建节点或实例化场景时，这是必要的。</p>
<p>让我们在这里使用一个不同的节点。Godot 有一个 <a href="https://docs.godotengine.org/en/stable/classes/class_timer.html" target="_blank" rel="noopener noreferrer" class="">Timer (定时器)</a> 节点，对于实现技能冷却时间、武器装填等非常有用。</p>
<p>回到 2D 工作区。你可以点击窗口顶部的 “2D” 文本，或者按 <strong>Ctrl + F1</strong> (macOS 为 <strong>Ctrl + Cmd + 1</strong>)。</p>
<p>在 “场景” 面板中，右键点击 <code>Sprite2D</code> 节点并添加一个新的子节点。搜索 <code>Timer</code> 并添加相应的节点。你的场景现在应该如下所示。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_15_scene_tree.webp" alt="Scene Tree" class="img_kBI4"></p>
<p>选中 <code>Timer</code> 节点后，前往检查器并启用 <strong>Autostart (自动开始)</strong> 属性。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_18_timer_autostart.webp" alt="Timer Autostart" class="img_kBI4"></p>
<p>点击 <code>Sprite2D</code> 旁的脚本图标回到脚本工作区。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_16_click_script.webp" alt="Click Script" class="img_kBI4"></p>
<p>我们需要执行两个操作来通过代码连接节点：</p>
<ol>
<li class="">从 <code>Sprite2D</code> 获取对 <code>Timer</code> 的引用。</li>
<li class="">调用 <code>Timer</code> 的 “timeout” 信号的 <code>connect()</code> 方法。</li>
</ol>
<blockquote>
<p><strong>注意</strong></p>
<p>要通过代码连接到信号，你需要调用你想监听的信号的 <code>connect()</code> 方法。在这种情况下，我们要监听 <code>Timer</code> 的 “timeout” 信号。</p>
</blockquote>
<p>我们希望在场景实例化时连接信号，我们可以使用 <code>Node._ready()</code> 内置函数来完成，该函数在节点完全实例化时由引擎自动调用。</p>
<p>要获取相对于当前节点的节点引用，我们使用 <a href="https://docs.godotengine.org/en/stable/classes/class_node.html#class-node-method-get-node" target="_blank" rel="noopener noreferrer" class="">Node.get_node()</a> 方法。我们可以将引用存储在一个变量中。</p>
<div class="language-gdscript codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-gdscript codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">func _ready():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	var timer = get_node(&quot;Timer&quot;)</span><br></span></code></pre></div></div>
<div class="language-csharp codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-csharp codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">public override void _Ready()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var timer = GetNode&lt;Timer&gt;(&quot;Timer&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><code>get_node()</code> 函数查看 <code>Sprite2D</code> 的子节点并按名称获取节点。例如，如果你在编辑器中将 <code>Timer</code> 节点重命名为 “BlinkingTimer”，你就必须将调用更改为 <code>get_node(&quot;BlinkingTimer&quot;)</code>。</p>
<p>我们现在可以在 <code>_ready()</code> 函数中将 <code>Timer</code> 连接到 <code>Sprite2D</code>。</p>
<div class="language-gdscript codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-gdscript codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">func _ready():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	var timer = get_node(&quot;Timer&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	timer.timeout.connect(_on_timer_timeout)</span><br></span></code></pre></div></div>
<div class="language-csharp codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-csharp codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">public override void _Ready()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    var timer = GetNode&lt;Timer&gt;(&quot;Timer&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    timer.Timeout += OnTimerTimeout;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>这一行的意思是：我们将 <code>Timer</code> 的 “timeout” 信号连接到附加了脚本的节点上。当 <code>Timer</code> 发出 <code>timeout</code> 信号时，我们希望调用我们需要定义的 <code>_on_timer_timeout()</code> 函数。让我们把它添加到脚本底部，并用它来切换精灵的可见性。</p>
<blockquote>
<p><strong>注意</strong></p>
<p>按照惯例，我们在 GDScript 中将这些回调方法命名为 “_on_node_name_signal_name”，在 C# 中命名为 “OnNodeNameSignalName”。在这里，GDScript 为 “_on_timer_timeout”，C# 为 <code>OnTimerTimeout()</code>。</p>
</blockquote>
<div class="language-gdscript codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-gdscript codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">func _on_timer_timeout():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	visible = not visible</span><br></span></code></pre></div></div>
<div class="language-csharp codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-csharp codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">private void OnTimerTimeout()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Visible = !Visible;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><code>visible</code> 属性是一个控制节点可见性的布尔值。<code>visible = not visible</code> 行会切换该值。如果 <code>visible</code> 是 <code>true</code>，它就变成 <code>false</code>，反之亦然。</p>
<p>如果你现在运行 <code>Node2D</code> 场景，你会看到精灵以一秒为间隔闪烁。</p>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="完整脚本">完整脚本<a href="#完整脚本" class="hash-link" aria-label="Direct link to 完整脚本" title="Direct link to 完整脚本" translate="no">​</a></h2>
<p>我们这个会动且会闪烁的 Godot 图标演示到此为止！这里提供完整的 <code>sprite_2d.gd</code> 文件供参考。</p>
<div class="language-gdscript codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-gdscript codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">extends Sprite2D</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var speed = 400</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var angular_speed = PI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func _ready():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	var timer = get_node(&quot;Timer&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	timer.timeout.connect(_on_timer_timeout)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func _process(delta):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	rotation += angular_speed * delta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	var velocity = Vector2.UP.rotated(rotation) * speed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	position += velocity * delta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func _on_button_pressed():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	set_process(not is_processing())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">func _on_timer_timeout():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	visible = not visible</span><br></span></code></pre></div></div>
<div class="language-csharp codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-csharp codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">using Godot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public partial class MySprite2D : Sprite2D</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private float _speed = 400;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private float _angularSpeed = Mathf.Pi;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public override void _Ready()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var timer = GetNode&lt;Timer&gt;(&quot;Timer&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        timer.Timeout += OnTimerTimeout;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public override void _Process(double delta)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Rotation += _angularSpeed * (float)delta;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        var velocity = Vector2.Up.Rotated(Rotation) * _speed;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Position += velocity * (float)delta;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 我们还在编辑器的连接窗口中以 PascalCase 指定了此函数名称。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private void OnButtonPressed()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        SetProcess(!IsProcessing());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private void OnTimerTimeout()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Visible = !Visible;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="自定义信号-custom-signals">自定义信号 (Custom signals)<a href="#自定义信号-custom-signals" class="hash-link" aria-label="Direct link to 自定义信号 (Custom signals)" title="Direct link to 自定义信号 (Custom signals)" translate="no">​</a></h2>
<blockquote>
<p><strong>注意</strong></p>
<p>本节是关于如何定义和使用你自己的信号的参考，并不基于前几课创建的项目。</p>
</blockquote>
<p>你可以在脚本中定义自定义信号。例如，假设你想在玩家生命值降至零时显示游戏结束屏幕。为此，你可以定义一个名为 “died” 或 “health_depleted” 的信号。</p>
<div class="language-gdscript codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-gdscript codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">extends Node2D</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">signal health_depleted</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var health = 10</span><br></span></code></pre></div></div>
<div class="language-csharp codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-csharp codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">using Godot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public partial class MyNode2D : Node2D</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Signal]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public delegate void HealthDepletedEventHandler();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private int _health = 10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>注意</strong></p>
<p>由于信号代表刚刚发生的事件，我们通常在它们的名称中使用动词的过去式。</p>
</blockquote>
<p>你的信号与内置信号的工作方式相同：它们会出现在 “信号” 选项卡中，你可以像连接其他信号一样连接它们。</p>
<p><img decoding="async" loading="lazy" src="https://docs.godotengine.org/en/stable/_images/signals_17_custom_signal.webp" alt="Custom Signal" class="img_kBI4"></p>
<p>要在脚本中发出信号，请调用该信号的 <code>emit()</code>。</p>
<div class="language-gdscript codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-gdscript codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">func take_damage(amount):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	health -= amount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	if health &lt;= 0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		health_depleted.emit()</span><br></span></code></pre></div></div>
<div class="language-csharp codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-csharp codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">public void TakeDamage(int amount)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _health -= amount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (_health &lt;= 0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        EmitSignal(SignalName.HealthDepleted);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>信号可以选择声明一个或多个参数。在括号之间指定参数名称：</p>
<div class="language-gdscript codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-gdscript codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">extends Node2D</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">signal health_changed(old_value, new_value)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var health = 10</span><br></span></code></pre></div></div>
<div class="language-csharp codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-csharp codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">using Godot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public partial class MyNode : Node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Signal]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public delegate void HealthChangedEventHandler(int oldValue, int newValue);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private int _health = 10;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<blockquote>
<p><strong>注意</strong></p>
<p>信号参数会显示在编辑器的节点面板中，Godot 可以使用它们为你生成回调函数。但是，你在发出信号时仍然可以发出任意数量的参数。因此，发出正确的值取决于你自己。</p>
</blockquote>
<p>要连同信号一起发出值，请将它们作为 <code>emit()</code> 函数的额外参数添加：</p>
<div class="language-gdscript codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-gdscript codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">func take_damage(amount):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	var old_health = health</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	health -= amount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	health_changed.emit(old_health, health)</span><br></span></code></pre></div></div>
<div class="language-csharp codeBlockContainer_FVab theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oMSL"><pre tabindex="0" class="prism-code language-csharp codeBlock_MTmK thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_KEkQ"><span class="token-line" style="color:#393A34"><span class="token plain">public void TakeDamage(int amount)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    int oldHealth = _health;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _health -= amount;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    EmitSignal(SignalName.HealthChanged, oldHealth, _health);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="总结">总结<a href="#总结" class="hash-link" aria-label="Direct link to 总结" title="Direct link to 总结" translate="no">​</a></h2>
<p>在 Godot 中，任何节点在发生特定事件时都会发出信号，例如按钮被按下。其他节点可以连接到单个信号并对选定的事件做出反应。</p>
<p>信号有很多用途。使用它们，你可以对节点进入或退出游戏世界、碰撞、角色进入或离开区域、界面元素改变大小等做出反应。</p>
<p>例如，代表金币的 <a href="https://docs.godotengine.org/en/stable/classes/class_area2d.html" target="_blank" rel="noopener noreferrer" class="">Area2D</a> 每当玩家的物理体进入其碰撞形状时就会发出 <code>body_entered</code> 信号，从而让你知道玩家何时收集了它。</p>
<p>在下一节 <a href="https://docs.godotengine.org/en/stable/getting_started/first_2d_game/index.html" target="_blank" rel="noopener noreferrer" class="">你的第一个 2D 游戏</a> 中，你将创建一个完整的 2D 游戏，并将你目前学到的所有内容付诸实践。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_iDCr"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Godot/使用信号.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_c0mv" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mxtt"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/notes3/docs/Godot/监听玩家输入"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">监听玩家输入</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/notes3/docs/Godot/GodotScript/Lesson_1_What_Code_Is_Like"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">第一课：代码是什么样的 (What Code is Like)</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_r83r thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#场景设置-scene-setup" class="table-of-contents__link toc-highlight">场景设置 (Scene setup)</a></li><li><a href="#在编辑器中连接信号-connecting-a-signal-in-the-editor" class="table-of-contents__link toc-highlight">在编辑器中连接信号 (Connecting a signal in the editor)</a></li><li><a href="#通过代码连接信号-connecting-a-signal-via-code" class="table-of-contents__link toc-highlight">通过代码连接信号 (Connecting a signal via code)</a></li><li><a href="#完整脚本" class="table-of-contents__link toc-highlight">完整脚本</a></li><li><a href="#自定义信号-custom-signals" class="table-of-contents__link toc-highlight">自定义信号 (Custom signals)</a></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>