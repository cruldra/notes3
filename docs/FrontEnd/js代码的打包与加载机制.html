<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-FrontEnd/js代码的打包与加载机制" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">js代码的打包与加载机制 | Cruldra</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/notes3/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/notes3/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/notes3/docs/FrontEnd/js代码的打包与加载机制"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="js代码的打包与加载机制 | Cruldra"><meta data-rh="true" name="description" content="这份技术笔记旨在系统地梳理 JavaScript 代码从开发者的编辑器到最终在浏览器中运行，中间经历的整个“打包”与“加载”的生命周期。"><meta data-rh="true" property="og:description" content="这份技术笔记旨在系统地梳理 JavaScript 代码从开发者的编辑器到最终在浏览器中运行，中间经历的整个“打包”与“加载”的生命周期。"><link data-rh="true" rel="icon" href="/notes3/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/notes3/docs/FrontEnd/js代码的打包与加载机制"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/notes3/docs/FrontEnd/js代码的打包与加载机制" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/notes3/docs/FrontEnd/js代码的打包与加载机制" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"js代码的打包与加载机制","item":"https://your-docusaurus-site.example.com/notes3/docs/FrontEnd/js代码的打包与加载机制"}]}</script><link rel="alternate" type="application/rss+xml" href="/notes3/blog/rss.xml" title="Cruldra RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/notes3/blog/atom.xml" title="Cruldra Atom Feed"><link rel="stylesheet" href="/notes3/assets/css/styles.8c4657fb.css">
<script src="/notes3/assets/js/runtime~main.a0c4d8b3.js" defer="defer"></script>
<script src="/notes3/assets/js/main.20a6d5ca.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme",window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-theme-choice","system"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/notes3/img/logo.svg"><style data-mantine-styles="classes">@media (max-width: 35.99375em) {.mantine-visible-from-xs {display: none !important;}}@media (min-width: 36em) {.mantine-hidden-from-xs {display: none !important;}}@media (max-width: 47.99375em) {.mantine-visible-from-sm {display: none !important;}}@media (min-width: 48em) {.mantine-hidden-from-sm {display: none !important;}}@media (max-width: 61.99375em) {.mantine-visible-from-md {display: none !important;}}@media (min-width: 62em) {.mantine-hidden-from-md {display: none !important;}}@media (max-width: 74.99375em) {.mantine-visible-from-lg {display: none !important;}}@media (min-width: 75em) {.mantine-hidden-from-lg {display: none !important;}}@media (max-width: 87.99375em) {.mantine-visible-from-xl {display: none !important;}}@media (min-width: 88em) {.mantine-hidden-from-xl {display: none !important;}}</style><div role="region" aria-label="Skip to main content"><a class="skipToContent_aA1M" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/notes3/"><div class="navbar__logo"><img src="/notes3/img/logo.svg" alt="My Site Logo" class="themedComponent_E3Xm themedComponent--light_DVqC"><img src="/notes3/img/logo.svg" alt="My Site Logo" class="themedComponent_E3Xm themedComponent--dark_B_L3"></div><b class="navbar__title text--truncate">Cruldra</b></a><a class="navbar__item navbar__link" href="/notes3/docs/category/设计模式">JVM</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/notes3/docs/category/css">前端</a><a class="navbar__item navbar__link" href="/notes3/docs/category/astrbot">工具</a><a class="navbar__item navbar__link" href="/notes3/docs/category/ai电竞酒店">个人</a><a class="navbar__item navbar__link" href="/notes3/docs/AI/ACP/架构">AI</a><a class="navbar__item navbar__link" href="/notes3/docs/category/内置模块">Python</a><a class="navbar__item navbar__link" href="/notes3/docs/category/actix-web">Rust</a><a class="navbar__item navbar__link" href="/notes3/docs/category/数据库系统">软件工程</a><a class="navbar__item navbar__link" href="/notes3/docs/category/上古卷轴5">游戏</a><a class="navbar__item navbar__link" href="/notes3/docs/Go/Go-Python-Java三语言全方位对比">Go</a><a class="navbar__item navbar__link" href="/notes3/docs/Hardware/intro">硬件</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_PufJ"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_ctfR"><div class="docsWrapper_ByIB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_KwvU" type="button"></button><div class="docRoot_hD6z"><aside class="theme-doc-sidebar-container docSidebarContainer_KuHC"><div class="sidebarViewport_LCjr"><div class="sidebar_L77d"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_VYAF"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist" href="/notes3/docs/category/css"><span title="Css" class="categoryLinkLabel_FHN4">Css</span></a><button aria-label="Expand sidebar category &#x27;Css&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist" href="/notes3/docs/category/常用库-1"><span title="常用库" class="categoryLinkLabel_FHN4">常用库</span></a><button aria-label="Expand sidebar category &#x27;常用库&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist" href="/notes3/docs/category/小程序"><span title="小程序" class="categoryLinkLabel_FHN4">小程序</span></a><button aria-label="Expand sidebar category &#x27;小程序&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist" href="/notes3/docs/category/react"><span title="React" class="categoryLinkLabel_FHN4">React</span></a><button aria-label="Expand sidebar category &#x27;React&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist" href="/notes3/docs/category/tauri"><span title="Tauri" class="categoryLinkLabel_FHN4">Tauri</span></a><button aria-label="Expand sidebar category &#x27;Tauri&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist" href="/notes3/docs/category/vite"><span title="Vite" class="categoryLinkLabel_FHN4">Vite</span></a><button aria-label="Expand sidebar category &#x27;Vite&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist" href="/notes3/docs/category/zustand"><span title="Zustand" class="categoryLinkLabel_FHN4">Zustand</span></a><button aria-label="Expand sidebar category &#x27;Zustand&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/FrontEnd/DeepChat/安装"><span title="DeepChat" class="categoryLinkLabel_FHN4">DeepChat</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/FrontEnd/Mantine/Mantine8更新内容"><span title="Mantine" class="categoryLinkLabel_FHN4">Mantine</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/FrontEnd/Metro UI/AppBar"><span title="Metro UI" class="categoryLinkLabel_FHN4">Metro UI</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/FrontEnd/ServiceWorker"><span title="ServiceWorker" class="linkLabel__RqX">ServiceWorker</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/FrontEnd/TypeScript/remeda"><span title="TypeScript" class="categoryLinkLabel_FHN4">TypeScript</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_NhDl menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/FrontEnd/Unocss/配置说明"><span title="Unocss" class="categoryLinkLabel_FHN4">Unocss</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/notes3/docs/FrontEnd/js代码的打包与加载机制"><span title="js代码的打包与加载机制" class="linkLabel__RqX">js代码的打包与加载机制</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/FrontEnd/monorepo-structure"><span title="Monorepo 结构分析" class="linkLabel__RqX">Monorepo 结构分析</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/FrontEnd/pnpm-monorepo"><span title="pnpm-monorepo" class="linkLabel__RqX">pnpm-monorepo</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_WxcZ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_Zd2x"><div class="docItemContainer_EEW4"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_xL_w" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/notes3/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_zA1U"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">js代码的打包与加载机制</span></li></ul></nav><div class="tocCollapsible_aZGz theme-doc-toc-mobile tocMobile_ShCt"><button type="button" class="clean-btn tocCollapsibleButton_fxzH">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>js代码的打包与加载机制</h1></header><p>这份技术笔记旨在系统地梳理 <strong>JavaScript 代码从开发者的编辑器到最终在浏览器中运行</strong>，中间经历的整个“打包”与“加载”的生命周期。</p>
<p>这个过程本质上是为了解决一个核心矛盾：<strong>开发者追求的“模块化开发体验”与浏览器追求的“高效加载与兼容性”之间的矛盾</strong>。</p>
<hr>
<h1>技术笔记：JavaScript 代码的打包与加载机制全解</h1>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="一-核心矛盾为什么在这个环节有这么多概念">一、 核心矛盾：为什么在这个环节有这么多概念？<a href="#一-核心矛盾为什么在这个环节有这么多概念" class="hash-link" aria-label="Direct link to 一、 核心矛盾：为什么在这个环节有这么多概念？" title="Direct link to 一、 核心矛盾：为什么在这个环节有这么多概念？" translate="no">​</a></h2>
<p>在理解技术细节前，必须明确两个完全不同的环境需求：</p>
<ol>
<li class=""><strong>开发环境 (Dev Land)</strong>：开发者希望代码拆分得越细越好（模块化），使用最新的语法（糖），有类型检查（TypeScript），代码具有可读性。</li>
<li class=""><strong>生产环境 (Browser Land)</strong>：浏览器希望文件越小越好（压缩），网络请求越少越好（合并），能在老旧设备上跑（兼容性）。</li>
</ol>
<p><strong>“打包工具” (Bundler)</strong> 和 <strong>“加载策略” (Loading Strategy)</strong> 就是连接这两个世界的桥梁。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="二-模块化规范代码的组织形式">二、 模块化规范：代码的“组织形式”<a href="#二-模块化规范代码的组织形式" class="hash-link" aria-label="Direct link to 二、 模块化规范：代码的“组织形式”" title="Direct link to 二、 模块化规范：代码的“组织形式”" translate="no">​</a></h2>
<p>这是代码在物理层面如何互相引用的规则。历史的演变留下了多种格式。</p>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="1-史前时代global--iife">1. 史前时代：Global &amp; IIFE<a href="#1-史前时代global--iife" class="hash-link" aria-label="Direct link to 1. 史前时代：Global &amp; IIFE" title="Direct link to 1. 史前时代：Global &amp; IIFE" translate="no">​</a></h3>
<ul>
<li class=""><strong>Global（全局变量）</strong>：所有代码直接写在文件里，共享 <code>window</code>。<!-- -->
<ul>
<li class=""><em>问题</em>：命名冲突（Namespace Pollution），无法管理依赖顺序。</li>
</ul>
</li>
<li class=""><strong>IIFE (立即执行函数表达式)</strong>：用 <code>(function(){ ... })()</code> 包裹代码。<!-- -->
<ul>
<li class=""><em>作用</em>：通过闭包模拟私有作用域，是早期模块化的雏形（如 jQuery 插件）。</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="2-服务器端的崛起commonjs-cjs">2. 服务器端的崛起：CommonJS (CJS)<a href="#2-服务器端的崛起commonjs-cjs" class="hash-link" aria-label="Direct link to 2. 服务器端的崛起：CommonJS (CJS)" title="Direct link to 2. 服务器端的崛起：CommonJS (CJS)" translate="no">​</a></h3>
<ul>
<li class=""><strong>语法</strong>：<code>require(&#x27;fs&#x27;)</code> 和 <code>module.exports</code>。</li>
<li class=""><strong>特点</strong>：<strong>同步加载</strong>。</li>
<li class=""><strong>局限</strong>：设计用于 Node.js 服务器端。在浏览器中，不能“同步”读取文件（会导致页面卡死等待网络请求），因此无法直接在浏览器运行，必须经过转换。</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="3-浏览器的妥协amd--umd">3. 浏览器的妥协：AMD &amp; UMD<a href="#3-浏览器的妥协amd--umd" class="hash-link" aria-label="Direct link to 3. 浏览器的妥协：AMD &amp; UMD" title="Direct link to 3. 浏览器的妥协：AMD &amp; UMD" translate="no">​</a></h3>
<ul>
<li class=""><strong>AMD (Asynchronous Module Definition)</strong>：专为浏览器设计的异步加载规范（代表作 RequireJS）。语法繁琐，已过时。</li>
<li class=""><strong>UMD (Universal Module Definition)</strong>：一种“防御性”写法。它包含一坨判断逻辑：“如果是 CJS 环境... 如果是 AMD 环境... 否则挂载到 window”。它是以前发布 npm 包的标准格式，为了兼容所有环境。</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="4-终极标准es-modules-esm">4. 终极标准：ES Modules (ESM)<a href="#4-终极标准es-modules-esm" class="hash-link" aria-label="Direct link to 4. 终极标准：ES Modules (ESM)" title="Direct link to 4. 终极标准：ES Modules (ESM)" translate="no">​</a></h3>
<ul>
<li class=""><strong>语法</strong>：<code>import { val } from &#x27;./mod&#x27;</code> 和 <code>export</code>。</li>
<li class=""><strong>特点</strong>：<!-- -->
<ul>
<li class=""><strong>静态分析</strong>：在代码运行前就在编译阶段确定依赖关系（这是 Tree Shaking 的基础）。</li>
<li class=""><strong>原生支持</strong>：现代浏览器（Using <code>&lt;script type=&quot;module&quot;&gt;</code>）和 Node.js 均已原生支持。</li>
<li class=""><strong>异步引用</strong>：适合网络环境。</li>
</ul>
</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="三-构建流水线代码的加工工厂">三、 构建流水线：代码的“加工工厂”<a href="#三-构建流水线代码的加工工厂" class="hash-link" aria-label="Direct link to 三、 构建流水线：代码的“加工工厂”" title="Direct link to 三、 构建流水线：代码的“加工工厂”" translate="no">​</a></h2>
<p>为了让开发者写的 ESM/TypeScript 代码能在所有浏览器跑起来，我们需要构建工具（Webpack, Rollup, Vite, Parcel）。这个过程包含几个核心概念：</p>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="1-依赖图谱解析-dependency-graph">1. 依赖图谱解析 (Dependency Graph)<a href="#1-依赖图谱解析-dependency-graph" class="hash-link" aria-label="Direct link to 1. 依赖图谱解析 (Dependency Graph)" title="Direct link to 1. 依赖图谱解析 (Dependency Graph)" translate="no">​</a></h3>
<p>打包工具从入口文件（Entry, 如 <code>main.js</code>）开始，像爬虫一样通过 <code>import/require</code> 语句递归寻找所有依赖文件，构建出一个巨大的依赖关系图。</p>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="2-转译-transpilation">2. 转译 (Transpilation)<a href="#2-转译-transpilation" class="hash-link" aria-label="Direct link to 2. 转译 (Transpilation)" title="Direct link to 2. 转译 (Transpilation)" translate="no">​</a></h3>
<p>将新语法的代码转换为旧语法，通常由 <strong>Babel</strong> 或 <strong>SWC</strong> 完成。</p>
<ul>
<li class=""><strong>Syntax Transform</strong>：把 <code>const / arrow functions</code> 转为 <code>var / function</code>。</li>
<li class=""><strong>Polyfill</strong>：为旧浏览器补充缺失的方法（如 <code>Promise</code>, <code>Array.prototype.includes</code>）。</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="3-打包-bundling">3. 打包 (Bundling)<a href="#3-打包-bundling" class="hash-link" aria-label="Direct link to 3. 打包 (Bundling)" title="Direct link to 3. 打包 (Bundling)" translate="no">​</a></h3>
<p>将成百上千个小模块文件，合并成一个或几个大文件（Bundle）。</p>
<ul>
<li class=""><strong>目的</strong>：减少 HTTP 请求数量（在 HTTP/1.1 时代至关重要）。</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="4-摇树优化-tree-shaking">4. 摇树优化 (Tree Shaking)<a href="#4-摇树优化-tree-shaking" class="hash-link" aria-label="Direct link to 4. 摇树优化 (Tree Shaking)" title="Direct link to 4. 摇树优化 (Tree Shaking)" translate="no">​</a></h3>
<ul>
<li class=""><strong>概念</strong>：基于 ESM 的静态结构，打包工具可以分析出哪些 <code>export</code> 出来的函数从来没被 <code>import</code> 过。</li>
<li class=""><strong>结果</strong>：这些“死代码”在最终打包时会被直接丢弃，减小体积。<strong>CJS 很难做 Tree Shaking，ESM 很容易。</strong></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="5-压缩与混淆-minification--uglification">5. 压缩与混淆 (Minification &amp; Uglification)<a href="#5-压缩与混淆-minification--uglification" class="hash-link" aria-label="Direct link to 5. 压缩与混淆 (Minification &amp; Uglification)" title="Direct link to 5. 压缩与混淆 (Minification &amp; Uglification)" translate="no">​</a></h3>
<ul>
<li class=""><strong>Minify</strong>：去除空格、换行、注释。</li>
<li class=""><strong>Mangle</strong>：将长变量名 <code>function calculateTotalPrice()</code> 改为 <code>function a()</code>。</li>
<li class=""><strong>工具</strong>：Terser, Esbuild。</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="四-浏览器加载代码的物流配送">四、 浏览器加载：代码的“物流配送”<a href="#四-浏览器加载代码的物流配送" class="hash-link" aria-label="Direct link to 四、 浏览器加载：代码的“物流配送”" title="Direct link to 四、 浏览器加载：代码的“物流配送”" translate="no">​</a></h2>
<p>打包好的文件（通常是 <code>.js</code>），如何被浏览器高效地加载？</p>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="1-传统的-script-src">1. 传统的 <code>&lt;script src=&quot;...&quot;&gt;</code><a href="#1-传统的-script-src" class="hash-link" aria-label="Direct link to 1-传统的-script-src" title="Direct link to 1-传统的-script-src" translate="no">​</a></h3>
<ul>
<li class=""><strong>行为</strong>：HTML 解析器遇到标签 -&gt; <strong>暂停解析</strong> -&gt; 下载脚本 -&gt; 执行脚本 -&gt; <strong>恢复解析</strong>。</li>
<li class=""><strong>后果</strong>：阻塞渲染（Render Blocking），导致白屏时间长。</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="2-defer-最佳实践">2. <code>defer</code> (最佳实践)<a href="#2-defer-最佳实践" class="hash-link" aria-label="Direct link to 2-defer-最佳实践" title="Direct link to 2-defer-最佳实践" translate="no">​</a></h3>
<ul>
<li class=""><strong>语法</strong>：<code>&lt;script defer src=&quot;...&quot;&gt;</code></li>
<li class=""><strong>行为</strong>：HTML 解析与脚本下载<strong>并行</strong>进行。脚本会在 HTML 解析完成后、<code>DOMContentLoaded</code> 事件触发前执行。</li>
<li class=""><strong>特点</strong>：严格保证执行顺序。</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="3-async-无序加载">3. <code>async</code> (无序加载)<a href="#3-async-无序加载" class="hash-link" aria-label="Direct link to 3-async-无序加载" title="Direct link to 3-async-无序加载" translate="no">​</a></h3>
<ul>
<li class=""><strong>语法</strong>：<code>&lt;script async src=&quot;...&quot;&gt;</code></li>
<li class=""><strong>行为</strong>：下载与 HTML 解析并行。下载一结束立刻暂停 HTML 解析并执行脚本。</li>
<li class=""><strong>适用</strong>：不依赖其他代码的独立脚本（如 Google Analytics, 广告脚本）。</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="4-动态导入-dynamic-import--代码分割-code-splitting">4. 动态导入 (Dynamic Import) / 代码分割 (Code Splitting)<a href="#4-动态导入-dynamic-import--代码分割-code-splitting" class="hash-link" aria-label="Direct link to 4. 动态导入 (Dynamic Import) / 代码分割 (Code Splitting)" title="Direct link to 4. 动态导入 (Dynamic Import) / 代码分割 (Code Splitting)" translate="no">​</a></h3>
<ul>
<li class=""><strong>语法</strong>：在 JS 代码中写 <code>import(&#x27;./module.js&#x27;).then(...)</code>。</li>
<li class=""><strong>行为</strong>：打包工具会将这部分代码拆分成单独的 Chunk。浏览器只有在运行到这行代码时（例如用户点击了某个按钮），才会去网络请求这个 JS 文件。</li>
<li class=""><strong>术语</strong>：Lazy Loading（懒加载）。</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="五-现代趋势bundless-无打包开发">五、 现代趋势：Bundless (无打包开发)<a href="#五-现代趋势bundless-无打包开发" class="hash-link" aria-label="Direct link to 五、 现代趋势：Bundless (无打包开发)" title="Direct link to 五、 现代趋势：Bundless (无打包开发)" translate="no">​</a></h2>
<p>随着浏览器对 ESM 的原生支持和 HTTP/2 多路复用的普及，前端工程化出现返璞归真的趋势。</p>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="1-http2-多路复用-multiplexing">1. HTTP/2 多路复用 (Multiplexing)<a href="#1-http2-多路复用-multiplexing" class="hash-link" aria-label="Direct link to 1. HTTP/2 多路复用 (Multiplexing)" title="Direct link to 1. HTTP/2 多路复用 (Multiplexing)" translate="no">​</a></h3>
<ul>
<li class=""><strong>背景</strong>：以前浏览器限制同域名并发请求（约6个），所以必须要把文件合并（Bundle）。</li>
<li class=""><strong>现状</strong>：HTTP/2 允许在一个 TCP 连接上并发处理无数个请求。这意味着加载 100 个 1KB 的文件和加载 1 个 100KB 的文件，性能差距被极大缩小了。</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_aDle" id="2-vite--snowpack-模式">2. Vite / Snowpack 模式<a href="#2-vite--snowpack-模式" class="hash-link" aria-label="Direct link to 2. Vite / Snowpack 模式" title="Direct link to 2. Vite / Snowpack 模式" translate="no">​</a></h3>
<ul>
<li class=""><strong>开发环境</strong>：<strong>不打包</strong>。当浏览器请求 <code>main.js</code> 时，Vite 服务器拦截请求，实时通过 ESBuild 简单编译一下（转 TS 为 JS），直接以 ESM 格式返回给浏览器。<!-- -->
<ul>
<li class=""><em>优势</em>：启动速度极快，无论项目多大。</li>
</ul>
</li>
<li class=""><strong>生产环境</strong>：<strong>依然打包</strong>（通常用 Rollup）。<!-- -->
<ul>
<li class=""><em>原因</em>：虽然有 HTTP/2，但深层次的嵌套依赖导致的网络瀑布流（Network Waterfall）依然影响性能，且 Tree Shaking 依然需要通过打包来实现。</li>
</ul>
</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_aDle" id="六-总结图谱">六、 总结图谱<a href="#六-总结图谱" class="hash-link" aria-label="Direct link to 六、 总结图谱" title="Direct link to 六、 总结图谱" translate="no">​</a></h2>
<p>如果要用一句话概括这个领域的知识体系：</p>
<blockquote>
<p>我们用 <strong>ESM</strong> 编写模块化代码，通过 <strong>Bundler (Webpack/Vite)</strong> 结合 <strong>Transpiler (Babel)</strong> 将其加工成兼顾兼容性与性能的 <strong>Assets</strong>，最终利用 <strong>defer/async</strong> 或 <strong>Dynamic Import</strong> 策略按需投放到浏览器中。</p>
</blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_iDCr"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/FrontEnd/js代码的打包与加载机制.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_c0mv" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mxtt"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/notes3/docs/FrontEnd/Unocss/配置说明"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">配置说明</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/notes3/docs/FrontEnd/monorepo-structure"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Monorepo 结构分析</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_r83r thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一-核心矛盾为什么在这个环节有这么多概念" class="table-of-contents__link toc-highlight">一、 核心矛盾：为什么在这个环节有这么多概念？</a></li><li><a href="#二-模块化规范代码的组织形式" class="table-of-contents__link toc-highlight">二、 模块化规范：代码的“组织形式”</a><ul><li><a href="#1-史前时代global--iife" class="table-of-contents__link toc-highlight">1. 史前时代：Global &amp; IIFE</a></li><li><a href="#2-服务器端的崛起commonjs-cjs" class="table-of-contents__link toc-highlight">2. 服务器端的崛起：CommonJS (CJS)</a></li><li><a href="#3-浏览器的妥协amd--umd" class="table-of-contents__link toc-highlight">3. 浏览器的妥协：AMD &amp; UMD</a></li><li><a href="#4-终极标准es-modules-esm" class="table-of-contents__link toc-highlight">4. 终极标准：ES Modules (ESM)</a></li></ul></li><li><a href="#三-构建流水线代码的加工工厂" class="table-of-contents__link toc-highlight">三、 构建流水线：代码的“加工工厂”</a><ul><li><a href="#1-依赖图谱解析-dependency-graph" class="table-of-contents__link toc-highlight">1. 依赖图谱解析 (Dependency Graph)</a></li><li><a href="#2-转译-transpilation" class="table-of-contents__link toc-highlight">2. 转译 (Transpilation)</a></li><li><a href="#3-打包-bundling" class="table-of-contents__link toc-highlight">3. 打包 (Bundling)</a></li><li><a href="#4-摇树优化-tree-shaking" class="table-of-contents__link toc-highlight">4. 摇树优化 (Tree Shaking)</a></li><li><a href="#5-压缩与混淆-minification--uglification" class="table-of-contents__link toc-highlight">5. 压缩与混淆 (Minification &amp; Uglification)</a></li></ul></li><li><a href="#四-浏览器加载代码的物流配送" class="table-of-contents__link toc-highlight">四、 浏览器加载：代码的“物流配送”</a><ul><li><a href="#1-传统的-script-src" class="table-of-contents__link toc-highlight">1. 传统的 <code>&lt;script src=&quot;...&quot;&gt;</code></a></li><li><a href="#2-defer-最佳实践" class="table-of-contents__link toc-highlight">2. <code>defer</code> (最佳实践)</a></li><li><a href="#3-async-无序加载" class="table-of-contents__link toc-highlight">3. <code>async</code> (无序加载)</a></li><li><a href="#4-动态导入-dynamic-import--代码分割-code-splitting" class="table-of-contents__link toc-highlight">4. 动态导入 (Dynamic Import) / 代码分割 (Code Splitting)</a></li></ul></li><li><a href="#五-现代趋势bundless-无打包开发" class="table-of-contents__link toc-highlight">五、 现代趋势：Bundless (无打包开发)</a><ul><li><a href="#1-http2-多路复用-multiplexing" class="table-of-contents__link toc-highlight">1. HTTP/2 多路复用 (Multiplexing)</a></li><li><a href="#2-vite--snowpack-模式" class="table-of-contents__link toc-highlight">2. Vite / Snowpack 模式</a></li></ul></li><li><a href="#六-总结图谱" class="table-of-contents__link toc-highlight">六、 总结图谱</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_rhIP"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_rhIP"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_rhIP"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/notes3/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_rhIP"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>