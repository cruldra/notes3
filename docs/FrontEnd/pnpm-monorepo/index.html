<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-FrontEnd/pnpm-monorepo" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">pnpm-monorepo | Cruldra</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/notes3/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/notes3/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/notes3/docs/FrontEnd/pnpm-monorepo"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="pnpm-monorepo | Cruldra"><meta data-rh="true" name="description" content="PNPM Monorepo 实践指南"><meta data-rh="true" property="og:description" content="PNPM Monorepo 实践指南"><link data-rh="true" rel="icon" href="/notes3/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/notes3/docs/FrontEnd/pnpm-monorepo"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/notes3/docs/FrontEnd/pnpm-monorepo" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/notes3/docs/FrontEnd/pnpm-monorepo" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"pnpm-monorepo","item":"https://your-docusaurus-site.example.com/notes3/docs/FrontEnd/pnpm-monorepo"}]}</script><link rel="alternate" type="application/rss+xml" href="/notes3/blog/rss.xml" title="Cruldra RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/notes3/blog/atom.xml" title="Cruldra Atom Feed"><link rel="stylesheet" href="/notes3/assets/css/styles.f3dc2d00.css">
<script src="/notes3/assets/js/runtime~main.c8420ac9.js" defer="defer"></script>
<script src="/notes3/assets/js/main.0e29afbe.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme",window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),document.documentElement.setAttribute("data-theme-choice","system"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/notes3/img/logo.svg"><style data-mantine-styles="classes">@media (max-width: 35.99375em) {.mantine-visible-from-xs {display: none !important;}}@media (min-width: 36em) {.mantine-hidden-from-xs {display: none !important;}}@media (max-width: 47.99375em) {.mantine-visible-from-sm {display: none !important;}}@media (min-width: 48em) {.mantine-hidden-from-sm {display: none !important;}}@media (max-width: 61.99375em) {.mantine-visible-from-md {display: none !important;}}@media (min-width: 62em) {.mantine-hidden-from-md {display: none !important;}}@media (max-width: 74.99375em) {.mantine-visible-from-lg {display: none !important;}}@media (min-width: 75em) {.mantine-hidden-from-lg {display: none !important;}}@media (max-width: 87.99375em) {.mantine-visible-from-xl {display: none !important;}}@media (min-width: 88em) {.mantine-hidden-from-xl {display: none !important;}}</style><div role="region" aria-label="Skip to main content"><a class="skipToContent_kJiJ" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/notes3/"><div class="navbar__logo"><img src="/notes3/img/logo.svg" alt="My Site Logo" class="themedComponent_NrnZ themedComponent--light_kIco"><img src="/notes3/img/logo.svg" alt="My Site Logo" class="themedComponent_NrnZ themedComponent--dark_HCTy"></div><b class="navbar__title text--truncate">Cruldra</b></a><a class="navbar__item navbar__link" href="/notes3/docs/category/设计模式">JVM</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/notes3/docs/category/css">前端</a><a class="navbar__item navbar__link" href="/notes3/docs/category/astrbot">工具</a><a class="navbar__item navbar__link" href="/notes3/docs/category/ai电竞酒店">个人</a><a class="navbar__item navbar__link" href="/notes3/docs/AI/Agno/介绍">AI</a><a class="navbar__item navbar__link" href="/notes3/docs/category/内置模块">Python</a><a class="navbar__item navbar__link" href="/notes3/docs/category/actix-web">Rust</a><a class="navbar__item navbar__link" href="/notes3/docs/category/数据库系统">软件工程</a><a class="navbar__item navbar__link" href="/notes3/docs/category/上古卷轴5">游戏</a><a class="navbar__item navbar__link" href="/notes3/docs/Go/Go-Python-Java三语言全方位对比">Go</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_V3q0"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_YMCn"><div class="docsWrapper_UDzO"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_OA9t" type="button"></button><div class="docRoot_zblS"><aside class="theme-doc-sidebar-container docSidebarContainer_utvl"><div class="sidebarViewport_uicj"><div class="sidebar_wSJP"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_xz03"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_OIbK menu__link menu__link--sublist" href="/notes3/docs/category/css"><span title="Css" class="categoryLinkLabel_5XjO">Css</span></a><button aria-label="Expand sidebar category &#x27;Css&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_OIbK menu__link menu__link--sublist" href="/notes3/docs/category/常用库-1"><span title="常用库" class="categoryLinkLabel_5XjO">常用库</span></a><button aria-label="Expand sidebar category &#x27;常用库&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_OIbK menu__link menu__link--sublist" href="/notes3/docs/category/小程序"><span title="小程序" class="categoryLinkLabel_5XjO">小程序</span></a><button aria-label="Expand sidebar category &#x27;小程序&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_OIbK menu__link menu__link--sublist" href="/notes3/docs/category/react"><span title="React" class="categoryLinkLabel_5XjO">React</span></a><button aria-label="Expand sidebar category &#x27;React&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_OIbK menu__link menu__link--sublist" href="/notes3/docs/category/tauri"><span title="Tauri" class="categoryLinkLabel_5XjO">Tauri</span></a><button aria-label="Expand sidebar category &#x27;Tauri&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_OIbK menu__link menu__link--sublist" href="/notes3/docs/category/vite"><span title="Vite" class="categoryLinkLabel_5XjO">Vite</span></a><button aria-label="Expand sidebar category &#x27;Vite&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_OIbK menu__link menu__link--sublist" href="/notes3/docs/category/zustand"><span title="Zustand" class="categoryLinkLabel_5XjO">Zustand</span></a><button aria-label="Expand sidebar category &#x27;Zustand&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_OIbK menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/FrontEnd/Mantine/Mantine8更新内容"><span title="Mantine" class="categoryLinkLabel_5XjO">Mantine</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/FrontEnd/ServiceWorker"><span title="ServiceWorker" class="linkLabel_VeW_">ServiceWorker</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_OIbK menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/FrontEnd/TypeScript/remeda"><span title="TypeScript" class="categoryLinkLabel_5XjO">TypeScript</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_OIbK menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/FrontEnd/Unocss/配置说明"><span title="Unocss" class="categoryLinkLabel_5XjO">Unocss</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/FrontEnd/monorepo-structure"><span title="Monorepo 结构分析" class="linkLabel_VeW_">Monorepo 结构分析</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/notes3/docs/FrontEnd/pnpm-monorepo"><span title="pnpm-monorepo" class="linkLabel_VeW_">pnpm-monorepo</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_e2u6"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_y0g3"><div class="docItemContainer_PZbB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_I1XV" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/notes3/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_ZIEp"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">pnpm-monorepo</span></li></ul></nav><div class="tocCollapsible_UUJj theme-doc-toc-mobile tocMobile_b9MH"><button type="button" class="clean-btn tocCollapsibleButton_zQap">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>pnpm-monorepo</h1></header><h2 class="anchor anchorTargetStickyNavbar_FzkC" id="pnpm-monorepo-实践指南">PNPM Monorepo 实践指南<a href="#pnpm-monorepo-实践指南" class="hash-link" aria-label="Direct link to PNPM Monorepo 实践指南" title="Direct link to PNPM Monorepo 实践指南" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_FzkC" id="什么是-monorepo">什么是 Monorepo<a href="#什么是-monorepo" class="hash-link" aria-label="Direct link to 什么是 Monorepo" title="Direct link to 什么是 Monorepo" translate="no">​</a></h3>
<p>Monorepo（单一代码仓库）是一种项目架构策略，它将多个相关的项目或包放在同一个代码仓库中进行管理。与之相对的是 Multi-repo（多仓库）策略，即每个项目或包都有自己独立的代码仓库。</p>
<h4 class="anchor anchorTargetStickyNavbar_FzkC" id="monorepo-的优点">Monorepo 的优点<a href="#monorepo-的优点" class="hash-link" aria-label="Direct link to Monorepo 的优点" title="Direct link to Monorepo 的优点" translate="no">​</a></h4>
<ol>
<li class=""><strong>代码共享和复用</strong>：在单一代码库中，不同项目和模块可以轻松地共享和复用代码，降低了重复开发的成本</li>
<li class=""><strong>依赖管理</strong>：更容易管理项目间的依赖关系，减少版本冲突和升级问题</li>
<li class=""><strong>原子提交</strong>：允许在一个提交中更新多个项目或模块，保持代码的一致性</li>
<li class=""><strong>简化工作流程</strong>：简化构建、测试和部署等工作流程，提高开发效率</li>
</ol>
<h4 class="anchor anchorTargetStickyNavbar_FzkC" id="monorepo-的缺点">Monorepo 的缺点<a href="#monorepo-的缺点" class="hash-link" aria-label="Direct link to Monorepo 的缺点" title="Direct link to Monorepo 的缺点" translate="no">​</a></h4>
<ol>
<li class=""><strong>代码库规模</strong>：随着项目和代码的增长，Monorepo 的规模可能变得庞大，影响性能和存储需求</li>
<li class=""><strong>权限管理</strong>：在大型代码库中管理访问权限可能变得复杂，特别是在多团队协作的情况下</li>
<li class=""><strong>潜在的耦合</strong>：可能导致不同项目之间的耦合过于紧密，影响项目的独立性和灵活性</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_FzkC" id="为什么选择-pnpm">为什么选择 pnpm<a href="#为什么选择-pnpm" class="hash-link" aria-label="Direct link to 为什么选择 pnpm" title="Direct link to 为什么选择 pnpm" translate="no">​</a></h3>
<p>pnpm 是一个快速、节省磁盘空间的包管理器，特别适合管理 Monorepo 项目：</p>
<ol>
<li class=""><strong>磁盘空间和安装速度的优化</strong>：通过使用硬链接和符号链接，pnpm 能够显著减少项目的磁盘空间占用和安装时间</li>
<li class=""><strong>更严格的依赖关系管理</strong>：pnpm 更严格地遵循包的依赖关系，确保应用程序只访问在其 package.json 中声明的依赖项</li>
<li class=""><strong>原生 Monorepo 支持</strong>：通过 pnpm workspaces 功能，pnpm 支持原生 Monorepo，使跨项目的包管理变得更加简单</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_FzkC" id="配置-pnpm-workspace">配置 pnpm workspace<a href="#配置-pnpm-workspace" class="hash-link" aria-label="Direct link to 配置 pnpm workspace" title="Direct link to 配置 pnpm workspace" translate="no">​</a></h3>
<p>要在 Monorepo 中使用 pnpm，需要在项目根目录下创建一个名为 <code>pnpm-workspace.yaml</code> 的文件，并在其中定义工作区：</p>
<div class="language-yaml codeBlockContainer_iV14 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jh8H"><pre tabindex="0" class="prism-code language-yaml codeBlock_E9uv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Kv4h"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">packages</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 包含 packages 目录下的所有直接子目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;packages/*&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 包含 components 目录下的所有子目录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;components/**&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 排除 test 目录下的所有包</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;!**/test/**&#x27;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_FzkC" id="防止使用其他包管理器">防止使用其他包管理器<a href="#防止使用其他包管理器" class="hash-link" aria-label="Direct link to 防止使用其他包管理器" title="Direct link to 防止使用其他包管理器" translate="no">​</a></h3>
<p>为了防止团队成员意外使用其他包管理器（如 npm 或 yarn），可以在项目根目录的 <code>package.json</code> 中添加以下脚本：</p>
<div class="language-json codeBlockContainer_iV14 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jh8H"><pre tabindex="0" class="prism-code language-json codeBlock_E9uv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Kv4h"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;scripts&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;preinstall&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;npx -y only-allow pnpm&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>这样，当有人尝试运行 <code>npm install</code> 或 <code>yarn install</code> 时，会触发错误提示，只允许使用 pnpm。</p>
<h3 class="anchor anchorTargetStickyNavbar_FzkC" id="依赖管理的最佳实践">依赖管理的最佳实践<a href="#依赖管理的最佳实践" class="hash-link" aria-label="Direct link to 依赖管理的最佳实践" title="Direct link to 依赖管理的最佳实践" translate="no">​</a></h3>
<p>在 Monorepo 中管理依赖是一个复杂的任务，以下是一些最佳实践：</p>
<h4 class="anchor anchorTargetStickyNavbar_FzkC" id="1-在需要的包中安装依赖">1. 在需要的包中安装依赖<a href="#1-在需要的包中安装依赖" class="hash-link" aria-label="Direct link to 1. 在需要的包中安装依赖" title="Direct link to 1. 在需要的包中安装依赖" translate="no">​</a></h4>
<p>对于大部分 Monorepo 项目，建议直接在需要依赖项的包中的 <code>package.json</code> 中显式声明依赖，无论是外部依赖还是内部包之间的依赖。</p>
<p>在多个包中安装相同依赖的命令：</p>
<div class="language-bash codeBlockContainer_iV14 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jh8H"><pre tabindex="0" class="prism-code language-bash codeBlock_E9uv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Kv4h"><span class="token-line" style="color:#393A34"><span class="token plain"># 在 web 和 mobile 包中安装 jest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pnpm install jest --save-dev --filter=web --filter=mobile</span><br></span></code></pre></div></div>
<p>优势：</p>
<ul>
<li class=""><strong>可维护性</strong>：每个包的 <code>package.json</code> 都会声明其需要的依赖，开发者可以更容易地理解和处理依赖</li>
<li class=""><strong>灵活性</strong>：在大型、复杂的 Monorepo 中，不同的包可能需要不同版本的依赖</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_FzkC" id="2-简洁的根目录依赖">2. 简洁的根目录依赖<a href="#2-简洁的根目录依赖" class="hash-link" aria-label="Direct link to 2. 简洁的根目录依赖" title="Direct link to 2. 简洁的根目录依赖" translate="no">​</a></h4>
<p>根目录的 <code>package.json</code> 中应该只包含管理项目所需的工具依赖，如：</p>
<ul>
<li class="">Turborepo</li>
<li class="">Husky</li>
<li class="">lint-staged</li>
<li class="">Changesets</li>
</ul>
<p>而构建和库的依赖应该安装在各自的包中。</p>
<h4 class="anchor anchorTargetStickyNavbar_FzkC" id="3-包之间的相互依赖">3. 包之间的相互依赖<a href="#3-包之间的相互依赖" class="hash-link" aria-label="Direct link to 3. 包之间的相互依赖" title="Direct link to 3. 包之间的相互依赖" translate="no">​</a></h4>
<p>使用 pnpm 的 <code>workspace:</code> 协议可以方便地在包之间建立依赖关系：</p>
<div class="language-bash codeBlockContainer_iV14 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jh8H"><pre tabindex="0" class="prism-code language-bash codeBlock_E9uv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Kv4h"><span class="token-line" style="color:#393A34"><span class="token plain"># 在 monorepo-pkg-b 中添加对 monorepo-pkg-a 的依赖</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pnpm add @sway/monorepo-pkg-a --filter @sway/monorepo-pkg-b</span><br></span></code></pre></div></div>
<p>这会在 <code>monorepo-pkg-b</code> 的 <code>package.json</code> 中添加：</p>
<div class="language-json codeBlockContainer_iV14 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jh8H"><pre tabindex="0" class="prism-code language-json codeBlock_E9uv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Kv4h"><span class="token-line" style="color:#393A34"><span class="token property" style="color:#36acaa">&quot;dependencies&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;@sway/monorepo-pkg-a&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;workspace:^&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>推荐使用 <code>workspace:*</code> 来保持依赖的版本是工作空间里的最新版本。当执行 <code>pnpm publish</code> 时，会自动将 <code>workspace:</code> 修正为对应的版本号。</p>
<h3 class="anchor anchorTargetStickyNavbar_FzkC" id="工作空间协议-workspace">工作空间协议 (workspace:)<a href="#工作空间协议-workspace" class="hash-link" aria-label="Direct link to 工作空间协议 (workspace:)" title="Direct link to 工作空间协议 (workspace:)" translate="no">​</a></h3>
<p>pnpm 支持 <code>workspace:</code> 协议，用于引用工作空间中的包：</p>
<ol>
<li class=""><strong>精确版本</strong>：<code>&quot;foo&quot;: &quot;workspace:*&quot;</code></li>
<li class=""><strong>通过别名引用</strong>：<code>&quot;bar&quot;: &quot;workspace:foo@*&quot;</code></li>
<li class=""><strong>通过相对路径引用</strong>：<code>&quot;foo&quot;: &quot;workspace:../foo&quot;</code></li>
</ol>
<p>在发布时，这些引用会被转换为常规的版本规范：</p>
<ul>
<li class=""><code>workspace:*</code> → <code>1.5.0</code></li>
<li class=""><code>workspace:~</code> → <code>~1.5.0</code></li>
<li class=""><code>workspace:^</code> → <code>^1.5.0</code></li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_FzkC" id="使用-changesets-管理版本和发布">使用 Changesets 管理版本和发布<a href="#使用-changesets-管理版本和发布" class="hash-link" aria-label="Direct link to 使用 Changesets 管理版本和发布" title="Direct link to 使用 Changesets 管理版本和发布" translate="no">​</a></h3>
<p>Changesets 是 pnpm 官方推荐的版本管理工具，用于管理 Monorepo 中的包版本和发布。</p>
<h4 class="anchor anchorTargetStickyNavbar_FzkC" id="安装和初始化">安装和初始化<a href="#安装和初始化" class="hash-link" aria-label="Direct link to 安装和初始化" title="Direct link to 安装和初始化" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_iV14 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jh8H"><pre tabindex="0" class="prism-code language-bash codeBlock_E9uv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Kv4h"><span class="token-line" style="color:#393A34"><span class="token plain"># 安装 changesets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pnpm i -Dw @changesets/cli</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 初始化</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pnpm changeset init</span><br></span></code></pre></div></div>
<p>初始化后，项目根目录会创建一个 <code>.changeset</code> 目录，其中包含配置文件。</p>
<h4 class="anchor anchorTargetStickyNavbar_FzkC" id="生成-changeset-文件">生成 changeset 文件<a href="#生成-changeset-文件" class="hash-link" aria-label="Direct link to 生成 changeset 文件" title="Direct link to 生成 changeset 文件" translate="no">​</a></h4>
<p>当你修改了某个包的代码并准备发布新版本时：</p>
<div class="language-bash codeBlockContainer_iV14 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jh8H"><pre tabindex="0" class="prism-code language-bash codeBlock_E9uv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Kv4h"><span class="token-line" style="color:#393A34"><span class="token plain">pnpm changeset</span><br></span></code></pre></div></div>
<p>这个命令会引导你选择要发布的包以及版本类型（patch、minor、major），并添加变更说明。</p>
<h4 class="anchor anchorTargetStickyNavbar_FzkC" id="发布测试版本">发布测试版本<a href="#发布测试版本" class="hash-link" aria-label="Direct link to 发布测试版本" title="Direct link to 发布测试版本" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_iV14 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jh8H"><pre tabindex="0" class="prism-code language-bash codeBlock_E9uv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Kv4h"><span class="token-line" style="color:#393A34"><span class="token plain"># 进入预发布模式（如 beta）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pnpm changeset pre enter beta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 更新版本号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pnpm changeset version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 构建并发布</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pnpm run build &amp;&amp; pnpm changeset publish</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 退出预发布模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pnpm changeset pre exit</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_FzkC" id="发布正式版本">发布正式版本<a href="#发布正式版本" class="hash-link" aria-label="Direct link to 发布正式版本" title="Direct link to 发布正式版本" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_iV14 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jh8H"><pre tabindex="0" class="prism-code language-bash codeBlock_E9uv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Kv4h"><span class="token-line" style="color:#393A34"><span class="token plain"># 更新版本号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pnpm changeset version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 构建并发布</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pnpm run build &amp;&amp; pnpm changeset publish</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_FzkC" id="catalogs-协议pnpm-950">Catalogs 协议（pnpm 9.5.0+）<a href="#catalogs-协议pnpm-950" class="hash-link" aria-label="Direct link to Catalogs 协议（pnpm 9.5.0+）" title="Direct link to Catalogs 协议（pnpm 9.5.0+）" translate="no">​</a></h3>
<p>Catalogs 是 pnpm 的新特性，用于在工作空间中统一管理依赖版本。</p>
<h4 class="anchor anchorTargetStickyNavbar_FzkC" id="配置-catalogs">配置 Catalogs<a href="#配置-catalogs" class="hash-link" aria-label="Direct link to 配置 Catalogs" title="Direct link to 配置 Catalogs" translate="no">​</a></h4>
<p>在 <code>pnpm-workspace.yaml</code> 中定义：</p>
<div class="language-yaml codeBlockContainer_iV14 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jh8H"><pre tabindex="0" class="prism-code language-yaml codeBlock_E9uv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Kv4h"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">packages</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;packages/**&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 定义默认 Catalog</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">catalog</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">react</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ^18.3.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">react-dom</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ^18.3.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># 定义具名 Catalogs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">catalogs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 可通过 &quot;catalog:react17&quot; 引用</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">react17</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">react</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ^17.0.2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">react-dom</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> ^17.0.2</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_FzkC" id="在-packagejson-中使用">在 package.json 中使用<a href="#在-packagejson-中使用" class="hash-link" aria-label="Direct link to 在 package.json 中使用" title="Direct link to 在 package.json 中使用" translate="no">​</a></h4>
<div class="language-json codeBlockContainer_iV14 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jh8H"><pre tabindex="0" class="prism-code language-json codeBlock_E9uv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Kv4h"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;dependencies&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 使用默认配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;react&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;catalog:&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 使用具名配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;react-dom&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;catalog:react17&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>发布后会转换为：</p>
<div class="language-json codeBlockContainer_iV14 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jh8H"><pre tabindex="0" class="prism-code language-json codeBlock_E9uv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Kv4h"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;dependencies&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;react&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;^18.3.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">&quot;react-dom&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;^17.0.2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_FzkC" id="使用-codemod-快速重构">使用 codemod 快速重构<a href="#使用-codemod-快速重构" class="hash-link" aria-label="Direct link to 使用 codemod 快速重构" title="Direct link to 使用 codemod 快速重构" translate="no">​</a></h4>
<div class="language-bash codeBlockContainer_iV14 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jh8H"><pre tabindex="0" class="prism-code language-bash codeBlock_E9uv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Kv4h"><span class="token-line" style="color:#393A34"><span class="token plain">pnpx codemod pnpm/catalog</span><br></span></code></pre></div></div>
<p>这个命令会自动将项目中的依赖版本转换为 Catalog 协议。</p>
<h3 class="anchor anchorTargetStickyNavbar_FzkC" id="常见命令和参数">常见命令和参数<a href="#常见命令和参数" class="hash-link" aria-label="Direct link to 常见命令和参数" title="Direct link to 常见命令和参数" translate="no">​</a></h3>
<ol>
<li class="">
<p><strong>-w, --workspace-root</strong>：在工作空间根目录安装依赖</p>
<div class="language-bash codeBlockContainer_iV14 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jh8H"><pre tabindex="0" class="prism-code language-bash codeBlock_E9uv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Kv4h"><span class="token-line" style="color:#393A34"><span class="token plain">pnpm add -w eslint</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>--filter</strong>：限制命令只在特定包中执行</p>
<div class="language-bash codeBlockContainer_iV14 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jh8H"><pre tabindex="0" class="prism-code language-bash codeBlock_E9uv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Kv4h"><span class="token-line" style="color:#393A34"><span class="token plain">pnpm build --filter @sway/monorepo-pkg-a</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>-r, --recursive</strong>：在所有包中执行命令（不包括根目录）</p>
<div class="language-bash codeBlockContainer_iV14 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jh8H"><pre tabindex="0" class="prism-code language-bash codeBlock_E9uv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Kv4h"><span class="token-line" style="color:#393A34"><span class="token plain">pnpm -r run build</span><br></span></code></pre></div></div>
</li>
<li class="">
<p><strong>--parallel</strong>：忽略依赖顺序，并行执行命令</p>
<div class="language-bash codeBlockContainer_iV14 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_jh8H"><pre tabindex="0" class="prism-code language-bash codeBlock_E9uv thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_Kv4h"><span class="token-line" style="color:#393A34"><span class="token plain">pnpm --parallel -r run watch</span><br></span></code></pre></div></div>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_FzkC" id="知名项目示例">知名项目示例<a href="#知名项目示例" class="hash-link" aria-label="Direct link to 知名项目示例" title="Direct link to 知名项目示例" translate="no">​</a></h3>
<p>以下是一些使用 pnpm 工作空间的知名开源项目：</p>
<ul>
<li class="">Next.js</li>
<li class="">Material UI</li>
<li class="">Vite</li>
<li class="">Nuxt</li>
<li class="">Vue</li>
<li class="">Astro</li>
<li class="">Prisma</li>
<li class="">Turborepo</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_FzkC" id="参考资料">参考资料<a href="#参考资料" class="hash-link" aria-label="Direct link to 参考资料" title="Direct link to 参考资料" translate="no">​</a></h3>
<ul>
<li class=""><a href="https://pnpm.io/zh/workspaces" target="_blank" rel="noopener noreferrer" class="">pnpm 官方文档 - 工作空间</a></li>
<li class=""><a href="https://pnpm.io/zh/catalogs" target="_blank" rel="noopener noreferrer" class="">pnpm 官方文档 - Catalogs</a></li>
<li class=""><a href="https://pnpm.io/zh/using-changesets" target="_blank" rel="noopener noreferrer" class="">pnpm 官方文档 - 使用 Changesets</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_RM2i"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/FrontEnd/pnpm-monorepo.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_NBA7" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_Ng_4"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/notes3/docs/FrontEnd/monorepo-structure"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Monorepo 结构分析</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_qSfz thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#pnpm-monorepo-实践指南" class="table-of-contents__link toc-highlight">PNPM Monorepo 实践指南</a><ul><li><a href="#什么是-monorepo" class="table-of-contents__link toc-highlight">什么是 Monorepo</a></li><li><a href="#为什么选择-pnpm" class="table-of-contents__link toc-highlight">为什么选择 pnpm</a></li><li><a href="#配置-pnpm-workspace" class="table-of-contents__link toc-highlight">配置 pnpm workspace</a></li><li><a href="#防止使用其他包管理器" class="table-of-contents__link toc-highlight">防止使用其他包管理器</a></li><li><a href="#依赖管理的最佳实践" class="table-of-contents__link toc-highlight">依赖管理的最佳实践</a></li><li><a href="#工作空间协议-workspace" class="table-of-contents__link toc-highlight">工作空间协议 (workspace:)</a></li><li><a href="#使用-changesets-管理版本和发布" class="table-of-contents__link toc-highlight">使用 Changesets 管理版本和发布</a></li><li><a href="#catalogs-协议pnpm-950" class="table-of-contents__link toc-highlight">Catalogs 协议（pnpm 9.5.0+）</a></li><li><a href="#常见命令和参数" class="table-of-contents__link toc-highlight">常见命令和参数</a></li><li><a href="#知名项目示例" class="table-of-contents__link toc-highlight">知名项目示例</a></li><li><a href="#参考资料" class="table-of-contents__link toc-highlight">参考资料</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_EO6u"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_EO6u"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_EO6u"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/notes3/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_EO6u"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>