<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Tools/rpa/Rust_Robot_Framework_FlaUILibrary桌面自动化指南" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">使用Rust + Robot Framework + FlaUILibrary实现Windows桌面自动化 | Cruldra</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/notes3/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/notes3/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/notes3/docs/Tools/rpa/Rust_Robot_Framework_FlaUILibrary桌面自动化指南"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="使用Rust + Robot Framework + FlaUILibrary实现Windows桌面自动化 | Cruldra"><meta data-rh="true" name="description" content="在自动化测试和RPA（机器人流程自动化）领域，将高性能的系统编程语言与专业的自动化框架结合使用，可以创建出既高效又强大的自动化解决方案。本文将详细介绍如何使用Rust语言调用Robot Framework和FlaUILibrary来实现Windows桌面应用的自动化，为需要高性能桌面自动化的场景提供解决方案。"><meta data-rh="true" property="og:description" content="在自动化测试和RPA（机器人流程自动化）领域，将高性能的系统编程语言与专业的自动化框架结合使用，可以创建出既高效又强大的自动化解决方案。本文将详细介绍如何使用Rust语言调用Robot Framework和FlaUILibrary来实现Windows桌面应用的自动化，为需要高性能桌面自动化的场景提供解决方案。"><link data-rh="true" rel="icon" href="/notes3/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/notes3/docs/Tools/rpa/Rust_Robot_Framework_FlaUILibrary桌面自动化指南"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/notes3/docs/Tools/rpa/Rust_Robot_Framework_FlaUILibrary桌面自动化指南" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/notes3/docs/Tools/rpa/Rust_Robot_Framework_FlaUILibrary桌面自动化指南" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/notes3/blog/rss.xml" title="Cruldra RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/notes3/blog/atom.xml" title="Cruldra Atom Feed"><link rel="stylesheet" href="/notes3/assets/css/styles.078970d1.css">
<script src="/notes3/assets/js/runtime~main.98b1a4f2.js" defer="defer"></script>
<script src="/notes3/assets/js/main.659fc544.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><style data-mantine-styles="classes">@media (max-width: 35.99375em) {.mantine-visible-from-xs {display: none !important;}}@media (min-width: 36em) {.mantine-hidden-from-xs {display: none !important;}}@media (max-width: 47.99375em) {.mantine-visible-from-sm {display: none !important;}}@media (min-width: 48em) {.mantine-hidden-from-sm {display: none !important;}}@media (max-width: 61.99375em) {.mantine-visible-from-md {display: none !important;}}@media (min-width: 62em) {.mantine-hidden-from-md {display: none !important;}}@media (max-width: 74.99375em) {.mantine-visible-from-lg {display: none !important;}}@media (min-width: 75em) {.mantine-hidden-from-lg {display: none !important;}}@media (max-width: 87.99375em) {.mantine-visible-from-xl {display: none !important;}}@media (min-width: 88em) {.mantine-hidden-from-xl {display: none !important;}}</style><div role="region" aria-label="Skip to main content"><a class="skipToContent_V2Lh" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/notes3/"><div class="navbar__logo"><img src="/notes3/img/logo.svg" alt="My Site Logo" class="themedComponent_d9Jm themedComponent--light_SojO"><img src="/notes3/img/logo.svg" alt="My Site Logo" class="themedComponent_d9Jm themedComponent--dark__mYE"></div><b class="navbar__title text--truncate">Cruldra</b></a><a class="navbar__item navbar__link" href="/notes3/docs/category/设计模式">JVM</a><a class="navbar__item navbar__link" href="/notes3/docs/category/css">前端</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/notes3/docs/Tools/OpenAI">工具</a><a class="navbar__item navbar__link" href="/notes3/docs/category/器物搜索小程序">个人</a><a class="navbar__item navbar__link" href="/notes3/docs/AI/Agno/介绍">AI</a><a class="navbar__item navbar__link" href="/notes3/docs/category/内置模块">Python</a><a class="navbar__item navbar__link" href="/notes3/docs/category/数据库系统">软件工程</a><a class="navbar__item navbar__link" href="/notes3/docs/Games/Mod Organizer/">游戏</a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_RRBP"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_S9Wv"><div class="docsWrapper_Yjmt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_KC5t" type="button"></button><div class="docRoot_XxT6"><aside class="theme-doc-sidebar-container docSidebarContainer_vMt2"><div class="sidebarViewport_Sg3f"><div class="sidebar_iPg1"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_T72x"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Tools/OpenAI">OpenAI</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/内网穿透">内网穿透</a><button aria-label="Expand sidebar category &#x27;内网穿透&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/操作系统">操作系统</a><button aria-label="Expand sidebar category &#x27;操作系统&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/数据库">数据库</a><button aria-label="Expand sidebar category &#x27;数据库&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/版本控制">版本控制</a><button aria-label="Expand sidebar category &#x27;版本控制&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/编程">编程</a><button aria-label="Expand sidebar category &#x27;编程&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/虚拟化和容器">虚拟化和容器</a><button aria-label="Expand sidebar category &#x27;虚拟化和容器&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/证书">证书</a><button aria-label="Expand sidebar category &#x27;证书&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/集成开发环境">集成开发环境</a><button aria-label="Expand sidebar category &#x27;集成开发环境&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/音视频">音视频</a><button aria-label="Expand sidebar category &#x27;音视频&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/Tools/Github/高级搜索语法">Github</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Tools/Jenkins">Jenkins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Tools/Ollama">Ollama</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/notes3/docs/Tools/rpa/Python_Robot_Framework_FlaUILibrary自动化指南">rpa</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/Tools/rpa/Python_Robot_Framework_FlaUILibrary自动化指南">Python + Robot Framework + FlaUILibrary实现Windows桌面应用自动化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/Tools/rpa/Robot_Framework_Selenium_FlaUILibrary关系分析">Robot Framework、Selenium Library与FlaUILibrary关系分析</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/Tools/rpa/Robot_Framework桌面自动化指南">Robot Framework桌面自动化指南：元素查找、点击与截图</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/Tools/rpa/Robot_Framework语法和文件结构指南">Robot Framework语法和文件结构指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/notes3/docs/Tools/rpa/Rust_Robot_Framework_FlaUILibrary桌面自动化指南">使用Rust + Robot Framework + FlaUILibrary实现Windows桌面自动化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/Tools/rpa/开源RPA工具对比">开源RPA工具对比：功能特性与适用场景分析</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_MQMi"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_hIST"><div class="docItemContainer_FXsG"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Thwa" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/notes3/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_Mcl1"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">rpa</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">使用Rust + Robot Framework + FlaUILibrary实现Windows桌  面自动化</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_FK1K theme-doc-toc-mobile tocMobile_YuaO"><button type="button" class="clean-btn tocCollapsibleButton_NtDB">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>使用Rust + Robot Framework + FlaUILibrary实现Windows桌面自动化</h1></header>
<p>在自动化测试和RPA（机器人流程自动化）领域，将高性能的系统编程语言与专业的自动化框架结合使用，可以创建出既高效又强大的自动化解决方案。本文将详细介绍如何使用Rust语言调用Robot Framework和FlaUILibrary来实现Windows桌面应用的自动化，为需要高性能桌面自动化的场景提供解决方案。</p>
<h2 class="anchor anchorWithStickyNavbar_uFgA" id="1-基本概念">1. 基本概念<a href="#1-基本概念" class="hash-link" aria-label="Direct link to 1. 基本概念" title="Direct link to 1. 基本概念">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_uFgA" id="11-rust语言">1.1 Rust语言<a href="#11-rust语言" class="hash-link" aria-label="Direct link to 1.1 Rust语言" title="Direct link to 1.1 Rust语言">​</a></h3>
<p>Rust是一种系统编程语言，专注于安全性、并发性和性能。它的主要特点包括：</p>
<ul>
<li>零成本抽象</li>
<li>内存安全（无需垃圾回收）</li>
<li>并发安全</li>
<li>高性能</li>
<li>跨平台支持</li>
</ul>
<p>这些特性使Rust成为构建高性能自动化工具的理想选择，特别是在需要与操作系统和底层硬件交互的场景中。</p>
<h3 class="anchor anchorWithStickyNavbar_uFgA" id="12-robot-framework">1.2 Robot Framework<a href="#12-robot-framework" class="hash-link" aria-label="Direct link to 1.2 Robot Framework" title="Direct link to 1.2 Robot Framework">​</a></h3>
<p>Robot Framework是一个通用的开源自动化框架，适用于验收测试和RPA。它采用关键字驱动的方法，使非技术人员也能轻松创建和维护自动化脚本。</p>
<h3 class="anchor anchorWithStickyNavbar_uFgA" id="13-flauilibrary">1.3 FlaUILibrary<a href="#13-flauilibrary" class="hash-link" aria-label="Direct link to 1.3 FlaUILibrary" title="Direct link to 1.3 FlaUILibrary">​</a></h3>
<p>FlaUILibrary是一个基于FlaUI的Robot Framework库，专门用于Windows应用程序的UI自动化测试。它支持多种Windows应用类型，包括Win32、WinForms、WPF和Windows Store应用。</p>
<h2 class="anchor anchorWithStickyNavbar_uFgA" id="2-架构设计">2. 架构设计<a href="#2-架构设计" class="hash-link" aria-label="Direct link to 2. 架构设计" title="Direct link to 2. 架构设计">​</a></h2>
<p>在使用Rust调用Robot Framework和FlaUILibrary实现桌面自动化时，我们采用以下架构设计：</p>
<div class="codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-text codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+      +------------------+      +----------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                |      |                  |      |                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|  Rust程序      +-----&gt;+  Robot Framework +-----&gt;+  FlaUILibrary  |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|                |      |                  |      |                |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+----------------+      +------------------+      +-------+--------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                         |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                         v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                  +------+-------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                  |              |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                  | Windows应用   |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                  |              |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                  +--------------+</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在这个架构中：</p>
<ol>
<li><strong>Rust程序</strong>：作为主控程序，负责业务逻辑和流程控制</li>
<li><strong>Robot Framework</strong>：作为自动化执行引擎，处理测试/任务执行</li>
<li><strong>FlaUILibrary</strong>：提供与Windows UI元素交互的能力</li>
<li><strong>Windows应用</strong>：被自动化的目标应用</li>
</ol>
<p>这种架构结合了Rust的高性能和内存安全特性，以及Robot Framework的易用性和FlaUILibrary的Windows UI自动化能力。</p>
<h2 class="anchor anchorWithStickyNavbar_uFgA" id="3-环境设置">3. 环境设置<a href="#3-环境设置" class="hash-link" aria-label="Direct link to 3. 环境设置" title="Direct link to 3. 环境设置">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_uFgA" id="31-安装rust">3.1 安装Rust<a href="#31-安装rust" class="hash-link" aria-label="Direct link to 3.1 安装Rust" title="Direct link to 3.1 安装Rust">​</a></h3>
<p>首先，需要安装Rust编程环境：</p>
<div class="language-bash codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-bash codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token plain"># 使用rustup安装Rust</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl --proto &#x27;=https&#x27; --tlsv1.2 -sSf https://sh.rustup.rs | sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Windows用户可以从https://rustup.rs下载安装程序</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>验证安装：</p>
<div class="language-bash codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-bash codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token plain">rustc --version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cargo --version</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_uFgA" id="32-安装python和robot-framework">3.2 安装Python和Robot Framework<a href="#32-安装python和robot-framework" class="hash-link" aria-label="Direct link to 3.2 安装Python和Robot Framework" title="Direct link to 3.2 安装Python和Robot Framework">​</a></h3>
<p>由于Robot Framework基于Python，我们需要安装Python和相关包：</p>
<div class="language-bash codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-bash codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token plain"># 安装Python (Windows)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 从https://www.python.org/downloads/windows/下载并安装</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 安装Robot Framework</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip install robotframework</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 安装FlaUILibrary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">pip install robotframework-flaui</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>验证安装：</p>
<div class="language-bash codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-bash codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token plain">robot --version</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_uFgA" id="33-设置项目结构">3.3 设置项目结构<a href="#33-设置项目结构" class="hash-link" aria-label="Direct link to 3.3 设置项目结构" title="Direct link to 3.3 设置项目结构">​</a></h3>
<p>创建一个新的Rust项目：</p>
<div class="language-bash codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-bash codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token plain">cargo new rust-robot-automation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cd rust-robot-automation</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>项目结构如下：</p>
<div class="codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-text codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token plain">rust-robot-automation/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── Cargo.toml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── src/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── main.rs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── robot_tests/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── keywords/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   │   └── desktop_keywords.robot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── tests/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│       └── calculator_test.robot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── resources/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── config.json</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_uFgA" id="4-rust与robot-framework集成">4. Rust与Robot Framework集成<a href="#4-rust与robot-framework集成" class="hash-link" aria-label="Direct link to 4. Rust与Robot Framework集成" title="Direct link to 4. Rust与Robot Framework集成">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_uFgA" id="41-在cargotoml中添加依赖">4.1 在Cargo.toml中添加依赖<a href="#41-在cargotoml中添加依赖" class="hash-link" aria-label="Direct link to 4.1 在Cargo.toml中添加依赖" title="Direct link to 4.1 在Cargo.toml中添加依赖">​</a></h3>
<div class="language-toml codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-toml codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token plain">[package]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name = &quot;rust-robot-automation&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version = &quot;0.1.0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">edition = &quot;2021&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[dependencies]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 用于执行命令行程序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">subprocess = &quot;0.2.9&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 用于处理JSON配置</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">serde = { version = &quot;1.0&quot;, features = [&quot;derive&quot;] }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">serde_json = &quot;1.0&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 用于日志记录</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log = &quot;0.4&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">env_logger = &quot;0.10&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 用于处理错误</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">anyhow = &quot;1.0&quot;</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_uFgA" id="42-创建robot-framework测试文件">4.2 创建Robot Framework测试文件<a href="#42-创建robot-framework测试文件" class="hash-link" aria-label="Direct link to 4.2 创建Robot Framework测试文件" title="Direct link to 4.2 创建Robot Framework测试文件">​</a></h3>
<p>在<code>robot_tests/tests/calculator_test.robot</code>中：</p>
<div class="language-robotframework codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-robotframework codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token plain">*** Settings ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Library    FlaUILibrary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Resource   ../keywords/desktop_keywords.robot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*** Test Cases ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Calculator Addition Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Launch Calculator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Perform Addition    5    3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Verify Result    8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Close Calculator</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在<code>robot_tests/keywords/desktop_keywords.robot</code>中：</p>
<div class="language-robotframework codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-robotframework codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token plain">*** Settings ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Library    FlaUILibrary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*** Keywords ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Launch Calculator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Launch Application    calc.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Wait Until Element Exists    //Window[@Name=&quot;计算器&quot; or @Name=&quot;Calculator&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Perform Addition</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Arguments]    ${num1}    ${num2}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;${num1}&quot; or @AutomationId=&quot;num${num1}Button&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;+&quot; or @AutomationId=&quot;plusButton&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;${num2}&quot; or @AutomationId=&quot;num${num2}Button&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;=&quot; or @AutomationId=&quot;equalButton&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Verify Result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Arguments]    ${expected}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ${result}=    Get Element Text    //Text[@AutomationId=&quot;CalculatorResults&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 根据系统语言验证结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ${is_chinese}=    Run Keyword And Return Status    Should Contain    ${result}    显示为</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Run Keyword If    ${is_chinese}    Should Be Equal    ${result}    显示为 ${expected}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...    ELSE    Should Be Equal    ${result}    Display is ${expected}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Close Calculator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Close Application</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_uFgA" id="43-在rust中实现robot-framework调用">4.3 在Rust中实现Robot Framework调用<a href="#43-在rust中实现robot-framework调用" class="hash-link" aria-label="Direct link to 4.3 在Rust中实现Robot Framework调用" title="Direct link to 4.3 在Rust中实现Robot Framework调用">​</a></h3>
<p>在<code>src/main.rs</code>中：</p>
<div class="language-rust codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-rust codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">anyhow</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token punctuation" style="color:#393A34">{</span><span class="token class-name">Context</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">log</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> info</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">serde</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token punctuation" style="color:#393A34">{</span><span class="token class-name">Deserialize</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Serialize</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">std</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token plain">fs</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">std</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token namespace" style="opacity:0.7">path</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token class-name">Path</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">subprocess</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token punctuation" style="color:#393A34">{</span><span class="token class-name">Exec</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Redirection</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token attribute attr-name" style="color:#00a4db">#[derive(Debug, Serialize, Deserialize)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token type-definition class-name">Config</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    robot_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    test_path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    output_dir</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 初始化日志</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token namespace" style="opacity:0.7">env_logger</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token function" style="color:#d73a49">init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 读取配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">read_config</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">?</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 执行Robot Framework测试</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token macro property" style="color:#36acaa">info!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;开始执行桌面自动化测试&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run_robot_test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">?</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 处理测试结果</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">success </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token macro property" style="color:#36acaa">info!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;测试成功完成&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token macro property" style="color:#36acaa">error!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;测试失败: {}&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">output</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Ok</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">read_config</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">Config</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> config_path </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Path</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">new</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;resources/config.json&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> config_str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">fs</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token function" style="color:#d73a49">read_to_string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config_path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">context</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;无法读取配置文件&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">?</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">Config</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">serde_json</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token function" style="color:#d73a49">from_str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">config_str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">context</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;无法解析配置文件&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">?</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Ok</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token type-definition class-name">TestResult</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    success</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">bool</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    output</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">run_robot_test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token class-name">Config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">TestResult</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 构建Robot Framework命令</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> cmd </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token macro property" style="color:#36acaa">format!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;{} --outputdir {} {}&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">robot_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">output_dir</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">test_path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token macro property" style="color:#36acaa">info!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;执行命令: {}&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cmd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 执行命令并捕获输出</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Exec</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">shell</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cmd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">stdout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Redirection</span><span class="token punctuation" style="color:#393A34">::</span><span class="token class-name">Pipe</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">stderr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Redirection</span><span class="token punctuation" style="color:#393A34">::</span><span class="token class-name">Merge</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">capture</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">context</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;执行Robot Framework测试失败&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">?</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> success </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> output</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exit_status</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">success</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> output_str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">from_utf8_lossy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">output</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stdout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">to_string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Ok</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">TestResult</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        success</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        output</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> output_str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_uFgA" id="44-创建配置文件">4.4 创建配置文件<a href="#44-创建配置文件" class="hash-link" aria-label="Direct link to 4.4 创建配置文件" title="Direct link to 4.4 创建配置文件">​</a></h3>
<p>在<code>resources/config.json</code>中：</p>
<div class="language-json codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-json codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;robot_path&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;robot&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;test_path&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;robot_tests/tests/calculator_test.robot&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">&quot;output_dir&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;results&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_uFgA" id="5-高级功能实现">5. 高级功能实现<a href="#5-高级功能 实现" class="hash-link" aria-label="Direct link to 5. 高级功能实现" title="Direct link to 5. 高级功能实现">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_uFgA" id="51-参数化测试">5.1 参数化测试<a href="#51-参数化测试" class="hash-link" aria-label="Direct link to 5.1 参数化测试" title="Direct link to 5.1 参数化测试">​</a></h3>
<p>通过Rust程序动态生成测试数据，并传递给Robot Framework：</p>
<div class="language-rust codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-rust codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">run_parameterized_test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token class-name">Config</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token keyword" style="color:#00009f">str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token keyword" style="color:#00009f">str</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">TestResult</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">mut</span><span class="token plain"> variable_args </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">new</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> params </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        variable_args</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">push_str</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token macro property" style="color:#36acaa">format!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot; -v {}:{}&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> cmd </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token macro property" style="color:#36acaa">format!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token string" style="color:#e3116c">&quot;{} --outputdir {}{} {}&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">robot_path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">output_dir</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> variable_args</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">test_path</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token macro property" style="color:#36acaa">info!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;执行命令: {}&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cmd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 执行命令并捕获输出</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Exec</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">shell</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cmd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">stdout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Redirection</span><span class="token punctuation" style="color:#393A34">::</span><span class="token class-name">Pipe</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">stderr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Redirection</span><span class="token punctuation" style="color:#393A34">::</span><span class="token class-name">Merge</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">capture</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">context</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;执行Robot Framework测试失败&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">?</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> success </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> output</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exit_status</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">success</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> output_str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">String</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">from_utf8_lossy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">output</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">stdout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">to_string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Ok</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">TestResult</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        success</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        output</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> output_str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用示例：</p>
<div class="language-rust codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-rust codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> params </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;NUM1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;7&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;NUM2&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;9&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;EXPECTED&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;16&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run_parameterized_test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">params</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">?</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>对应的Robot Framework测试：</p>
<div class="language-robotframework codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-robotframework codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token plain">*** Test Cases ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Parameterized Calculator Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Documentation]    使用从Rust传递的参数进行计算测试</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Launch Calculator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Perform Addition    ${NUM1}    ${NUM2}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Verify Result    ${EXPECTED}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Close Calculator</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_uFgA" id="52-并行测试执行">5.2 并行测试执行<a href="#52-并行测试执行" class="hash-link" aria-label="Direct link to 5.2 并行测试执行" title="Direct link to 5.2 并行测试执行">​</a></h3>
<p>利用Rust的并发特性，可以并行执行多个自动化测试：</p>
<div class="language-rust codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-rust codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">std</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token plain">thread</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">use</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">std</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token namespace" style="opacity:0.7">sync</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token punctuation" style="color:#393A34">{</span><span class="token class-name">Arc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">Mutex</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">run_parallel_tests</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token class-name">Config</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> test_files</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token keyword" style="color:#00009f">str</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">Vec</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token class-name">TestResult</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Arc</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">new</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">clone</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> results </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Arc</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">new</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Mutex</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">new</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">Vec</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">new</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">mut</span><span class="token plain"> handles </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token macro property" style="color:#36acaa">vec!</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> test_file </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> test_files </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Arc</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">clone</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> results </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Arc</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">clone</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">results</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> test_file </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> test_file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">to_string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> handle </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">thread</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token function" style="color:#d73a49">spawn</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">move</span><span class="token plain"> </span><span class="token closure-params closure-punctuation punctuation" style="color:#393A34">|</span><span class="token closure-params closure-punctuation punctuation" style="color:#393A34">|</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">mut</span><span class="token plain"> config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">clone</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">test_path </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> test_file</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">match</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run_robot_test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">Ok</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">mut</span><span class="token plain"> results </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> results</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">lock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unwrap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    results</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token class-name">Err</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token macro property" style="color:#36acaa">error!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;测试执行失败: {}&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        handles</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">handle</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> handle </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> handles </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        handle</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unwrap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> results </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Arc</span><span class="token punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">try_unwrap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">results</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unwrap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">into_inner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">unwrap</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Ok</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">results</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_uFgA" id="6-实际应用案例自动化windows记事本">6. 实际应用案例：自动化Windows记事本<a href="#6-实际应用案例自动化windows记事本" class="hash-link" aria-label="Direct link to 6. 实际应用案例：自动化Windows记事本" title="Direct link to 6. 实际应用案例：自动化Windows记事本">​</a></h2>
<p>下面是一个完整的示例，展示如何使用Rust + Robot Framework + FlaUILibrary自动化Windows记事本应用：</p>
<h3 class="anchor anchorWithStickyNavbar_uFgA" id="61-robot-framework测试文件">6.1 Robot Framework测试文件<a href="#61-robot-framework测试文件" class="hash-link" aria-label="Direct link to 6.1 Robot Framework测试文件" title="Direct link to 6.1 Robot Framework测试文件">​</a></h3>
<p>在<code>robot_tests/tests/notepad_test.robot</code>中：</p>
<div class="language-robotframework codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-robotframework codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token plain">*** Settings ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Library    FlaUILibrary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Resource   ../keywords/notepad_keywords.robot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*** Test Cases ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Notepad Automation Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Launch Notepad</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Type Text    Hello, this is automated using Rust + Robot Framework + FlaUILibrary!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Save File    test_file.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Close Notepad</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Verify File Exists    test_file.txt</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在<code>robot_tests/keywords/notepad_keywords.robot</code>中：</p>
<div class="language-robotframework codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-robotframework codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token plain">*** Settings ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Library    FlaUILibrary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Library    OperatingSystem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*** Keywords ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Launch Notepad</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Launch Application    notepad.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Wait Until Element Exists    //Window[@Name=&quot;无标题 - 记事本&quot; or @Name=&quot;Untitled - Notepad&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Type Text</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Arguments]    ${text}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Type Keys    //Document    ${text}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Save File</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Arguments]    ${filename}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 按下Alt+F组合键打开文件菜单</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Press Keys    alt    f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 点击保存选项</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //MenuItem[@Name=&quot;保存&quot; or @Name=&quot;Save&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 等待保存对话框</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Wait Until Element Exists    //Window[@Name=&quot;另存为&quot; or @Name=&quot;Save As&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 输入文件名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Type Keys    //Edit[@Name=&quot;文件名:&quot; or @Name=&quot;File name:&quot;]    ${filename}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 点击保存按钮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;保存&quot; or @Name=&quot;Save&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Close Notepad</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 关闭记事本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //TitleBar/Button[@Name=&quot;关闭&quot; or @Name=&quot;Close&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Verify File Exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [Arguments]    ${filename}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    File Should Exist    ${filename}</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_uFgA" id="62-rust主程序">6.2 Rust主程序<a href="#62-rust主程序" class="hash-link" aria-label="Direct link to 6.2 Rust主程序" title="Direct link to 6.2 Rust主程序">​</a></h3>
<div class="language-rust codeBlockContainer_pW36 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_vW6L"><pre tabindex="0" class="prism-code language-rust codeBlock_IwyG thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_JRTP"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">fn</span><span class="token plain"> </span><span class="token function-definition function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">-&gt;</span><span class="token plain"> </span><span class="token class-name">Result</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 初始化日志</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token namespace" style="opacity:0.7">env_logger</span><span class="token namespace punctuation" style="opacity:0.7;color:#393A34">::</span><span class="token function" style="color:#d73a49">init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 读取配置</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">mut</span><span class="token plain"> config </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">read_config</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">?</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 设置测试文件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">test_path </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;robot_tests/tests/notepad_test.robot&quot;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">to_string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 执行Robot Framework测试</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token macro property" style="color:#36acaa">info!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;开始执行记事本自动化测试&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">run_robot_test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">?</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 处理测试结果</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">success </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token macro property" style="color:#36acaa">info!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;记事本自动化测试成功完成&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token macro property" style="color:#36acaa">error!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;记事本自动化测试失败: {}&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">output</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Ok</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_pBJq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_gukD" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_HcGa"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_bx8J"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_uFgA" id="7-优势与局限性">7. 优势与局限性<a href="#7-优势与局限性" class="hash-link" aria-label="Direct link to 7. 优势与局限性" title="Direct link to 7. 优势与局限性">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_uFgA" id="71-优势">7.1 优势<a href="#71-优势" class="hash-link" aria-label="Direct link to 7.1 优势" title="Direct link to 7.1 优势">​</a></h3>
<ol>
<li><strong>高性能</strong>：Rust的高性能特性使得处理大量自动化任务时更加高效。</li>
<li><strong>内存安全</strong>：Rust的所有权系统和借用检查器确保了内存安全，减少了崩溃和内存泄漏的风险。</li>
<li><strong>并发能力</strong>：Rust的并发模型使得并行执行多个自动化任务变得简单且安全。</li>
<li><strong>跨平台</strong>：Rust程序可以在多种操作系统上运行，虽然FlaUILibrary仅支持Windows。</li>
<li><strong>生态系统整合</strong>：可以利用Rust丰富的库生态系统来增强自动化能力。</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_uFgA" id="72-局限性">7.2 局限性<a href="#72-局限性" class="hash-link" aria-label="Direct link to 7.2 局限性" title="Direct link to 7.2 局限性">​</a></h3>
<ol>
<li><strong>集成复杂性</strong>：Rust与Robot Framework的集成需要通过命令行调用，增加了一定的复杂性。</li>
<li><strong>调试难度</strong>：跨语言调试可能会比单一语言环境更加困难。</li>
<li><strong>平台限制</strong>：FlaUILibrary仅支持Windows平台，限制了跨平台自动化的能力。</li>
<li><strong>学习曲线</strong>：需要同时掌握Rust和Robot Framework，增加了学习成本。</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_uFgA" id="8-总结">8. 总结<a href="#8-总结" class="hash-link" aria-label="Direct link to 8. 总结" title="Direct link to 8. 总结">​</a></h2>
<p>使用Rust + Robot Framework + FlaUILibrary实现Windows桌面自动化，结合了Rust的高性能和内存安全特性，以及Robot Framework的易用性和FlaUILibrary的Windows UI自动化能力。这种组合特别适合需要高性能、高可靠性的桌面自动化场景，如：</p>
<ul>
<li>大规模自动化测试</li>
<li>需要处理复杂业务  逻辑的RPA流程</li>
<li>对性能和资源使用有严格要求的自动化任务</li>
<li>需要与其他系统集成的自动化解决方案</li>
</ul>
<p>通过本文介绍的方法和示例，您可以构建强大的桌面自动化解决方案，充分利用Rust的优势，同时保持Robot Framework和FlaUILibrary的易用性。</p>
<h2 class="anchor anchorWithStickyNavbar_uFgA" id="9-参考资源">9. 参考资源<a href="#9-参考资源" class="hash-link" aria-label="Direct link to 9. 参考资源" title="Direct link to 9. 参考资源">​</a></h2>
<ul>
<li><a href="https://www.rust-lang.org/learn" target="_blank" rel="noopener noreferrer">Rust官方文档</a></li>
<li><a href="https://robotframework.org/robotframework/latest/RobotFrameworkUserGuide.html" target="_blank" rel="noopener noreferrer">Robot Framework用户指南</a></li>
<li><a href="https://gdatasoftwareag.github.io/robotframework-flaui/" target="_blank" rel="noopener noreferrer">FlaUILibrary文档</a></li>
<li><a href="https://docs.rs/subprocess/latest/subprocess/" target="_blank" rel="noopener noreferrer">Rust subprocess库</a></li>
<li><a href="https://github.com/GDATASoftwareAG/robotframework-flaui" target="_blank" rel="noopener noreferrer">Robot Framework FlaUI GitHub仓库</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Tools/rpa/Rust_Robot_Framework_FlaUILibrary桌面自动化指南.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_KCuZ" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_bCE4"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/notes3/docs/Tools/rpa/Robot_Framework语法和文件结构指南"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Robot Framework语法和文件结构指南</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/notes3/docs/Tools/rpa/开源RPA工具对比"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">开源RPA工具对比：功能特性与适用场景分析</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_sVf5 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-基本概念" class="table-of-contents__link toc-highlight">1. 基本概念</a><ul><li><a href="#11-rust语言" class="table-of-contents__link toc-highlight">1.1 Rust语言</a></li><li><a href="#12-robot-framework" class="table-of-contents__link toc-highlight">1.2 Robot Framework</a></li><li><a href="#13-flauilibrary" class="table-of-contents__link toc-highlight">1.3 FlaUILibrary</a></li></ul></li><li><a href="#2-架构设计" class="table-of-contents__link toc-highlight">2. 架构设计</a></li><li><a href="#3-环境设置" class="table-of-contents__link toc-highlight">3. 环境设置</a><ul><li><a href="#31-安装rust" class="table-of-contents__link toc-highlight">3.1 安装Rust</a></li><li><a href="#32-安装python和robot-framework" class="table-of-contents__link toc-highlight">3.2 安装Python和Robot Framework</a></li><li><a href="#33-设置项目结构" class="table-of-contents__link toc-highlight">3.3 设置项目结构</a></li></ul></li><li><a href="#4-rust与robot-framework集成" class="table-of-contents__link toc-highlight">4. Rust与Robot Framework集成</a><ul><li><a href="#41-在cargotoml中添加依赖" class="table-of-contents__link toc-highlight">4.1 在Cargo.toml中添加依赖</a></li><li><a href="#42-创建robot-framework测试文件" class="table-of-contents__link toc-highlight">4.2 创建Robot Framework测试文件</a></li><li><a href="#43-在rust中实现robot-framework调用" class="table-of-contents__link toc-highlight">4.3 在Rust中实现Robot Framework调用</a></li><li><a href="#44-创建配置文件" class="table-of-contents__link toc-highlight">4.4 创建配置文件</a></li></ul></li><li><a href="#5-高级功能实现" class="table-of-contents__link toc-highlight">5. 高级功能实现</a><ul><li><a href="#51-参数化测试" class="table-of-contents__link toc-highlight">5.1 参数化测试</a></li><li><a href="#52-并行测试执行" class="table-of-contents__link toc-highlight">5.2 并行测试执行</a></li></ul></li><li><a href="#6-实际应用案例自动化windows记事本" class="table-of-contents__link toc-highlight">6. 实际应用案例：自动化Windows记事本</a><ul><li><a href="#61-robot-framework测试文件" class="table-of-contents__link toc-highlight">6.1 Robot Framework测试文件</a></li><li><a href="#62-rust主程序" class="table-of-contents__link toc-highlight">6.2 Rust主程序</a></li></ul></li><li><a href="#7-优势与局限性" class="table-of-contents__link toc-highlight">7. 优势与局限性</a><ul><li><a href="#71-优势" class="table-of-contents__link toc-highlight">7.1 优势</a></li><li><a href="#72-局限性" class="table-of-contents__link toc-highlight">7.2 局限性</a></li></ul></li><li><a href="#8-总结" class="table-of-contents__link toc-highlight">8. 总结</a></li><li><a href="#9-参考资源" class="table-of-contents__link toc-highlight">9. 参考资源</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_W9bM"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_W9bM"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_W9bM"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/notes3/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_W9bM"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>