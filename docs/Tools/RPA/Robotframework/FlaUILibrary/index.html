<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Tools/RPA/Robotframework/FlaUILibrary" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">FlaUILibrary | Cruldra</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/notes3/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/notes3/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/notes3/docs/Tools/RPA/Robotframework/FlaUILibrary"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="FlaUILibrary | Cruldra"><meta data-rh="true" name="description" content="Windows桌面应用的自动化测试一直是一个挑战，特别是对于需要与各种UI元素交互的复杂应用。本文将详细介绍如何使用Python、Robot Framework和FlaUILibrary组合来实现Windows桌面应用的自动化测试。"><meta data-rh="true" property="og:description" content="Windows桌面应用的自动化测试一直是一个挑战，特别是对于需要与各种UI元素交互的复杂应用。本文将详细介绍如何使用Python、Robot Framework和FlaUILibrary组合来实现Windows桌面应用的自动化测试。"><link data-rh="true" rel="icon" href="/notes3/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/notes3/docs/Tools/RPA/Robotframework/FlaUILibrary"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/notes3/docs/Tools/RPA/Robotframework/FlaUILibrary" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/notes3/docs/Tools/RPA/Robotframework/FlaUILibrary" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"RPA","item":"https://your-docusaurus-site.example.com/notes3/docs/category/rpa"},{"@type":"ListItem","position":2,"name":"Robotframework","item":"https://your-docusaurus-site.example.com/notes3/docs/category/robotframework"},{"@type":"ListItem","position":3,"name":"FlaUILibrary","item":"https://your-docusaurus-site.example.com/notes3/docs/Tools/RPA/Robotframework/FlaUILibrary"}]}</script><link rel="alternate" type="application/rss+xml" href="/notes3/blog/rss.xml" title="Cruldra RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/notes3/blog/atom.xml" title="Cruldra Atom Feed"><link rel="stylesheet" href="/notes3/assets/css/styles.5589a8a1.css">
<script src="/notes3/assets/js/runtime~main.16cd4c17.js" defer="defer"></script>
<script src="/notes3/assets/js/main.6b453a83.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/notes3/img/logo.svg"><style data-mantine-styles="classes">@media (max-width: 35.99375em) {.mantine-visible-from-xs {display: none !important;}}@media (min-width: 36em) {.mantine-hidden-from-xs {display: none !important;}}@media (max-width: 47.99375em) {.mantine-visible-from-sm {display: none !important;}}@media (min-width: 48em) {.mantine-hidden-from-sm {display: none !important;}}@media (max-width: 61.99375em) {.mantine-visible-from-md {display: none !important;}}@media (min-width: 62em) {.mantine-hidden-from-md {display: none !important;}}@media (max-width: 74.99375em) {.mantine-visible-from-lg {display: none !important;}}@media (min-width: 75em) {.mantine-hidden-from-lg {display: none !important;}}@media (max-width: 87.99375em) {.mantine-visible-from-xl {display: none !important;}}@media (min-width: 88em) {.mantine-hidden-from-xl {display: none !important;}}</style><div role="region" aria-label="Skip to main content"><a class="skipToContent_XTLC" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/notes3/"><div class="navbar__logo"><img src="/notes3/img/logo.svg" alt="My Site Logo" class="themedComponent_t6CT themedComponent--light_qEB_"><img src="/notes3/img/logo.svg" alt="My Site Logo" class="themedComponent_t6CT themedComponent--dark_k8rB"></div><b class="navbar__title text--truncate">Cruldra</b></a><a class="navbar__item navbar__link" href="/notes3/docs/category/设计模式">JVM</a><a class="navbar__item navbar__link" href="/notes3/docs/category/css">前端</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/notes3/docs/category/astrbot">工具</a><a class="navbar__item navbar__link" href="/notes3/docs/category/ai电竞酒店">个人</a><a class="navbar__item navbar__link" href="/notes3/docs/AI/Agno/介绍">AI</a><a class="navbar__item navbar__link" href="/notes3/docs/category/内置模块">Python</a><a class="navbar__item navbar__link" href="/notes3/docs/category/actix-web">Rust</a><a class="navbar__item navbar__link" href="/notes3/docs/category/数据库系统">软件工程</a><a class="navbar__item navbar__link" href="/notes3/docs/category/上古卷轴5">游戏</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_yKmy"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_N29d"><div class="docsWrapper_EARV"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_LCZS" type="button"></button><div class="docRoot_rMos"><aside class="theme-doc-sidebar-container docSidebarContainer_kmUt"><div class="sidebarViewport_dUwD"><div class="sidebar_GMqB"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_fCzY"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/astrbot">AstrBot</a><button aria-label="Expand sidebar category &#x27;AstrBot&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/dify">Dify</a><button aria-label="Expand sidebar category &#x27;Dify&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Tools/OpenAI">OpenAI</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/notes3/docs/category/rpa">RPA</a><button aria-label="Collapse sidebar category &#x27;RPA&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/notes3/docs/category/robotframework">Robotframework</a><button aria-label="Collapse sidebar category &#x27;Robotframework&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/Tools/RPA/Robotframework/架构">架构</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/Tools/RPA/Robotframework/桌面自动化">桌面自动化</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/notes3/docs/Tools/RPA/Robotframework/FlaUILibrary">FlaUILibrary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/Tools/RPA/Robotframework/Robot文件语法">Robot文件语法</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/Tools/RPA/企业微信UI元素识别问题">企业微信UI元素识别问题</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/notes3/docs/Tools/RPA/开源RPA工具对比">开源RPA工具对比</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/内网穿透">内网穿透</a><button aria-label="Expand sidebar category &#x27;内网穿透&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/操作系统">操作系统</a><button aria-label="Expand sidebar category &#x27;操作系统&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/数据库">数据库</a><button aria-label="Expand sidebar category &#x27;数据库&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/版本控制">版本控制</a><button aria-label="Expand sidebar category &#x27;版本控制&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/编程">编程</a><button aria-label="Expand sidebar category &#x27;编程&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/虚拟化和容器">虚拟化和容器</a><button aria-label="Expand sidebar category &#x27;虚拟化和容器&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/证书">证书</a><button aria-label="Expand sidebar category &#x27;证书&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/集成开发环境">集成开发环境</a><button aria-label="Expand sidebar category &#x27;集成开发环境&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/notes3/docs/category/音视频">音视频</a><button aria-label="Expand sidebar category &#x27;音视频&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/Tools/Comfyui/AI模型文件分发策略差异分析">Comfyui</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Tools/Docusaurus">Docusaurus</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/Tools/Gitea/TEAM">Gitea</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/Tools/Github/高级搜索语法">Github</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Tools/Jenkins">Jenkins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/notes3/docs/Tools/Ollama">Ollama</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/notes3/docs/Tools/figma/Figma原型交互">figma</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_GvdX"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_Zxmv"><div class="docItemContainer_bH49"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_lAiQ" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/notes3/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_wapv"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/notes3/docs/category/rpa"><span>RPA</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/notes3/docs/category/robotframework"><span>Robotframework</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">FlaUILibrary</span></li></ul></nav><div class="tocCollapsible_ISCz theme-doc-toc-mobile tocMobile_y31C"><button type="button" class="clean-btn tocCollapsibleButton_SdVn">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>FlaUILibrary</h1></header><p>Windows桌面应用的自动化测试一直是一个挑战，特别是对于需要与各种UI元素交互的复杂应用。本文将详细介绍如何使用Python、Robot Framework和FlaUILibrary组合来实现Windows桌面应用的自动化测试。</p>
<h2 class="anchor anchorWithStickyNavbar_eLV6" id="1-flauilibrary简介">1. FlaUILibrary简介<a href="#1-flauilibrary简介" class="hash-link" aria-label="Direct link to 1. FlaUILibrary简介" title="Direct link to 1. FlaUILibrary简介">​</a></h2>
<p>FlaUILibrary是一个基于<a href="https://github.com/FlaUI/FlaUI" target="_blank" rel="noopener noreferrer">FlaUI</a>的Robot Framework库，专门用于Windows应用程序的UI自动化测试。它支持多种Windows应用类型：</p>
<ul>
<li>Win32应用程序</li>
<li>WinForms应用程序</li>
<li>WPF应用程序</li>
<li>Windows Store应用</li>
</ul>
<p>FlaUILibrary通过提供关键字驱动的方法，使得即使没有强大编程背景的测试人员也能轻松创建和维护自动化测试。</p>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="11-flauilibrary的主要特点">1.1 FlaUILibrary的主要特点<a href="#11-flauilibrary的主要特点" class="hash-link" aria-label="Direct link to 1.1 FlaUILibrary的主要特点" title="Direct link to 1.1 FlaUILibrary的主要特点">​</a></h3>
<ul>
<li>基于微软UI自动化框架（UIA2和UIA3）</li>
<li>提供丰富的关键字用于UI元素交互</li>
<li>使用XPath定位器查找UI元素</li>
<li>支持各种Windows控件类型</li>
<li>与Robot Framework无缝集成</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_eLV6" id="2-环境设置">2. 环境设置<a href="#2-环境设置" class="hash-link" aria-label="Direct link to 2. 环境设置" title="Direct link to 2. 环境设置">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="21-前提条件">2.1 前提条件<a href="#21-前提条件" class="hash-link" aria-label="Direct link to 2.1 前提条件" title="Direct link to 2.1 前提条件">​</a></h3>
<p>在开始使用FlaUILibrary之前，需要确保系统满足以下要求：</p>
<ul>
<li>Windows操作系统</li>
<li>Python 3.8或更高版本（推荐使用Python 3.8，因为Python.Net库在某些Python版本上可能存在兼容性问题）</li>
<li>Robot Framework</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="22-安装步骤">2.2 安装步骤<a href="#22-安装步骤" class="hash-link" aria-label="Direct link to 2.2 安装步骤" title="Direct link to 2.2 安装步骤">​</a></h3>
<ol>
<li>
<p><strong>安装Python</strong>：
如果尚未安装Python，请从<a href="https://www.python.org/downloads/" target="_blank" rel="noopener noreferrer">Python官网</a>下载并安装Python 3.8或更高版本。安装时，确保勾选&quot;Add Python to PATH&quot;选项。</p>
</li>
<li>
<p><strong>安装Robot Framework</strong>：</p>
<div class="language-bash codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-bash codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">pip install robotframework</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>安装FlaUILibrary</strong>：</p>
<div class="language-bash codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-bash codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">pip install robotframework-flaui</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>验证安装</strong>：</p>
<div class="language-bash codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-bash codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain"># 验证Robot Framework安装</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">robot --version</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 验证FlaUILibrary安装</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python -c &quot;import FlaUILibrary; print(FlaUILibrary.__version__)&quot;</span><br></span></code></pre></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="23-可能的安装问题">2.3 可能的安装问题<a href="#23-可能的安装问题" class="hash-link" aria-label="Direct link to 2.3 可能的安装问题" title="Direct link to 2.3 可能的安装问题">​</a></h3>
<ul>
<li><strong>Python.Net兼容性问题</strong>：如果在安装过程中遇到Python.Net相关的错误，可以尝试使用Python 3.8，因为它与Python.Net库有更好的兼容性。</li>
<li><strong>AccessViolationException</strong>：在使用Python.Net 3.0.1版本时，可能会出现AccessViolationException。解决方法是设置Python的内存分配环境变量：<code>PYTHONMALLOC=malloc</code>。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_eLV6" id="3-元素定位">3. 元素定位<a href="#3-元素定位" class="hash-link" aria-label="Direct link to 3. 元素定位" title="Direct link to 3. 元素定位">​</a></h2>
<p>FlaUILibrary使用XPath定位器来查找UI元素。这是一种强大的方法，允许您基于各种属性和层次结构来定位元素。</p>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="31-xpath定位器基础">3.1 XPath定位器基础<a href="#31-xpath定位器基础" class="hash-link" aria-label="Direct link to 3.1 XPath定位器基础" title="Direct link to 3.1 XPath定位器基础">​</a></h3>
<p>在FlaUILibrary中，XPath定位器遵循以下格式：</p>
<div class="language-text codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-text codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">//ControlType[@Property=&#x27;Value&#x27;]</span><br></span></code></pre></div></div>
<p>例如：</p>
<ul>
<li><code>//Button[@Name=&quot;OK&quot;]</code> - 查找名为&quot;OK&quot;的按钮</li>
<li><code>//Edit[@AutomationId=&quot;textBox1&quot;]</code> - 查找自动化ID为&quot;textBox1&quot;的编辑框</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="32-常用xpath定位策略">3.2 常用XPath定位策略<a href="#32-常用xpath定位策略" class="hash-link" aria-label="Direct link to 3.2 常用XPath定位策略" title="Direct link to 3.2 常用XPath定位策略">​</a></h3>
<ol>
<li>
<p><strong>按名称定位</strong>：</p>
<div class="language-text codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-text codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">//Button[@Name=&quot;Calculate&quot;]</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>按自动化ID定位</strong>：</p>
<div class="language-text codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-text codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">//Edit[@AutomationId=&quot;inputField&quot;]</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>按控件类型定位</strong>：</p>
<div class="language-text codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-text codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">//ComboBox</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>组合条件定位</strong>：</p>
<div class="language-text codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-text codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">//Button[@Name=&quot;OK&quot; and @AutomationId=&quot;okButton&quot;]</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>使用contains函数</strong>：</p>
<div class="language-text codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-text codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">//Window[contains(@Name,&quot;Calculator&quot;)]</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>使用starts-with函数</strong>：</p>
<div class="language-text codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-text codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">//Window[starts-with(@Name,&quot;FlaUI&quot;)]</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>使用or条件</strong>：</p>
<div class="language-text codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-text codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">//Button[@Name=&quot;Close&quot; or @Name=&quot;Schließen&quot;]</span><br></span></code></pre></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="33-查找元素的工具">3.3 查找元素的工具<a href="#33-查找元素的工具" class="hash-link" aria-label="Direct link to 3.3 查找元素的工具" title="Direct link to 3.3 查找元素的工具">​</a></h3>
<p>为了帮助构建正确的XPath表达式，可以使用以下工具：</p>
<ul>
<li><a href="https://github.com/FlaUI/FlaUInspect" target="_blank" rel="noopener noreferrer">FlaUI Inspect</a>：专门为FlaUI设计的检查工具</li>
<li><a href="https://github.com/noubar/FlaUInspectStable" target="_blank" rel="noopener noreferrer">FlaUInspectStable</a>：更稳定的FlaUI Inspect版本</li>
<li><a href="https://accessibilityinsights.io" target="_blank" rel="noopener noreferrer">Microsoft Accessibility Insights For Windows</a>：微软官方的辅助功能检查工具</li>
<li>Inspect.exe：Windows SDK中包含的UI检查工具</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_eLV6" id="4-基本使用方法">4. 基本使用方法<a href="#4-基本使用方法" class="hash-link" aria-label="Direct link to 4. 基本使用方法" title="Direct link to 4. 基本使用方法">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="41-启动应用程序">4.1 启动应用程序<a href="#41-启动应用程序" class="hash-link" aria-label="Direct link to 4.1 启动应用程序" title="Direct link to 4.1 启动应用程序">​</a></h3>
<div class="language-robotframework codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-robotframework codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">*** Settings ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Library    FlaUILibrary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*** Test Cases ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Launch Calculator</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Launch Application    calc.exe</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="42-查找和点击元素">4.2 查找和点击元素<a href="#42-查找和点击元素" class="hash-link" aria-label="Direct link to 4.2 查找和点击元素" title="Direct link to 4.2 查找和点击元素">​</a></h3>
<div class="language-robotframework codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-robotframework codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">*** Test Cases ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Click Calculator Button</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Launch Application    calc.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 等待计算器窗口出现</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Wait Until Element Exists    //Window[@Name=&quot;计算器&quot; or @Name=&quot;Calculator&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 点击数字按钮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;5&quot; or @AutomationId=&quot;num5Button&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;+&quot; or @AutomationId=&quot;plusButton&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;3&quot; or @AutomationId=&quot;num3Button&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;=&quot; or @AutomationId=&quot;equalButton&quot;]</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="43-获取元素文本">4.3 获取元素文本<a href="#43-获取元素文本" class="hash-link" aria-label="Direct link to 4.3 获取元素文本" title="Direct link to 4.3 获取元素文本">​</a></h3>
<div class="language-robotframework codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-robotframework codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">*** Test Cases ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Verify Calculation Result</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Launch Application    calc.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 执行计算</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;5&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;+&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;3&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;=&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 获取结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ${result}=    Get Element Text    //Text[@AutomationId=&quot;CalculatorResults&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Should Be Equal    ${result}    显示为 8    # 中文Windows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 或</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Should Be Equal    ${result}    Display is 8    # 英文Windows</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="44-输入文本">4.4 输入文本<a href="#44-输入文本" class="hash-link" aria-label="Direct link to 4.4 输入文本" title="Direct link to 4.4 输入文本">​</a></h3>
<div class="language-robotframework codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-robotframework codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">*** Test Cases ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Input Text Example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Launch Application    notepad.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Wait Until Element Exists    //Window[@Name=&quot;无标题 - 记事本&quot; or @Name=&quot;Untitled - Notepad&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 输入文本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Type Keys    //Document    Hello, FlaUILibrary!</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="45-关闭应用程序">4.5 关闭应用程序<a href="#45-关闭应用程序" class="hash-link" aria-label="Direct link to 4.5 关闭应用程序" title="Direct link to 4.5 关闭应用程序">​</a></h3>
<div class="language-robotframework codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-robotframework codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">*** Test Cases ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Close Application Example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Launch Application    notepad.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Wait Until Element Exists    //Window[@Name=&quot;无标题 - 记事本&quot; or @Name=&quot;Untitled - Notepad&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 关闭应用程序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Close Application</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_eLV6" id="5-完整示例计算器自动化">5. 完整示例：计算器自动化<a href="#5-完整示例计算器自动化" class="hash-link" aria-label="Direct link to 5. 完整示例：计算器自动化" title="Direct link to 5. 完整示例：计算器自动化">​</a></h2>
<p>下面是一个完整的示例，展示如何使用FlaUILibrary自动化Windows计算器应用：</p>
<div class="language-robotframework codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-robotframework codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">*** Settings ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Library    FlaUILibrary</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test Teardown    Close Application</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*** Test Cases ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Calculator Addition Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 启动计算器</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Launch Application    calc.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 等待计算器窗口出现</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Wait Until Element Exists    //Window[@Name=&quot;计算器&quot; or @Name=&quot;Calculator&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 确保使用标准模式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ${standard_mode}=    Get Element    //Button[@Name=&quot;标准&quot; or @Name=&quot;Standard&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    ${standard_mode}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 执行计算: 5 + 3 = 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;5&quot; or @AutomationId=&quot;num5Button&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;+&quot; or @AutomationId=&quot;plusButton&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;3&quot; or @AutomationId=&quot;num3Button&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;=&quot; or @AutomationId=&quot;equalButton&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 验证结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ${result}=    Get Element Text    //Text[@AutomationId=&quot;CalculatorResults&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 根据系统语言验证结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ${is_chinese}=    Run Keyword And Return Status    Should Contain    ${result}    显示为</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Run Keyword If    ${is_chinese}    Should Be Equal    ${result}    显示为 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...    ELSE    Should Be Equal    ${result}    Display is 8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 截图保存结果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Take Screenshot    calculator_result.png</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_eLV6" id="6-高级功能">6. 高级功能<a href="#6-高级功能" class="hash-link" aria-label="Direct link to 6. 高级功能" title="Direct link to 6. 高级功能">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="61-等待元素">6.1 等待元素<a href="#61-等待元素" class="hash-link" aria-label="Direct link to 6.1 等待元素" title="Direct link to 6.1 等待元素">​</a></h3>
<div class="language-robotframework codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-robotframework codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">*** Test Cases ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Wait For Element Example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Launch Application    notepad.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 等待元素出现，超时时间为10秒</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Wait Until Element Exists    //Window[@Name=&quot;无标题 - 记事本&quot;]    timeout=10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 等待元素可见</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Wait Until Element Is Enabled    //MenuItem[@Name=&quot;文件&quot;]</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="62-处理下拉菜单">6.2 处理下拉菜单<a href="#62-处理下拉菜单" class="hash-link" aria-label="Direct link to 6.2 处理下拉菜单" title="Direct link to 6.2 处理下拉菜单">​</a></h3>
<div class="language-robotframework codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-robotframework codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">*** Test Cases ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dropdown Menu Example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Launch Application    notepad.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Wait Until Element Exists    //Window[@Name=&quot;无标题 - 记事本&quot; or @Name=&quot;Untitled - Notepad&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 点击文件菜单</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //MenuItem[@Name=&quot;文件&quot; or @Name=&quot;File&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 点击新建选项</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //MenuItem[@Name=&quot;新建&quot; or @Name=&quot;New&quot;]</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="63-处理对话框">6.3 处理对话框<a href="#63-处理对话框" class="hash-link" aria-label="Direct link to 6.3 处理对话框" title="Direct link to 6.3 处理对话框">​</a></h3>
<div class="language-robotframework codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-robotframework codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">*** Test Cases ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Dialog Handling Example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Launch Application    notepad.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Wait Until Element Exists    //Window[@Name=&quot;无标题 - 记事本&quot; or @Name=&quot;Untitled - Notepad&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 输入一些文本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Type Keys    //Document    Hello, FlaUILibrary!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 关闭应用程序，触发保存对话框</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //TitleBar/Button[@Name=&quot;关闭&quot; or @Name=&quot;Close&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 等待保存对话框出现</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Wait Until Element Exists    //Window[@Name=&quot;记事本&quot; or @Name=&quot;Notepad&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 点击&quot;不保存&quot;按钮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Click    //Button[@Name=&quot;不保存&quot; or @Name=&quot;Don&#x27;t Save&quot;]</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="64-截图功能">6.4 截图功能<a href="#64-截图功能" class="hash-link" aria-label="Direct link to 6.4 截图功能" title="Direct link to 6.4 截图功能">​</a></h3>
<div class="language-robotframework codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-robotframework codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">*** Test Cases ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Screenshot Example</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Launch Application    calc.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Wait Until Element Exists    //Window[@Name=&quot;计算器&quot; or @Name=&quot;Calculator&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 截取整个窗口</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Take Screenshot    full_window.png</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 截取特定元素</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ${element}=    Get Element    //Button[@Name=&quot;5&quot;]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Take Element Screenshot    ${element}    button_5.png</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_eLV6" id="7-最佳实践和注意事项">7. 最佳实践和注意事项<a href="#7-最佳实践和注意事项" class="hash-link" aria-label="Direct link to 7. 最佳实践和注意事项" title="Direct link to 7. 最佳实践和注意事项">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="71-元素定位最佳实践">7.1 元素定位最佳实践<a href="#71-元素定位最佳实践" class="hash-link" aria-label="Direct link to 7.1 元素定位最佳实践" title="Direct link to 7.1 元素定位最佳实践">​</a></h3>
<ol>
<li>
<p><strong>优先使用自动化ID</strong>：自动化ID通常是最稳定的定位方式，因为它们不会随着UI语言的变化而变化。</p>
</li>
<li>
<p><strong>处理多语言应用</strong>：使用or条件来处理不同语言版本：</p>
<div class="language-text codeBlockContainer_Um2F theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_S5dr"><pre tabindex="0" class="prism-code language-text codeBlock_XWlS thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_xg5f"><span class="token-line" style="color:#393A34"><span class="token plain">//Button[@Name=&quot;保存&quot; or @Name=&quot;Save&quot;]</span><br></span></code></pre></div></div>
</li>
<li>
<p><strong>使用相对路径</strong>：当元素的绝对路径可能变化时，使用相对路径可以提高测试的稳定性。</p>
</li>
<li>
<p><strong>避免使用索引</strong>：尽量避免使用索引来定位元素，因为UI更改可能会改变元素的顺序。</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="72-性能优化">7.2 性能优化<a href="#72-性能优化" class="hash-link" aria-label="Direct link to 7.2 性能优化" title="Direct link to 7.2 性能优化">​</a></h3>
<ol>
<li>
<p><strong>设置合理的超时时间</strong>：根据应用程序的响应时间，设置合理的等待超时时间。</p>
</li>
<li>
<p><strong>减少不必要的等待</strong>：只在必要的地方使用等待，避免过度等待导致测试运行时间过长。</p>
</li>
<li>
<p><strong>关闭应用程序</strong>：测试完成后，确保关闭应用程序，释放系统资源。</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_eLV6" id="73-常见问题及解决方法">7.3 常见问题及解决方法<a href="#73-常见问题及解决方法" class="hash-link" aria-label="Direct link to 7.3 常见问题及解决方法" title="Direct link to 7.3 常见问题及解决方法">​</a></h3>
<ol>
<li>
<p><strong>元素未找到</strong>：</p>
<ul>
<li>检查XPath表达式是否正确</li>
<li>使用FlaUI Inspect工具验证元素属性</li>
<li>增加等待时间</li>
<li>考虑应用程序的加载时间</li>
</ul>
</li>
<li>
<p><strong>Python.Net兼容性问题</strong>：</p>
<ul>
<li>使用Python 3.8版本</li>
<li>设置环境变量：<code>PYTHONMALLOC=malloc</code></li>
</ul>
</li>
<li>
<p><strong>应用程序响应慢</strong>：</p>
<ul>
<li>增加等待超时时间</li>
<li>在关键操作之间添加短暂延迟</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_eLV6" id="8-结论">8. 结论<a href="#8-结论" class="hash-link" aria-label="Direct link to 8. 结论" title="Direct link to 8. 结论">​</a></h2>
<p>FlaUILibrary结合Robot Framework和Python提供了一个强大的解决方案，用于Windows桌面应用的自动化测试。通过使用XPath定位器和丰富的关键字，即使是复杂的Windows应用也可以实现自动化。</p>
<p>虽然初始设置可能需要一些时间，但一旦掌握了元素定位和基本操作，就可以创建稳定、可维护的自动化测试脚本，大大提高测试效率和覆盖率。</p>
<h2 class="anchor anchorWithStickyNavbar_eLV6" id="9-参考资源">9. 参考资源<a href="#9-参考资源" class="hash-link" aria-label="Direct link to 9. 参考资源" title="Direct link to 9. 参考资源">​</a></h2>
<ul>
<li><a href="https://github.com/GDATASoftwareAG/robotframework-flaui" target="_blank" rel="noopener noreferrer">FlaUILibrary GitHub仓库</a></li>
<li><a href="https://pypi.org/project/robotframework-flaui/" target="_blank" rel="noopener noreferrer">FlaUILibrary PyPI页面</a></li>
<li><a href="https://github.com/FlaUI/FlaUI" target="_blank" rel="noopener noreferrer">FlaUI GitHub仓库</a></li>
<li><a href="https://robotframework.org/" target="_blank" rel="noopener noreferrer">Robot Framework官方文档</a></li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Tools/RPA/Robotframework/FlaUILibrary.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_HMM5" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_IqsD"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/notes3/docs/Tools/RPA/Robotframework/桌面自动化"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">桌面自动化</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/notes3/docs/Tools/RPA/Robotframework/Robot文件语法"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Robot文件语法</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_zkeJ thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-flauilibrary简介" class="table-of-contents__link toc-highlight">1. FlaUILibrary简介</a><ul><li><a href="#11-flauilibrary的主要特点" class="table-of-contents__link toc-highlight">1.1 FlaUILibrary的主要特点</a></li></ul></li><li><a href="#2-环境设置" class="table-of-contents__link toc-highlight">2. 环境设置</a><ul><li><a href="#21-前提条件" class="table-of-contents__link toc-highlight">2.1 前提条件</a></li><li><a href="#22-安装步骤" class="table-of-contents__link toc-highlight">2.2 安装步骤</a></li><li><a href="#23-可能的安装问题" class="table-of-contents__link toc-highlight">2.3 可能的安装问题</a></li></ul></li><li><a href="#3-元素定位" class="table-of-contents__link toc-highlight">3. 元素定位</a><ul><li><a href="#31-xpath定位器基础" class="table-of-contents__link toc-highlight">3.1 XPath定位器基础</a></li><li><a href="#32-常用xpath定位策略" class="table-of-contents__link toc-highlight">3.2 常用XPath定位策略</a></li><li><a href="#33-查找元素的工具" class="table-of-contents__link toc-highlight">3.3 查找元素的工具</a></li></ul></li><li><a href="#4-基本使用方法" class="table-of-contents__link toc-highlight">4. 基本使用方法</a><ul><li><a href="#41-启动应用程序" class="table-of-contents__link toc-highlight">4.1 启动应用程序</a></li><li><a href="#42-查找和点击元素" class="table-of-contents__link toc-highlight">4.2 查找和点击元素</a></li><li><a href="#43-获取元素文本" class="table-of-contents__link toc-highlight">4.3 获取元素文本</a></li><li><a href="#44-输入文本" class="table-of-contents__link toc-highlight">4.4 输入文本</a></li><li><a href="#45-关闭应用程序" class="table-of-contents__link toc-highlight">4.5 关闭应用程序</a></li></ul></li><li><a href="#5-完整示例计算器自动化" class="table-of-contents__link toc-highlight">5. 完整示例：计算器自动化</a></li><li><a href="#6-高级功能" class="table-of-contents__link toc-highlight">6. 高级功能</a><ul><li><a href="#61-等待元素" class="table-of-contents__link toc-highlight">6.1 等待元素</a></li><li><a href="#62-处理下拉菜单" class="table-of-contents__link toc-highlight">6.2 处理下拉菜单</a></li><li><a href="#63-处理对话框" class="table-of-contents__link toc-highlight">6.3 处理对话框</a></li><li><a href="#64-截图功能" class="table-of-contents__link toc-highlight">6.4 截图功能</a></li></ul></li><li><a href="#7-最佳实践和注意事项" class="table-of-contents__link toc-highlight">7. 最佳实践和注意事项</a><ul><li><a href="#71-元素定位最佳实践" class="table-of-contents__link toc-highlight">7.1 元素定位最佳实践</a></li><li><a href="#72-性能优化" class="table-of-contents__link toc-highlight">7.2 性能优化</a></li><li><a href="#73-常见问题及解决方法" class="table-of-contents__link toc-highlight">7.3 常见问题及解决方法</a></li></ul></li><li><a href="#8-结论" class="table-of-contents__link toc-highlight">8. 结论</a></li><li><a href="#9-参考资源" class="table-of-contents__link toc-highlight">9. 参考资源</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_Mzni"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_Mzni"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_Mzni"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/notes3/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_Mzni"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>